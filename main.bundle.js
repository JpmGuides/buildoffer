webpackJsonp([1],{"/IiW":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Ve9u"),i=n("aQzM"),o=n("nge0"),a=function(){function e(e){if(this.params=e,this.markedPlaces=[],this.renderer=e.renderer,this.defaultRadius=e.defaultRadius||6,this.icons={},this.defaultTextProp={fontSize:e.defaultFontSize||20,stroke:"rgba(255,255,255,.8)",fill:"#000000"},this.defaultEdgeProp=e.defaultEdgeProp||{lineWidth:1,lineColor:"#000000"},this.hideLabels=!!e.hideLabels,this.hideNodePoints=!!e.hideNodePoints,!this.renderer)throw new Error("TripGraphLayer: no renderer !");this.graph=e.graph||new r.TripGraph(void 0,this.defaultEdgeProp,null),this.missingData=1}return e.prototype.isReady=function(){return 0==this.missingData},e.prototype.draw=function(e,t,n,r){var i=this.graph,o=e.getContext("2d"),a=this.renderer.pixelRatio;this.markedPlaces=[],this.missingData=0;for(var l=0,s=i.edges;l<s.length;l++){var u=s[l];this.drawEdge(o,t,u,a,"curve")}for(var p=0,c=i.edges;p<c.length;p++){u=c[p];this.drawEdge(o,t,u,a,"mark")}for(var d in o.setLineDash([]),i.nodes){(f=i.nodes[d]).convertToPixelOffset(t,a),f.viewerPos=t.viewerPosFromWorldPos(f.coord)}if(!this.hideNodePoints)for(var d in i.nodes){var f=i.nodes[d];this.drawNodePoint(o,t,f)}for(var d in i.nodes)if(this.forceLeaderLines||!this.hideLabels||d.match(/-(takeoff)|(landing)$/)){f=i.nodes[d];this.drawLeaderLine(o,t,f)}for(var d in i.nodes)if(!this.hideLabels||d.match(/-(takeoff)|(landing)$/)){f=i.nodes[d];this.drawNodeLabel(o,t,f)}this.markedPlaces=this.markedPlaces.map(function(e){return t.worldPosFromViewerPos(e)}),this.fillClicMap(e,t)},e.prototype.drawEdge=function(e,t,n,r,i){this.setEdgeStrokeStyle(e,n),"route"==this.edgeProperty(n,"geom")?this.drawRoad(e,t,n,r,i):this.drawEdgeBezier(e,t,n,r,i)},e.prototype.drawRoad=function(e,t,n,r,i){var a=this,l=(this.edgeProperty(n,"travelMean"),this.graph.getEdgeRoute(n));if("curve"==i)if(l){var s=n.properties.route.geom;e.beginPath();var u=t.viewerPosFromWorldPos(s[0]);e.moveTo(u.x,u.y);for(var p=1;p<s.length;++p){var c=t.viewerPosFromWorldPos(s[p]);e.lineTo(c.x,c.y)}e.stroke()}else this.missingData+=1,n.properties||(n.properties={}),this.graph.getEdgeDirections(n,this.edgeProperty(n,"travelMean")).then(function(e){n.properties.route=e,a.renderer.refresh()}).catch(function(e){console.log(e),n.properties.geom="straight",a.renderer.refresh()});else if("mark"==i&&l&&l.midpoint){u=new o.Point(t.viewerPosFromWorldPos(l.geom[0]));var d=new o.Point(t.viewerPosFromWorldPos(l.geom[l.geom.length-1]));if(o.Point.dist(d,u)>80*r){var f=l.midpoint,h=16*r,m=new o.Point(t.viewerPosFromWorldPos(l.geom[f])),g=void 0;for(p=f;p<l.geom.length;++p){var y=new o.Point(t.viewerPosFromWorldPos(l.geom[p]));if(o.Point.dist(m,y)>h){g=o.Point.minus(y,m);break}}if(!g)return;var v=new o.Point(g.y,-g.x);this.drawEdgeMark(o.Point.plus(m,o.Point.times(8*r/g.norm(),g)),v,g,e,r,n,i)}}},e.prototype.drawEdgeBezier=function(e,t,n,r,i){for(var o=this.graph.bezier(n),a=0,l=o;a<l.length;a++){var s=l[a];this.drawBezier(e,t,s,r,n,i)}if("mark"!=i&&o.length>1&&n.drawMiddlePoint)for(var u in o){var p=t.viewerPosFromWorldPos(o[u].points[3]),c=5*r;e.beginPath(),e.arc(p.x,p.y,c,0,2*Math.PI,!1),e.fillStyle="#000000",e.fill()}},e.prototype.drawBezier=function(e,t,n,r,i,a){e.save();for(var l=new Array(8),s=n.points,u=0;u<4;++u){var p=t.viewerPosFromWorldPos(s[u]);l[2*u]=p.x,l[2*u+1]=p.y}var c=new Bezier(l),d=c.length(),f=Math.min(2,Math.floor(d/(40*r))),h=c.points;"mark"!=a&&(e.beginPath(),e.moveTo(h[0].x,h[0].y),e.bezierCurveTo(h[1].x,h[1].y,h[2].x,h[2].y,h[3].x,h[3].y),e.stroke());for(var m=1;m<f;++m){var g=m/f,y=(p=new o.Point(c.get(g)),new o.Point(c.normal(g))),v=new o.Point(c.derivative(g));this.drawEdgeMark(p,y,v,e,r,i,a)}e.restore()},e.prototype.drawEdgeMark=function(t,n,r,i,o,a,l){switch(this.edgeProperty(a,"travelMean")){case"Bike":case"Boat":case"Bus":case"Car":case"Helicopter":case"Plane":case"Train":case"Walk":"curve"!=l&&this.drawEdgeMarkIcon(t,n,r,i,o,a);break;case"Unspecified":default:"mark"!=l&&e.drawEdgeMarkTriangle(t,n,r,i,o)}},e.drawEdgeMarkTriangle=function(e,t,n,r,i){var a=10*i;n.mul(a/n.norm()),e=o.Point.plus(e,o.Point.times(.5,n));var l=o.Point.minus(e,n);r.beginPath(),r.moveTo(l.x+a/2*t.x,l.y+a/2*t.y),r.lineTo(e.x,e.y),r.lineTo(l.x-a/2*t.x,l.y-a/2*t.y),r.closePath(),r.fill()},e.prototype.drawEdgeMarkIcon=function(e,t,n,r,i,a){r.fillStyle="#fff",r.setLineDash([]),r.lineWidth=1*i;var l=10*i,s=6*i;n=n.mul(1/n.norm());var u=o.Point.plus(e,o.Point.times((l+s)/2,n)),p=o.Point.minus(e,o.Point.times((l+s)/2,n)),c=o.Point.plus(p,o.Point.times(l,n)),d=new o.Point(-n.y,n.x).mul(4*i),f=o.Point.plus(c,d),h=o.Point.minus(c,d),m=o.Point.minus(f,p),g=Math.atan2(m.y,m.x),y=o.Point.minus(h,p),v=Math.atan2(y.y,y.x);r.beginPath(),r.arc(p.x,p.y,l,g,v),r.lineTo(u.x,u.y),r.closePath(),r.fill(),r.stroke(),r.fillStyle="#000",r.textAlign="center",r.textBaseline="middle",r.font=Math.round(10*i)+"px FontAwesome";var b=this.edgeProperty(a,"travelMean");"Plane"==b&&(r.save(),r.translate(p.x,p.y),r.rotate(Math.PI/4+Math.atan2(n.y,n.x)),r.translate(-p.x,-p.y)),r.fillText({Bike:"\uf206",Boat:"\uf21a",Bus:"\uf207",Car:"\uf1b9",Helicopter:"H",Plane:"\uf072",Train:"\uf238",Walk:"\uf183"}[b],p.x,p.y),this.markedPlaces.push(p),"Plane"==b&&r.restore()},e.prototype.edgeProperty=function(e,t){return e.getProperty(t,this.defaultEdgeProp)},e.prototype.setEdgeStrokeStyle=function(e,t){var n=this.edgeProperty(t,"lineColor");e.strokeStyle=n,e.fillStyle=n,e.lineWidth=this.renderer.pixelRatio*this.edgeProperty(t,"lineWidth"),this.setDashStyle(e,this.edgeProperty(t,"dashed"))},e.prototype.nodeRadius=function(e){var t=this.defaultRadius;return e.properties&&e.properties.radius&&(t=e.properties.radius),t*this.renderer.pixelRatio},e.prototype.drawNodePoint=function(e,t,n){if(!n.properties||0!=n.properties.point){var r=n.viewerPos;this.drawPoint(e,r,this.renderer.pixelRatio,n.properties||{})}},e.prototype.drawNodeLabel=function(t,n,r){var i=this;if(r.label||r.labelIcon){var o=r.labelPixelPos(n,this.renderer.pixelRatio);if(r.label&&e.drawText(t,r.label,o,this.renderer.pixelRatio,r.properties||{},this.defaultTextProp),r.labelIcon){var a=this.getIcon(r.labelIcon.url);if(a){if(void 0!=r.labelIcon.autorotate){var l=n.viewerPosFromWorldPos(r.coord);r.labelIcon.angle=r.labelIcon.autorotate+Math.atan2(l.y-o.y,l.x-o.x)}this.drawIcon(t,a,r.labelIcon,o,this.renderer.pixelRatio)}else this.missingData++,this.loadIcons(function(){return i.renderer.refresh()})}if(r.properties&&r.properties.frame&&r.label){var s=e.measureText(t,r.label,this.renderer.pixelRatio,r.properties||{},this.defaultTextProp);t.strokeStyle=r.properties.frame,s.width+=3*this.renderer.pixelRatio,s.height+=3*this.renderer.pixelRatio,t.rect(o.x-s.width/2,o.y-s.height/2,s.width,s.height),t.stroke()}}},e.prototype.setDashStyle=function(e,t){var n=[];if(t)for(var r=0,i=t;r<i.length;r++){var o=i[r];n.push(this.renderer.pixelRatio*o)}e.setLineDash(n)},e.prototype.drawLeaderLine=function(e,t,n){if(n.properties){var r=n.properties;if(r.leaderLineAnchor||r.leaderLineAnchorPixelOffset){var i=this.renderer.pixelRatio,a=n.leaderLineAnchorPos(t,i);e.lineWidth=(n.properties.leaderLineWidth||1)*i,e.beginPath();var l=t.viewerPosFromWorldPos(n.coord),s=this.nodeRadius(n),u=n.properties&&void 0!==n.properties.maxLeaderLineLength?n.properties.maxLeaderLineLength*i:3*s;o.Point.dist(a,l)>u&&(n.properties.dashed&&this.setDashStyle(e,n.properties.dashed),e.moveTo(a.x,a.y),e.lineTo(l.x,l.y),e.strokeStyle=n.properties.leaderLineColor||"#000000",e.stroke(),n.properties.dashed&&e.setLineDash([]))}}},e.prototype.drawPoint=function(e,t,n,r){e.strokeStyle="rgba(0,0,0,1)",e.fillStyle="rgba(255,255,255,1)",e.lineWidth=2*n,e.beginPath();var i=(r.radius||this.defaultRadius)*n;e.arc(t.x,t.y,i,0,2*Math.PI,!1),e.stroke(),e.fill();var o=r.markStyle;!o&&r.firstVisited&&(o="first"),"first"===o&&(e.fillStyle="rgba(0, 0, 0, 1)",e.beginPath(),e.arc(t.x,t.y,.6*i,0,2*Math.PI,!1),e.fill())},e.measureText=function(t,n,r,i,o){var a=n.split("\n"),l={width:0,height:e.setTextStyle(t,r,i,o)*a.length*1.1};for(var s in a)l.width=Math.max(l.width,1.1*t.measureText(a[s]).width);return l},e.setTextStyle=function(e,t,n,r){var i=(n=n||{}).fontSize||r.fontSize;return i*=t,e.font=i+"px "+(n.font||"'PT Sans', sans-serif"),e.strokeStyle=n.stroke||r.stroke,e.lineWidth=(n.haloWidth||4)*t,e.fillStyle=n.fill||r.fill,parseInt(""+i)},e.drawText=function(t,n,r,i,o,a){var l,s,u=(void 0!=o.textOffset?o.textOffset:20)*i,p=((o.textPlacement||"S")+"").toUpperCase();switch(p){default:case"C":case"N":case"S":t.textAlign="center",l=0;break;case"E":case"NE":t.textAlign="start",l=u;break;case"O":case"W":t.textAlign="end",l=-u}switch(p){case"C":case"E":case"W":case"O":t.textBaseline="middle",s=0;break;case"N":case"NE":t.textBaseline="bottom",s=-u;break;default:case"S":t.textBaseline="top",s=u}var c=r.x+l,d=r.y+s,f=e.setTextStyle(t,i,o,a),h=n.split("\n");t.shadowBlur=3*i,t.shadowColor="#ffffff",t.lineWidth=2*i;for(var m=(h.length-1)/2,g=0;g<h.length;++g){var y=d+(g-m)*f;t.strokeText(h[g],c,y),t.fillText(h[g],c,y)}t.shadowColor="transparent"},e.prototype.drawIcon=function(e,t,n,r,i){if(t){var a=n.width?n.width*i:16*i,l=n.height?n.height*i:a,s=a*("ratioX"in n?n.ratioX:.5),u=l*("ratioY"in n?n.ratioY:.5);n.angle?(e.save(),e.translate(r.x,r.y),e.rotate(n.angle),e.drawImage(t,-s,-u,a,l),e.restore(),this.markedPlaces.push(o.Point.plus(r,o.Point.rotate(new o.Point(a/2-s,l/2-u),n.angle)))):(e.drawImage(t,r.x-s,r.y-u,a,l),this.markedPlaces.push({x:r.x-s+a/2,y:r.y-u+l/2}))}},e.prototype.getLabelIconSize=function(e,t){var n=this.renderer.pixelRatio,r=t.labelIcon;return{width:(r.width||16)*n,height:(r.height||r.width||16)*n}},e.prototype.computeNodeSizeWithMargin=function(t,n){var r;if(n.label){var i=this.renderer.pixelRatio;r=e.measureText(t,n.label,i,n.properties,this.defaultTextProp)}else n.labelIcon&&((r=this.getLabelIconSize(t,n)).width*=1.4,r.height*=1.4);if(!r)throw"no label and no labIcon for node";var o=2*this.renderer.pixelRatio;return r.width+=2*o,r.height+=2*o,r},e.prototype.setLabelBbox=function(e,t,n){if(e&&(e.label||e.labelIcon)&&e.properties&&(e.properties.labelCoord||e.properties.labelPixelOffset)){t||(t=this.renderer.canvas.getContext("2d"));var r=this.renderer.pinchZoom;if(!n){var a=this.computeNodeSizeWithMargin(t,e),l=e.labelPixelPos(r,this.renderer.pixelRatio);n={x:l.x,y:l.y,width:a.width,height:a.height}}var s=e.properties,u=o.Point.times(.5,new o.Point(n.width,n.height));s.labelBbox=new i.BoundingBox({min:r.worldPosFromViewerPos(o.Point.minus(n,u)),max:r.worldPosFromViewerPos(o.Point.plus(n,u))})}},e.prototype.nodeName=function(e){if(e.label)return e.label;if(e.labelIcon)return"icon:"+e.labelIcon.url;throw"no label and no labIcon for node"},e.prototype.placeLabels=function(e,t){var n=this.renderer.pinchZoom,a=this.renderer.pixelRatio,l=[],s=[];for(var u in this.graph.nodes){var p=this.graph.nodes[u];if(p.label||p.labelIcon){var c=n.viewerPosFromWorldPos(p.coord),d=this.defaultRadius;p.properties&&p.properties.radius&&(d=p.properties.radius),s.push({x:c.x,y:c.y,r:!1!==p.properties.point?d*a:-1});var f=this.computeNodeSizeWithMargin(e,p),h=this.nodeName(p),m=c;!1===p.properties.point&&(m.x-=f.width/2,m.y-=f.height/2);var g=void 0;t&&(g=m),p.properties&&p.properties.userPlacement&&(g=m=n.viewerPosFromWorldPos(p.properties.userPlacement)),p.properties&&p.properties.userPlacementPixelOffset&&(g=m=o.Point.plus(c,o.Point.times(a,p.properties.userPlacementPixelOffset)));var y={x:m.x,y:m.y,name:h,width:f.width,height:f.height,node:p,userPlacement:g};l.push(y)}}var v=d3.labeler().label(l).anchor(s).width(this.renderer.canvas.width).height(this.renderer.canvas.height),b=v.alt_energy(),P=[],w=[];for(var _ in this.graph.edges){var x=this.graph.getEdgeRoute(this.graph.edges[_]);if(x){for(var M=[],L=0,C=x.geom;L<C.length;L++){var T=C[L],k=n.viewerPosFromWorldPos(T);(0==M.length||o.Point.dist(M[M.length-1],k)>4*a)&&M.push(k)}(S=new i.BoundingBox).addArray(M),P.push(S),w.push(M)}else{var O=this.graph.bezier(this.graph.edges[_]);for(var u in O){var D=O[u],S=D.bbox();P.push({min:n.viewerPosFromWorldPos(S.x.min,S.y.min),max:n.viewerPosFromWorldPos(S.x.max,S.y.max)});var I=D.getLUT(30),E=[];for(var A in I)E.push(n.viewerPosFromWorldPos(I[A]));w.push(E)}}}v.alt_energy(function(e,t,n){var r=0,a=v.boxOfLabel(e),s=new i.BoundingBox;for(var u in s.addPoint(new o.Point(a.left,a.top)),s.addPoint(new o.Point(a.right,a.bottom)),P)if(i.BoundingBox.overlaps(P[u],s)){var p=w[u];for(var c in p)s.contains(p[c])&&r++}var d=10*r+b(e),f=l[e].userPlacement;f&&(d+=o.Point.dist(f,l[e]));return d});v.start(5e3,1);for(var u in l){var R=l[u];R.node.properties||(R.node.properties={});var F=R.node.properties,N=n.viewerPosFromWorldPos(R.node.coord);F.labelPixelOffset=o.Point.minus(R,N).mul(1/a),"labelCoord"in F&&delete F.labelCoord,this.setLabelBbox(R.node,e,R),r.TripGraph.placeLeaderLine(R.node,n,a),F.textPlacement="C",F.textOffset=0}},e.shallowCopy=function(e){var t,n=Object.create(Object.getPrototypeOf(e)),r=Object.getOwnPropertyNames(e);for(t=0;t<r.length;t++)Object.defineProperty(n,r[t],Object.getOwnPropertyDescriptor(e,r[t]));return n},e.prototype.forEachNode=function(e){for(var t in this.graph.nodes)e(this.graph.nodes[t])},e.prototype.getIcon=function(e){if(this.icons[e]&&!this.icons[e].jpm_loading)return this.icons[e]},e.prototype.loadIcons=function(e){if(!(this.iconsToLoad>0)){var t=this;this.iconsToLoad=1,this.failedIcons=0;var n=function(){t.iconsToLoad--,e&&0===t.iconsToLoad&&(t.failedIcons>0?e(new Error(t.failedIcons+" icons failed to load.")):e())};this.forEachNode(function(e){if(e.labelIcon){var r=e.labelIcon.url;if(t.icons[r])return;t.icons[r]={jpm_loading:!0},t.iconsToLoad++;var i=window.imageUrlPrefix||"";t.renderer.loadImage(i+e.labelIcon.url,function(e){t.icons[r]=e,n()},function(e){console.log("Failed to load: "+r+" (prefix: "+i+")"),t.failedIcons++,n()})}}),n()}},e.prototype.findLabelAtWorldPos=function(e){var t=this.graph.nodes;for(var n in t)if(t.hasOwnProperty(n)){var r=this.graph.nodes[n];if(r.properties&&(r.properties.labelCoord||r.properties.labelPixelOffset)&&this.setLabelBbox(r),r.properties&&r.properties.labelBbox&&i.BoundingBox.contains(r.properties.labelBbox,e))return r}},e.prototype.findNodePointAtViewerPos=function(e){var t=this.graph;for(var n in t.nodes){var r=t.nodes[n];if(!r.properties||0!=r.properties.point){var i=(r.properties.radius||this.defaultRadius)*this.renderer.pixelRatio;if(o.Point.dist(r.viewerPos,e)<i)return r}}},e.prototype.fillClicMap=function(e,t){var n=document.getElementById("image-clic-map"),r=this.graph;if(n){var i="";for(var o in r.nodes){var a=r.nodes[o];if(a.label){var l=this.computeNodeSizeWithMargin(e.getContext("2d"),a),s=a.labelPixelPos(t,this.renderer.pixelRatio),u=[s.x-l.width/2,s.y-l.height/2,s.x+l.width/2,s.y+l.height/2].map(function(e){return Math.round(e)});u[0]>=e.width||u[1]>=e.height||u[2]<0||u[3]<0||(i+='<area href="'+(a.dbid||a.name)+'" shape="rect" alt="'+a.label+'" coords="'+u.join(",")+'">\n')}}n.innerHTML=i}},e}();t.TripGraphLayer=a},"/Zw9":function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function l(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,l)}s((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n("rIWh"),a=n("3j3K"),l=n("/IiW"),s=n("VgMH");var u=function(){function e(e){this.el=e,this.waitingList=[],this._showOld=!0,this._removeMapLabels=!1,this.interactive=!1}return e.prototype.pixelRatio=function(){return this._renderer&&this._renderer.pixelRatio?this._renderer.pixelRatio:1},e.prototype.getCanvasWidth=function(){return this.canvasWidth?this.canvasWidth:this.el&&this.el.nativeElement?this.el.nativeElement.offsetWidth:0},e.prototype.getCanvasHeight=function(){return this.canvasHeight?this.canvasHeight:this.el&&this.el.nativeElement?this.el.nativeElement.offsetHeight:0},e.prototype.isReady=function(){var e=this._map;return e&&this._renderer&&this._tripLayer&&this._tripLayer.isReady()&&e.loaded()&&!(e._sourcesDirty||e._repaint||e._styleDirty||e._placementDirty)},e.prototype.prepareCanvas=function(e){var t=this;this._options=e,this.canvas&&this.canvas.nativeElement&&!this._renderer&&!this._map?(this._map=this.mapview.createMap(e.trip),this._map.on("load",function(){var n=t.canvas.nativeElement,r=e.trip.location();t._renderer=new o.T.CanvasTilesRenderer({canvas:n,width:1,clearBorder:!1,downsampleDuringMotion:!1,fillScreen:!1,downgradeIfSlowerFPS:1e-8,url:"https://tiles.wmflabs.org/bw-mapnik/$scale/$x/$y.png",initialLocation:r,onLocationChange:function(n){var r=n.getLocation();t.setMapboxLocation(r),e.onLocationChange&&e.onLocationChange(n)}}),t._renderer.pinchZoom.maxScale=t.getScaleFromZoom(0),e.disableMouseWheel&&(t._renderer.pinchZoom.handleMouseWheel=function(e){}),t._renderer.layers=[{draw:function(){var e=t.renderCanvas.nativeElement,n=t.canvas.nativeElement;e.width=n.width,e.height=n.height,e.getContext("2d").clearRect(0,0,e.width,e.height)}}],t._tripLayer=new l.TripGraphLayer({renderer:t._renderer,graph:e.graph}),t._renderer.addLayer(t._tripLayer);var i=t._tripLayer.draw,a=t;t._tripLayer.draw=function(){if(this.hideLabels=!a._removeMapLabels,this.forceLeaderLines=!0,a._showOld){var e=a.renderCanvas.nativeElement;arguments[0]=e,i.apply(this,arguments);var t=e.width,n=e.height;a._canvasWorldCoord=[[0,0],[t,0],[t,n],[0,n]].map(function(e){return a._renderer.pinchZoom.worldPosFromViewerPos({x:e[0],y:e[1]})}),a.updateCanvas()}},e.created&&e.created(t._renderer,t._tripLayer);for(var s=0,u=t.waitingList;s<u.length;s++){var p=u[s];p.alreadyCreated&&p.alreadyCreated(t._renderer,t._tripLayer)}setTimeout(function(){t.setSeqTrip(e.trip),r&&(t._removeMapLabels=r.scale>1,t.switchCanvasVisibility(t._removeMapLabels),t.mapview.switchCustomLayers(!t._removeMapLabels))},10),t.resize()}),this._map.on("idle",function(){t._map;t.isReady()?t.onMapReady&&t.onMapReady():console.log("mapbox map is ready, but not mapview!!")})):e.alreadyCreated&&(this._map.loaded()?e.alreadyCreated(this._renderer,this._tripLayer):this.waitingList.push(e))},e.prototype.getLayer=function(e){},e.prototype.setLayerColors=function(e){},e.prototype.resize=function(){this.mapview.resize(),this._renderer&&(this._renderer.pinchZoom.maxScale=this.getScaleFromZoom(0),this.setMapboxLocation(this._renderer.getLocation()))},e.prototype.setMapboxLocation=function(e){this.mapview.setMapboxLocation(e),this._removeMapLabels=e.scale>1,this.switchCanvasVisibility(this._removeMapLabels),this.mapview.switchCustomLayers(!this._removeMapLabels)},e.prototype.getZoomFromLocation=function(e){if(e){var t=this.getCanvasWidth();return Math.log2(1/(e.scale*(512/t)))}return 8},e.prototype.getScaleFromZoom=function(e){return this.getCanvasWidth()/512*1/Math.pow(2,e)},e.prototype.setSeqTrip=function(e){var t,n=this;this._seqTrip=e,this._tripLayer.graph&&Object.keys(this._tripLayer.graph.nodes).length>0?t=this._tripLayer.graph:(t=e.makeGraph(this._tripLayer),this._tripLayer.graph=t),this._tripLayer.defaultRadius=e.defaultRadius(),this._tripLayer.defaultTextProp=e.defaultTextProp(),this._tripLayer.defaultEdgeProp=e.defaultEdgeProp();var r,i,o,a,l,s=e.location();r=s,i=this._renderer.location,o=r.x-i.x,a=r.y-i.y,l=r.scale-i.scale,Math.abs(o)<1e-7&&Math.abs(a)<1e-7&&Math.abs(l)<1e-7||this._renderer.setLocation(s),this.setMapboxLocation(s),this.setLayerColors(e),this._renderer.refresh(),this.resize(),this._tripLayer.loadIcons(function(e){e&&console.log(e),n._renderer.refresh()});var u=this.renderCanvas.nativeElement,p=u.width,c=u.height;return this.mapview.addTripLayers(e,t,u,[[0,0],[p,0],[p,c],[0,c]].map(function(e){return n._renderer.pinchZoom.worldPosFromViewerPos({x:e[0],y:e[1]})}),this._tripLayer.markedPlaces),t},e.prototype.updateCanvas=function(){if(this._canvasWorldCoord){var e=this.renderCanvas.nativeElement;e.width,e.height;this.mapview.updateCanvasLayer(e,this._canvasWorldCoord,this._tripLayer.markedPlaces)}},e.prototype.refresh=function(){this._renderer&&this._renderer.refresh(),this._seqTrip&&this.setSeqTrip(this._seqTrip)},e.prototype.attribution=function(){var e=this._map;if(!e||!e.style)return[];var t=[],n=e.style.sourceCaches;for(var r in n){var i=n[r];if(i.used){var o=i.getSource();o.attribution&&t.indexOf(o.attribution)<0&&t.push(o.attribution)}}return t.sort(function(e,t){return e.length-t.length}),t=t.filter(function(e,n){for(var r=n+1;r<t.length;r++)if(t[r].indexOf(e)>=0)return!1;return!0})},e.prototype.switchCanvasVisibility=function(e){var t=this.renderCanvas.nativeElement,n=t.parentElement;e?n.insertBefore(t,this.canvas.nativeElement):n.insertBefore(t,n.firstChild)},e.prototype.addMarker=function(e,t){if(this._map)return new mapboxgl.Marker(t).setLngLat([e.longitude,e.latitude]).addTo(this._map)},e.prototype.addAttributionControl=function(e){this._map&&this._map.addControl(new mapboxgl.AttributionControl({compact:e}))},e.prototype.toggleInteractive=function(){return r(this,void 0,void 0,function(){var e,t;return i(this,function(n){switch(n.label){case 0:return this.interactive=!this.interactive,this.interactive?(t=(e=this.mapview).showInteractive,[4,s.buildInteractiveContent(this._seqTrip)]):[3,3];case 1:return[4,t.apply(e,[n.sent()])];case 2:return n.sent()||(this.interactive=!1),this.refresh(),[3,4];case 3:this.mapview.hideInteractive(),this.setMapboxLocation(this._renderer.getLocation()),this.refresh(),n.label=4;case 4:return[2]}})})},e.prototype.updateInteractive=function(){return r(this,void 0,void 0,function(){var e,t;return i(this,function(n){switch(n.label){case 0:return this.interactive?(this.mapview.hideInteractive(),t=(e=this.mapview).showInteractive,[4,s.buildInteractiveContent(this._seqTrip)]):[2];case 1:return[4,t.apply(e,[n.sent()])];case 2:return n.sent()||(this.interactive=!1),[2]}})})},e.ctorParameters=function(){return[{type:a.ElementRef}]},e}();t.MapView=u},0:function(e,t,n){e.exports=n("xkj0")},"0qPf":function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function l(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,l)}s((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n("nge0"),a=n("G8oB"),l=n("VgMH"),s=n("Lhz1");t.klokanApiKey="e7trAnc5053j8mX60MlQ";mapboxgl.AttributionControl,mapboxgl.Map;var u=mapboxgl.ScaleControl;var p=function(){function e(){var e=this;this.waitingList=[],this._lastInteractiveClick=new Date,this._interactiveClickHandler=function(t){var n=new Date;if(!(n.getTime()-e._lastInteractiveClick.getTime()<300)){e._lastInteractiveClick=n;var r=t.features[0].properties,i=r["poi-id"],o=r.articleID||r.article;a.configureHighlightLayer(e._map,function(e){return e.properties&&e.properties["poi-id"]==i&&(e.properties.article||e.properties.articleID)==o})}}}return e.prototype.pixelRatio=function(){return window.devicePixelRatio||1},e.prototype.createMap=function(e){var n=this;if(!this._map){var r,i={container:this.mapDiv.nativeElement,style:(r=e.getMapStyle(),r.match(/^http/)?r:"https://maps.tilehosting.com/styles/"+r+"/style.json?key="+t.klokanApiKey),center:l.worldToLatLon(e.location()),zoom:this.getZoomFromLocation(e.location()),attributionControl:!1,minZoom:0,renderWorldCopies:!0};this._map=new mapboxgl.Map(i),this._map.on("error",function(e){console.log("Map error:",e)}),this._map.on("load",function(){var e=Object.keys(n._map.getStyle().sources);n.lang&&n._map.setLanguage(n.lang);for(var t=0,r=e;t<r.length;t++){var i=r[t],o=n._map.getSource(i);o&&(o.tileSize=400,o.roundZoom=!0)}});var o=new u;return this._map.addControl(o),this._map}},e.prototype.addTripLayers=function(e,t,n,r,i){var o=this._map;this._graph=t;var l=this.buildPathGeoJson(e,t),s=o.getSource("dayEdges"),u=a.firstLayerOfType(o,"symbol");if(n)this.updateCanvasLayer(n,r,i);else if(s?s.setData(l):o.addSource("dayEdges",{type:"geojson",data:l}),void 0==o.getLayer("dayEdgesLayer"))o.addLayer({id:"dayEdgesLayer",type:"line",source:"dayEdges",minZoom:0,layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":["get","color"],"line-width":["get","width"]}},u);var p=this.buildPlacesGeoJson(e,t),c=o.getSource("dayPlaces");if(c)c.setData(p),o.setLayoutProperty("dayLabels","icon-size",this._iconFactor);else{o.addSource("dayPlaces",{type:"geojson",data:p}),this.genBlackDot(),o.addLayer({id:"dayLabels",type:"symbol",source:"dayPlaces",minZoom:0,layout:{"text-field":"{label}","text-font":["match",["get","fontName"],"noto",["literal",["Noto Sans Bold"]],["literal",["Open Sans Semibold"]]],"text-anchor":"center","text-offset":{type:"identity",property:"labelOffset"},"text-size":{property:"fontSize",type:"identity"},"text-allow-overlap":!0,"text-max-width":100,visibility:this._disabledLayers?"none":"visible","icon-image":["get","icon"],"icon-anchor":"center","icon-allow-overlap":!0,"icon-size":this._iconFactor,"icon-offset":{type:"identity",property:"iconOffset"}},paint:{"text-color":{property:"fill",type:"identity"},"text-halo-color":{property:"stroke",type:"identity"},"text-halo-width":1.2}});var d=e.places().filter(function(e){return!e.properties.skip}).map(function(e){return e.label+""});this.hidePlaces(d)}},e.prototype.updateCanvasLayer=function(e,t,n){var r=this;if(e&&t){var i=this._map,o=i.getSource("canvasSource");if(o){var s=o.coordinates,u=t.map(l.worldToLatLon);JSON.stringify(s)!=JSON.stringify(u)&&o.setCoordinates(u),o.play()}else{var p=a.firstLayerOfType(i,"symbol");i.addSource("canvasSource",{type:"canvas",canvas:e,animate:!0,coordinates:t.map(l.worldToLatLon)}),i.addLayer({id:"canvasLayer",type:"raster",source:"canvasSource",paint:{"raster-fade-duration":0},layout:{visibility:this._disabledLayers?"none":"visible"},minZoom:0},p)}this.pauseCanvasSourceTimeout&&clearTimeout(this.pauseCanvasSourceTimeout),this.pauseCanvasSourceTimeout=setTimeout(function(){r.pauseCanvasSourceTimeout=void 0,i.getSource("canvasSource").pause()},200),this.killMapLabels(n)}},e.prototype.resize=function(){this._map&&(this._map.resize(),this._trip&&this.setMapboxLocation(this._trip.location()))},e.prototype.setMapboxLocation=function(e){if(!isFinite(e.x)||!isFinite(e.y))throw new Error("Invalid coordinates: "+e.x+", "+e.y);this._map&&(this._map.setCenter(l.worldToLatLon(e)),isFinite(e.scale)&&this._map.setZoom(this.getZoomFromLocation(e)))},e.prototype.getZoomFromLocation=function(e){if(e){var t=this.canvasWidth;return Math.log2(1/(e.scale*(512/t)))}return 8},e.prototype.buildPathGeoJson=function(e,t){return{type:"FeatureCollection",features:t.edges.map(function(n){return{type:"Feature",geometry:{type:"LineString",coordinates:function(e,t,n){var r=n.nodes,i=t.edgeProperty(e,"geom");if(e.properties&&e.properties.hidden||r[e.from].properties.skip||r[e.to].properties.skip)return[];if("route"==i){if(e.properties&&e.properties.route&&e.properties.route.geom)return e.properties.route.geom.map(l.worldToLatLon);i="straight"}if("straight"==i)return[r[e.from].coord,r[e.to].coord].map(l.worldToLatLon);if(2==e.controlPoints.length){for(var o=[],a=0,s=[r[e.from].coord,e.controlPoints[0],e.controlPoints[1],r[e.to].coord];a<s.length;a++){var u=s[a];o.push(u.x),o.push(u.y)}return new Bezier(o).getLUT(128).map(l.worldToLatLon)}return console.log("Unexpected edge structure, not drawing"),[]}(n,e,t)},properties:{mean:n.properties.travelMean,color:e.edgeProperty(n,"lineColor"),width:parseFloat(e.edgeProperty(n,"lineWidth")),dashed:(e.edgeProperty(n,"dashed")||[]).concat([1])[0]}}})}},e.prototype.buildPlacesGeoJson=function(e,t){var n=[];for(var r in this._iconFactor=(e.defaultTextProp().fontSize/12*16+4)/64,t.nodes){var i=t.nodes[r];if(!i.properties.skip){var o=e.nodeProperty(i,"fontSize")||12,a=[0,0],s=[0,0];if(i.properties.labelPixelOffset){var u=1/o;a=[i.properties.labelPixelOffset.x*u,i.properties.labelPixelOffset.y*u],s=[i.properties.labelPixelOffset.x/this._iconFactor,i.properties.labelPixelOffset.y/this._iconFactor]}n.push({type:"Feature",geometry:{type:"Point",coordinates:l.worldToLatLon(i.coord)},properties:{label:i.label,labelOffset:a,iconOffset:s,fontSize:o,fontName:e.nodeProperty(i,"blackdot")?"noto":"default",icon:e.nodeProperty(i,"blackdot")?"blackdot":"",fill:e.nodeProperty(i,"fill"),stroke:e.nodeProperty(i,"stroke")}})}}return{type:"FeatureCollection",features:n}},e.prototype.hidePlaces=function(e){var t=[["!in","name:"+this.lang].concat(e),["!in","name"].concat(e)],n=["","-"+this.lang],r=this._map;["place_city_capital","place_city","place_town","place_village","place_other"].forEach(function(e){n.forEach(function(n){var i=e+n;if(r.getLayer(i)){var o=r.getFilter(i);o=o.concat(t),r.setFilter(i,o)}})})},e.prototype.killMapLabels=function(e){var t=this,n=this._map;if(!n.hasImage("blank4")){for(var r=new Uint8Array(64),i=0;i<4;i++)for(var o=0;o<4;o++){var a=4*(4*o+i);r[a+0]=255,r[a+1]=0,r[a+2]=0,r[a+3]=0}n.addImage("blank4",{width:4,height:4,data:r})}e||console.log("No marked places!");var s=e.map(l.worldToLatLon);this._graph&&(s=s.concat(Object.keys(this._graph.nodes).map(function(e){var n=t._graph.nodes[e].coord;return l.worldToLatLon(n)})));for(var u=n.getCanvas(),p=u.clientWidth,c=u.clientHeight,d=[],f=18;f<p;f+=18)d.push(n.unproject([f,0])),d.push(n.unproject([f,c]));for(var h=18;h<c;h+=18)d.push(n.unproject([0,h])),d.push(n.unproject([p,h]));var m={type:"FeatureCollection",features:(s=s.concat(d.map(function(e){return[e.lng,e.lat]}))).map(function(e){return{type:"Feature",geometry:{type:"Point",coordinates:e}}})},g=n.getSource("blankSource");g?g.setData(m):(n.addSource("blankSource",{type:"geojson",data:m}),n.addLayer({id:"blank",type:"symbol",source:"blankSource",minZoom:0,layout:{"icon-image":"blank4","icon-anchor":"center","icon-size":4,"icon-allow-overlap":!0,visibility:this._disabledLayers?"none":"visible"}}))},e.prototype.switchCustomLayers=function(e){if(this._map){var t=this._map;if(!e||this._disabledLayers){if(!e){if(this._disabledLayers)return;this._disabledLayers=["blank","dayLabels","canvasLayer"];for(var n=this._map.getStyle().layers,r=0;r<n.length;r++){var i=n[r];"symbol"==i.type&&"visible"==t.getLayoutProperty(i.id,"visibility")&&this._disabledLayers.push(i.id)}}var o=e?"visible":"none";this._disabledLayers.forEach(function(e){t.setLayoutProperty(e,"visibility",o)}),e&&(this._disabledLayers=void 0)}}},e.prototype.genBlackDot=function(){var e=this._map;if(!e.hasImage("blackdot")){for(var t=new Uint8Array(16384),n=new o.Point(31.5,31.5),r=0;r<64;r++)for(var i=0;i<64;i++){var a=new o.Point(r,i),l=o.Point.dist(a,n),s=Math.min(1,Math.max(0,31.5-l)),u=4*(64*i+r);t[u+0]=0,t[u+1]=0,t[u+2]=0,t[u+3]=255*s}e.addImage("blackdot",{width:64,height:64,data:t})}},e.prototype.setLayersVisibility=function(e){for(var t=0,n=["dayLabels","canvasLayer","blank"];t<n.length;t++){var r=n[t];this._map.setLayoutProperty(r,"visibility",e)}},e.prototype.showInteractive=function(e){return r(this,void 0,void 0,function(){var t;return i(this,function(n){switch(n.label){case 0:this.setLayersVisibility("none"),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,a.loadIcons(this._map,e,s.globalMapParams().interactive_icons_url)];case 2:return n.sent(),a.updateMap(this._map,e,this.lang,null),this._interactiveContent=e,a.setClickHandler("on",this._map,e,this._interactiveClickHandler),[2,!0];case 3:return t=n.sent(),console.log("Failed to load icons for interactive content."),console.log(t),this.setLayersVisibility("visible"),[2,!1];case 4:return[2]}})})},e.prototype.hideInteractive=function(){a.setClickHandler("off",this._map,this._interactiveContent,this._interactiveClickHandler),a.removeFromMap(this._map,this._interactiveContent),this.setLayersVisibility("visible")},e.ctorParameters=function(){return[]},e}();t.MapView2=p},"2+Z4":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("kYoo"),i=n("3j3K"),o=n("63Yu"),a=n("wNJ6"),l=n("Q+ap"),s=n("kEL7"),u=n("U3dH"),p=n("/Zw9"),c=n("UXVm"),d=n("z+o6"),f=n("KdFd"),h=n("r5kr"),m=[r.styles];function g(e){return i.\u0275vid(0,[i.\u0275qud(402653184,1,{days:0}),i.\u0275qud(402653184,2,{mapview:0}),i.\u0275qud(402653184,3,{mapview_parent:0}),(e()(),i.\u0275ted(null,["\n\n"])),(e()(),i.\u0275eld(0,null,null,41,"div",[["class","h100 flex-col"],["id","initerary"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\n  "])),(e()(),i.\u0275eld(0,null,null,13,"header",[["class","flex-row region region-header schedule_menu_color schedule_menu_text_color"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\n\n    "])),(e()(),i.\u0275eld(0,null,null,10,"span",[["class","title flex-auto"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\n      "])),(e()(),i.\u0275eld(0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-map"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\n       | "])),(e()(),i.\u0275eld(0,null,null,2,"span",[["class","backtohomepage"]],null,null,null,null,null)),(e()(),i.\u0275eld(0,null,null,1,"a",[["href","."]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["",""])),(e()(),i.\u0275ted(null,[" |\n      "])),(e()(),i.\u0275eld(0,null,null,1,"span",[["class","schedule-link"]],null,[[null,"click"]],function(e,t,n){var r=!0,i=e.component;"click"===t&&(r=!1!==i.fullMap()&&r);return r},null,null)),(e()(),i.\u0275ted(null,["",""])),(e()(),i.\u0275ted(null,["\n    "])),(e()(),i.\u0275ted(null,["\n  "])),(e()(),i.\u0275ted(null,["\n\n  "])),(e()(),i.\u0275eld(0,null,null,23,"div",[["class","flex-auto flex-row rotate"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\n\n    "])),(e()(),i.\u0275eld(0,null,null,1,"alert-message",[],null,null,null,a.View_AlertMessageComponent_0,a.RenderType_AlertMessageComponent)),i.\u0275did(49152,null,0,l.AlertMessageComponent,[s.AlertMessageService],null,null),(e()(),i.\u0275ted(null,["\n\n    "])),(e()(),i.\u0275ted(null,["\n    "])),(e()(),i.\u0275eld(0,null,null,7,"div",[["class","flex-auto relative"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\n      "])),(e()(),i.\u0275eld(0,[[3,0],["mapviewparent",1]],null,4,"div",[["class","abs-fill"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\n  "])),(e()(),i.\u0275eld(0,null,null,1,"mapview",[["style","display:block;width:100%;height:100%;"]],null,null,null,u.View_MapView_0,u.RenderType_MapView)),i.\u0275did(49152,[[2,4],["mapview",4]],0,p.MapView,[i.ElementRef],{compactAttribution:[0,"compactAttribution"],lang:[1,"lang"]},null),(e()(),i.\u0275ted(null,["\n      "])),(e()(),i.\u0275ted(null,["\n    "])),(e()(),i.\u0275ted(null,["\n    "])),(e()(),i.\u0275eld(0,null,null,7,"div",[["class","flex-auto relative"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\n      "])),(e()(),i.\u0275eld(0,null,null,2,"days-view",[["class","abs-fill"]],null,[[null,"selectLocation"]],function(e,t,n){var r=!0,i=e.component;"selectLocation"===t&&(r=!1!==i.selectLocation(n)&&r);return r},c.View_DaysView_0,c.RenderType_DaysView)),i.\u0275prd(512,null,d.DaysService,d.DaysService,[f.HttpClient]),i.\u0275did(638976,[[1,4],["days",4]],0,h.DaysView,[d.DaysService],{tripId:[0,"tripId"]},{selectLocation:"selectLocation"}),(e()(),i.\u0275ted(null,["\n      "])),(e()(),i.\u0275eld(0,null,null,0,"div",[["class","white-shadow"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\n    "])),(e()(),i.\u0275ted(null,["\n  "])),(e()(),i.\u0275ted(null,["\n"])),(e()(),i.\u0275ted(null,["\n"]))],function(e,t){var n=t.component;e(t,32,0,!0,n.language),e(t,40,0,n.tripId)},function(e,t){var n=t.component;e(t,14,0,n.T("back")),e(t,17,0,n.T("schedule"))})}function y(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,1,"test-app",[],null,[["window","resize"]],function(e,t,n){var r=!0;"window:resize"===t&&(r=!1!==i.\u0275nov(e,1).onResize()&&r);return r},g,t.RenderType_TestApp)),i.\u0275did(4243456,null,0,o.TestApp,[i.ChangeDetectorRef,s.AlertMessageService],null,null)],null,null)}t.RenderType_TestApp=i.\u0275crt({encapsulation:0,styles:m,data:{}}),t.View_TestApp_0=g,t.View_TestApp_Host_0=y,t.TestAppNgFactory=i.\u0275ccf("test-app",o.TestApp,y,{tripId:"tripId"},{},[])},"63Yu":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("3j3K"),i=n("Lhz1"),o=n("Z/5/"),a=n("OTRu"),l=function(){function e(e,t){this.changeDetector=e,this.AlertMessageService=t,this.location="",this.canvasWidth=512,this.canvasHeight=512,this.tripId=currentTripId,this.translations=translations,console.log("TRIP ID: "+this.tripId);var n=i.globalMapParams();this.trip=new o.SeqTrip(this.AlertMessageService),this.trip.load(n.map_settings),this.originalLocation=this.trip.location(),this.trip.setLanguage(n.language),this.language=n.language}return e.prototype.selectLocation=function(e){e?(this.location=e.name,this.latitude=e.latitude,this.longitude=e.longitude):this.location="",this.setMarker(e);var t={x:this.originalLocation.x,y:this.originalLocation.y,scale:this.originalLocation.scale};if(e){var n=Utils.latLonToWorld([e.longitude,e.latitude]);t.x=n.x,t.y=n.y,t.scale*=.5}this.renderer.setLocation(t)},e.prototype.placeClicked=function(e){var t=Utils.worldToLatLon(e.coord),n={id:null,name:"",latitude:t.lat,longitude:t.lon};this.days&&this.days.scrollTo(n),this.setMarker()},e.prototype.fullMap=function(){this.selectLocation()},e.prototype.mapWidth=function(){return this.mapview_parent?this.mapview_parent.nativeElement.clientWidth:0},e.prototype.mapHeight=function(){return this.mapview_parent?this.mapview_parent.nativeElement.clientHeight:0},e.prototype.ngAfterViewInit=function(){var e=this;setTimeout(function(){e.mapview.prepareCanvas({trip:e.trip,created:function(t,n){e.renderer=t,e.tripLayer=n,e.mapview.addAttributionControl(!0),t.pinchZoom.touchEventHandlers.push(e)}})})},e.prototype.onResize=function(){this.mapview.refresh()},e.prototype.T=function(e){for(var t=e.split("."),n=translations;t.length>0;){var r=t[0];if(!n[r])return console.log("Missing translation: "+e),e;n=n[r],t=t.slice(1)}return"object"==typeof n?(console.log("invalid translation key: "+e),e):n},e.prototype.acceptTouchEvent=function(e,t,n){if("wheel"===n)return!1;var r=this.tripLayer.findLabelAtWorldPos(t)||this.tripLayer.findNodePointAtViewerPos(e);return!!r&&(this.placeClicked(r),this.changeDetector.detectChanges(),!0)},e.prototype.handleMouseDown=function(e){e.preventDefault()},e.prototype.handleMouseMove=function(e){e.preventDefault()},e.prototype.handleMouseUp=function(e){e.preventDefault()},e.prototype.handleMouseWheel=function(e){e.preventDefault()},e.prototype.handleStart=function(e){e.preventDefault()},e.prototype.handleEnd=function(e){e.preventDefault()},e.prototype.setMarker=function(e){if(this.marker&&(this.marker.remove(),this.marker=void 0),e){var t=document.createElement("i");t.className="fa fa-map-marker",t.style.color="red",t.style.fontSize="40px",this.marker=this.mapview.addMarker(e,{element:t,anchor:"bottom"})}},e.ctorParameters=function(){return[{type:r.ChangeDetectorRef},{type:a.AlertMessageService}]},e}();t.TestApp=l},"8eCU":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("nge0"),i=function(){function e(t){if(this.properties={},t){if(t.controlPoints){this.controlPoints=[];for(var n=0;n<t.controlPoints.length;++n)this.controlPoints[n]=new r.Point(t.controlPoints[n])}t.originalEdge&&(this.originalEdge=new e(t.originalEdge));for(var i=0,o=["from","to","drawMiddlePoint","properties","fromDbId","fromIndex"];i<o.length;i++){var a=o[i];a in t&&(this[a]=t[a])}if(t.properties&&(this.properties=t.properties,t.properties.lineWidth&&(this.properties.lineWidth=parseFloat(t.properties.lineWidth)),t.properties.dashed))for(n=0;n<t.properties.dashed.length;++n)this.properties.dashed[n]=parseInt(t.properties.dashed[n])}}return e.prototype.propagateToOriginal=function(){if(this.originalEdge)for(var e=0,t=["controlPoints","drawMiddlePoint"];e<t.length;e++){var n=t[e];n in this&&(this.originalEdge[n]=this[n])}},e.prototype.getProperty=function(t,n){var r=this.properties[t]||n[t];if("geom"==t&&"route"==r){var i=this.properties.travelMean||n.travelMean;if(!e.isRoutable(i))return"straight"}return r},e.routableMeans=function(){return["Car","Bus","Bike","Walk"]},e.isRoutable=function(t){return-1!=e.routableMeans().indexOf(t)},e}();t.TripEdge=i},CLGK:function(e,t){function n(e){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+e+"'.")})}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="CLGK"},G8oB:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function l(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,l)}s((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}};function o(e,t){return!(e&&e.filter&&t)||t.indexOf(e.filter)>=0}function a(e,t){for(var n=0,r=e.getStyle().layers;n<r.length;n++){var i=r[n];if(i.type===t&&"contour_label"!==i.id&&!i.id.match(/^(water_name)|(highway)/))return i.id}}function l(e,t){if(t){if(t.beforeLayer&&e.getLayer(t.beforeLayer))return t.beforeLayer;if(t.afterLayer)for(var n=e.getStyle().layers,r=0;r<n.length;++r)if(n[r].id===t.afterLayer)return r+1<n.length?n[r+1].id:void 0;return t.beforeFirstLayerOfType?a(e,t.beforeFirstLayerOfType):e.getLayer("triangle-selection")?"triangle-selection":void 0}}function s(e,t,n){return r(this,void 0,Promise,function(){return i(this,function(r){return[2,new Promise(function(r,i){var o="jpm-"+e;if(n.hasImage(o))return r(o);var a="string"==typeof t?t+e+".png":t[e];a||i(new Error("Can't build URL for icon: "+e)),n.loadImage(a,function(e,t){return e?i(e):n.hasImage(o)?r(o):(n.addImage(o,t),r(o))})})]})})}function u(e,t){if(!t||!e.layout||!e.layout["text-field"])return e;var n=e.layout["text-field"];if("string"==typeof n&&!n.match(/LANG/))return e;var r=JSON.parse(JSON.stringify(e));return r.layout["text-field"]=function e(t,n){return Array.isArray(t)?t.map(function(t){return e(t,n)}):"string"==typeof t?n(t):t}(e.layout["text-field"],function(e){return e.replace(/LANG/,t)}),r}function p(e,t,n){for(var r=0,i=t.layers||[];r<i.length;r++){var a=i[r];e.setLayoutProperty(a.id,"visibility",o(a.metadata,n)?"visible":"none")}}function c(e,t){for(var n="function"==typeof t?t:function(e){return function(e,t){if(!e||!e.properties||!t)return!1;for(var n=Object.keys(e.properties),r=0,i=t;r<i.length;r++){var o=i[r];if(e.geometry.type==o.geometry.type&&e.geometry.coordinates.length==o.geometry.coordinates.length){for(var a=!0,l=0,s=n;l<s.length;l++){var u=s[l];if(o.properties[u]!=e.properties[u]){a=!1;break}}if(a)return!0}}return!1}(e,t)},r=[],i=e.getStyle(),o=0,a=Object.keys(i.sources);o<a.length;o++){var l=a[o];if("geojson"==i.sources[l].type){var s=i.sources[l].data;if(s&&"object"==typeof s&&"FeatureCollection"==s.type&&Array.isArray(s.features)){for(var u=0,p=0,c=s.features;p<c.length;p++){var d=c[p];if(d.properties)n(d)?(d.properties.selected||u++,d.properties.selected=!0,r.push(d)):d.properties.selected&&(u++,d.properties.selected=!1)}u>0&&e.getSource(l).setData(s)}}}return r}Object.defineProperty(t,"__esModule",{value:!0}),t.firstLayerOfType=a,t.loadIcons=function(e,t,n){return r(this,void 0,Promise,function(){var r,o,a,l,u,p,c,d,f,h,m,g,y;return i(this,function(i){if(!t||!t.sources)return[2];for(r=Object.keys(t.sources),o={circle_with_arrow:!0},a=0,l=r;a<l.length;a++)if(u=l[a],(p=t.sources[u]).data&&"string"!=typeof p.data&&"FeatureCollection"==p.data.type)for(c=0,d=p.data.features;c<d.length;c++)(f=d[c]).properties&&f.properties.icon&&(o[f.properties.icon]=!0);for(h=[],m=0,g=Object.keys(o);m<g.length;m++)y=g[m],h.push(s(y,n,e));return[2,Promise.all(h)]})})},t.setClickHandler=function(e,t,n,r){for(var i=0,o=n.layers||[];i<o.length;i++){var a=o[i];void 0!=t.getLayer(a.id)&&(a.metadata&&!1===a.metadata.clickable||("on"==e?t.on("click",a.id,r):t.off("click",a.id,r)))}},t.updateMap=function(e,t,n,r){for(var i=t.sources||{},o=0,a=Object.keys(i);o<a.length;o++){var s=a[o],c=e.getSource(s);void 0==c?e.addSource(s,t.sources[s]):t.sources[s].data&&"setData"in c&&c.setData(t.sources[s].data)}for(var d=0,f=t.layers||[];d<f.length;d++){var h=f[d];void 0==e.getLayer(h.id)&&e.addLayer(u(h,n),l(e,h.metadata))}p(e,t,r)},t.updateVisibility=p,t.removeFromMap=function(e,t){for(var n=0,r=t.layers||[];n<r.length;n++){var i=r[n];void 0!=e.getLayer(i.id)&&e.removeLayer(i.id)}for(var o=t.sources||{},a=0,l=Object.keys(o);a<l.length;a++){var s=l[a];void 0!=e.getSource(s)&&e.removeSource(s)}},t.allFilters=function(e){return e.filters?e.filters:[]},t.configureHighlightLayer=function(e,t){for(var n=c(e,t),r=0,i=["symbol","circle"];r<i.length;r++){var o=i[r],a=e.getLayer("highlight-"+o);a&&e.removeLayer(a.id)}if(n&&0!=n.length){var l="highlight-source",s=e.getSource(l),u={type:"FeatureCollection",features:n};if(s){if("geojson"!=s.type)throw new Error(l+" source should have type geojson, but it has "+s.type);s.setData(u)}else e.addSource(l,{type:"geojson",data:u});var p={id:"highlight-circle",type:"circle",source:l,paint:{"circle-radius":16,"circle-stroke-color":"rgba(255,255,255,.8)","circle-stroke-width":5,"circle-stroke-opacity":1,"circle-stroke-opacity-transition":{duration:0},"circle-color":"rgba(255,255,255,.8)","circle-opacity":0,"circle-opacity-transition":{duration:0}},filter:["==",["geometry-type"],"Point"]};e.addLayer(p);var d={id:"highlight-symbol",type:"symbol",source:l,layout:{"icon-image":["concat","jpm-",["get","icon"]],"icon-size":["*",2/64,["coalesce",["get","radius"],16]]},paint:{"icon-opacity":1,"icon-opacity-transition":{duration:0}},filter:["==",["geometry-type"],"Point"]};e.addLayer(d)}}},Lhz1:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalMapParams=function(){var e=window,t=e.global_map_params;if(!t&&thisTripApi){var n=window.cssserviceUrl||"https://destinationbook-cssservice.herokuapp.com/";e.global_map_params={locations_url:thisTripApi.locationsUrl,map_settings_url:thisTripApi.mapUrl,preferences:{line_shape:thisTripApi.lineShape},language:thisTripApi.tripLanguage,geoname_service_url:n,map_print_service_url:n},t=e.global_map_params}if(t||"undefined"==typeof mapJson||("object"==typeof mapJson&&mapJson.global_map_params?e.global_map_params=mapJson.global_map_params:e.global_map_params={map_settings:mapJson,language:mapJson.tripLanguage,geoname_service_url:"",map_print_service_url:"",hide_ui:!0},t=e.global_map_params),!t)throw new Error("Can't find map parameters");return t.preferences||(t.preferences={}),t}},OTRu:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Q+ap");t.AlertMessageComponent=r.AlertMessageComponent;var i=n("R5ku");t.AlertMessageModule=i.AlertMessageModule;var o=n("kEL7");t.AlertMessageService=o.AlertMessageService;var a=n("TtrS");t.AlertMessage=a.AlertMessage,t.AlertMessageInterface=a.AlertMessageInterface,t.AlertType=a.AlertType},"Q+ap":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("kEL7"),i=function(){function e(e){var t=this;this.alertMessageService=e,this.FADE_TIMEOUT=600,this.alertMessages=[],this.alertMessageService._alertMessage.subscribe(function(e){t.show(e)}),this.alertMessageService._removeAlertMessage.subscribe(function(e){e&&t.destroy(e.uuid)})}return e.prototype.show=function(e){var t=this;e&&(this.alertMessages.unshift(e),console.log(this.alertMessages),e.timeoutInMiliSeconds&&setTimeout(function(){t.destroy(e.uuid)},e.timeoutInMiliSeconds))},e.prototype.fade=function(e){e.state="destroyed"},e.prototype.destroy=function(e){var t=this,n=this.findIndex(this.alertMessages,"uuid",e);-1!==n&&(this.alertMessages[n].state="destroyed",setTimeout(function(){t.alertMessages.splice(n,1)},this.FADE_TIMEOUT))},e.prototype.findIndex=function(e,t,n){for(var r=0;r<e.length;r+=1)if(e[r][t]===n)return r;return-1},e.ctorParameters=function(){return[{type:r.AlertMessageService}]},e}();t.AlertMessageComponent=i},R5ku:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(){}}();t.AlertMessageModule=r},TtrS:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this._uuid=this.generateUUId(),this._type=t,this._message=e,this._state="visible"}return e.prototype.generateUUId=function(){return this.randomizer()+this.randomizer()+"-"+this.randomizer()+"-"+this.randomizer()+"-"+this.randomizer()+"-"+this.randomizer()+this.randomizer()+this.randomizer()},e.prototype.randomizer=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},Object.defineProperty(e.prototype,"message",{get:function(){return this._message},set:function(e){this._message=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeoutInMiliSeconds",{get:function(){return this._timeoutInMiliSeconds},set:function(e){this._timeoutInMiliSeconds=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uuid",{get:function(){return this._uuid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(e){this._state=e},enumerable:!0,configurable:!0}),e}();t.AlertMessage=r},U3dH:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("3j3K"),i=n("qJxO"),o=n("0qPf"),a=n("/Zw9");function l(e){return r.\u0275vid(0,[r.\u0275qud(402653184,1,{renderCanvas:0}),r.\u0275qud(402653184,2,{canvas:0}),r.\u0275qud(402653184,3,{mapview:0}),(e()(),r.\u0275eld(0,[[1,0],["renderCanvas",1]],null,0,"canvas",[["style","position: absolute;"]],[[4,"width","px"],[4,"height","px"],[1,"width",0],[1,"height",0]],null,null,null,null)),(e()(),r.\u0275eld(0,null,null,1,"mapview2",[["style","display:block; position:absolute;"]],[[4,"width","px"],[4,"height","px"]],null,null,i.View_MapView2_0,i.RenderType_MapView2)),r.\u0275did(49152,[[3,4],["mapview",4]],0,o.MapView2,[],{canvasWidth:[0,"canvasWidth"],canvasHeight:[1,"canvasHeight"],compactAttribution:[2,"compactAttribution"],lang:[3,"lang"]},null),(e()(),r.\u0275eld(0,[[2,0],["eventCanvas",1]],null,0,"canvas",[["style","position: absolute;"]],[[8,"hidden",0],[4,"width","px"],[4,"height","px"],[1,"width",0],[1,"height",0]],null,null,null,null)),(e()(),r.\u0275ted(null,["\n"])),(e()(),r.\u0275ted(null,["\n"]))],function(e,t){var n=t.component;e(t,5,0,n.getCanvasWidth(),n.getCanvasHeight(),!0,n.lang)},function(e,t){var n=t.component;e(t,3,0,n.getCanvasWidth(),n.getCanvasHeight(),n.getCanvasWidth()*n.pixelRatio(),n.getCanvasHeight()*n.pixelRatio()),e(t,4,0,n.getCanvasWidth(),n.getCanvasHeight()),e(t,6,0,n.interactive,n.getCanvasWidth(),n.getCanvasHeight(),n.getCanvasWidth()*n.pixelRatio(),n.getCanvasHeight()*n.pixelRatio())})}function s(e){return r.\u0275vid(0,[(e()(),r.\u0275eld(0,null,null,1,"mapview",[],null,null,null,l,t.RenderType_MapView)),r.\u0275did(49152,null,0,a.MapView,[r.ElementRef],null,null)],null,null)}t.RenderType_MapView=r.\u0275crt({encapsulation:2,styles:[],data:{}}),t.View_MapView_0=l,t.View_MapView_Host_0=s,t.MapViewNgFactory=r.\u0275ccf("mapview",a.MapView,s,{canvasWidth:"canvasWidth",canvasHeight:"canvasHeight",compactAttribution:"compactAttribution",lang:"lang"},{},[])},UXVm:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("ifMO"),i=n("3j3K"),o=n("2Je8"),a=n("r5kr"),l=n("z+o6"),s=n("KdFd"),u=[r.styles];function p(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,1,"h2",[],null,null,null,null,null)),(e()(),i.\u0275ted(null,["",""]))],null,function(e,t){e(t,1,0,t.component.days.title)})}function c(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,1,"div",[["class","daySubTitle"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["",""]))],null,function(e,t){e(t,1,0,t.parent.context.$implicit.subtitle)})}function d(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,1,"li",[["class","clickable schedule_location_button_color"]],null,[[null,"click"]],function(e,t,n){var r=!0,i=e.component;"click"===t&&(r=!1!==i.fireSelectLocation(e.context.$implicit)&&r);return r},null,null)),(e()(),i.\u0275ted(null,["",""]))],null,function(e,t){e(t,1,0,t.context.$implicit.name)})}function f(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,0,"div",[],[[8,"innerHTML",1]],null,null,null,null))],null,function(e,t){e(t,0,0,t.parent.context.$implicit.description)})}function h(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,2,"span",[["class","eventIndication"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["",""])),(e()(),i.\u0275eld(0,null,null,0,"br",[],null,null,null,null,null))],null,function(e,t){e(t,1,0,t.parent.context.$implicit.indication)})}function m(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,2,"span",[["class","eventIndication"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["",""])),(e()(),i.\u0275eld(0,null,null,0,"br",[],null,null,null,null,null))],null,function(e,t){var n=t.component;e(t,1,0,n.dateTimeToTime(n.toUTCDate(t.parent.context.$implicit.time)))})}function g(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,2,"span",[["class","eventTitle"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["",""])),(e()(),i.\u0275eld(0,null,null,0,"br",[],null,null,null,null,null))],null,function(e,t){e(t,1,0,t.parent.context.$implicit.title)})}function y(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,2,"span",[["class","eventSubTitle"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["",""])),(e()(),i.\u0275eld(0,null,null,0,"br",[],null,null,null,null,null))],null,function(e,t){e(t,1,0,t.parent.context.$implicit.subtitle)})}function v(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,0,"div",[["class","eventDescription"]],[[8,"innerHTML",1]],null,null,null,null))],null,function(e,t){e(t,0,0,t.parent.context.$implicit.description)})}function b(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,3,"a",[["data-gallery","gallery1"],["data-toggle","lightbox"]],[[8,"href",4]],null,null,null,null)),(e()(),i.\u0275ted(null,["\n                "])),(e()(),i.\u0275eld(0,null,null,0,"img",[["class","thumbnail-schedule"]],[[8,"src",4]],null,null,null,null)),(e()(),i.\u0275ted(null,["\n              "]))],null,function(e,t){e(t,0,0,i.\u0275inlineInterpolate(1,"",t.context.$implicit.thumb_url,"")),e(t,2,0,i.\u0275inlineInterpolate(1,"",t.context.$implicit.thumb_url,""))})}function P(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,22,"li",[["style","margin: 20px 0px; border-bottom: 1px solid #efefef;"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\n            "])),(e()(),i.\u0275and(16777216,null,null,1,null,h)),i.\u0275did(16384,null,0,o.NgIf,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),i.\u0275ted(null,["\n            "])),(e()(),i.\u0275and(16777216,null,null,1,null,m)),i.\u0275did(16384,null,0,o.NgIf,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),i.\u0275ted(null,["\n            "])),(e()(),i.\u0275and(16777216,null,null,1,null,g)),i.\u0275did(16384,null,0,o.NgIf,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),i.\u0275ted(null,["\n            "])),(e()(),i.\u0275and(16777216,null,null,1,null,y)),i.\u0275did(16384,null,0,o.NgIf,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),i.\u0275ted(null,["\n            "])),(e()(),i.\u0275and(16777216,null,null,1,null,v)),i.\u0275did(16384,null,0,o.NgIf,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),i.\u0275ted(null,["\n\n            "])),(e()(),i.\u0275eld(0,null,null,4,"div",[["class","slick-carousel"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\n              "])),(e()(),i.\u0275and(16777216,null,null,1,null,b)),i.\u0275did(802816,null,0,o.NgForOf,[i.ViewContainerRef,i.TemplateRef,i.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),i.\u0275ted(null,["\n            "])),(e()(),i.\u0275ted(null,["\n          "]))],function(e,t){e(t,3,0,t.context.$implicit.indication),e(t,6,0,t.context.$implicit.time),e(t,9,0,t.context.$implicit.title),e(t,12,0,t.context.$implicit.subtitle),e(t,15,0,t.context.$implicit.description),e(t,20,0,t.context.$implicit.pictures)},null)}function w(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,3,"a",[["data-gallery","gallery2"],["data-toggle","lightbox"]],[[8,"href",4]],null,null,null,null)),(e()(),i.\u0275ted(null,["\n            "])),(e()(),i.\u0275eld(0,null,null,0,"img",[["class","thumbnail-schedule img-fluid"]],[[8,"src",4]],null,null,null,null)),(e()(),i.\u0275ted(null,["\n          "]))],null,function(e,t){e(t,0,0,i.\u0275inlineInterpolate(1,"",t.context.$implicit.thumb_url,"")),e(t,2,0,i.\u0275inlineInterpolate(1,"",t.context.$implicit.thumb_url,""))})}function _(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,40,"li",[["style","padding:5px 20px;margin:0px;"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\n        "])),(e()(),i.\u0275eld(0,null,null,16,"header",[],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\n        "])),(e()(),i.\u0275eld(0,null,null,7,"div",[["class","day schedule_day_title_color separatorColor"],["style","width: 100%"]],null,null,null,null,null)),(e()(),i.\u0275eld(0,null,null,4,"strong",[],null,null,null,null,null)),(e()(),i.\u0275ted(null,["",""])),i.\u0275ppd(2),i.\u0275ppd(1),i.\u0275ppd(1),(e()(),i.\u0275ted(null,[", ",""])),i.\u0275ppd(2),(e()(),i.\u0275ted(null,["\n        "])),(e()(),i.\u0275eld(0,null,null,1,"div",[["class","dayTitle"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["",""])),(e()(),i.\u0275ted(null,["\n        "])),(e()(),i.\u0275and(16777216,null,null,1,null,c)),i.\u0275did(16384,null,0,o.NgIf,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),i.\u0275ted(null,["\n        "])),(e()(),i.\u0275ted(null,["\n\n        "])),(e()(),i.\u0275eld(0,null,null,4,"ul",[["class","locations"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\n          "])),(e()(),i.\u0275and(16777216,null,null,1,null,d)),i.\u0275did(802816,null,0,o.NgForOf,[i.ViewContainerRef,i.TemplateRef,i.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),i.\u0275ted(null,["\n        "])),(e()(),i.\u0275ted(null,["\n\n        "])),(e()(),i.\u0275and(16777216,null,null,1,null,f)),i.\u0275did(16384,null,0,o.NgIf,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),i.\u0275ted(null,["\n\n        "])),(e()(),i.\u0275eld(0,null,null,4,"ul",[],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\n          "])),(e()(),i.\u0275and(16777216,null,null,1,null,P)),i.\u0275did(802816,null,0,o.NgForOf,[i.ViewContainerRef,i.TemplateRef,i.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),i.\u0275ted(null,["\n        "])),(e()(),i.\u0275ted(null,["\n        "])),(e()(),i.\u0275eld(0,null,null,4,"div",[["class","slick-carousel"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\n          "])),(e()(),i.\u0275and(16777216,null,null,1,null,w)),i.\u0275did(802816,null,0,o.NgForOf,[i.ViewContainerRef,i.TemplateRef,i.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),i.\u0275ted(null,["\n        "])),(e()(),i.\u0275ted(null,["\n      "]))],function(e,t){var n=t.component;e(t,17,0,t.context.$implicit.subtitle),e(t,23,0,n.locationsForDay(t.context.$implicit)),e(t,27,0,t.context.$implicit.description),e(t,32,0,t.context.$implicit.events),e(t,38,0,t.context.$implicit.pictures)},function(e,t){var n=t.component;e(t,6,0,i.\u0275unv(t,6,0,e(t,9,0,i.\u0275nov(t.parent.parent,0),n.T(i.\u0275unv(t,6,0,e(t,8,0,i.\u0275nov(t.parent.parent,1),i.\u0275unv(t,6,0,e(t,7,0,i.\u0275nov(t.parent.parent,2),t.context.$implicit.date,"EEEE")))))))),e(t,10,0,i.\u0275unv(t,10,0,e(t,11,0,i.\u0275nov(t.parent.parent,2),t.context.$implicit.date,"dd.MM.yy"))),e(t,14,0,t.context.$implicit.title)})}function x(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,10,"div",[],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\n    "])),(e()(),i.\u0275and(16777216,null,null,1,null,p)),i.\u0275did(16384,null,0,o.NgIf,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),i.\u0275ted(null,["\n    "])),(e()(),i.\u0275eld(0,[[1,0],["dayEntryUl",1]],null,4,"ul",[["class","dayEntryUl"],["style","padding:5px;margin:5px;margin-top:10px;"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\n      "])),(e()(),i.\u0275and(16777216,null,null,1,null,_)),i.\u0275did(802816,null,0,o.NgForOf,[i.ViewContainerRef,i.TemplateRef,i.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),i.\u0275ted(null,["\n    "])),(e()(),i.\u0275ted(null,["\n  "]))],function(e,t){var n=t.component;e(t,3,0,n.days.title),e(t,8,0,n.days.days)},null)}function M(e){return i.\u0275vid(0,[i.\u0275pid(0,o.UpperCasePipe,[]),i.\u0275pid(0,o.LowerCasePipe,[]),i.\u0275pid(0,o.DatePipe,[i.LOCALE_ID]),i.\u0275qud(671088640,1,{dayEntryUl:0}),(e()(),i.\u0275eld(0,null,null,9,"div",[["class","progview"]],[[8,"scrollTop",0]],null,null,null,null)),(e()(),i.\u0275ted(null,["\n  "])),(e()(),i.\u0275and(16777216,null,null,1,null,x)),i.\u0275did(16384,null,0,o.NgIf,[i.ViewContainerRef,i.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),i.\u0275ted(null,["\n  "])),(e()(),i.\u0275eld(0,null,null,0,"div",[["id","spin-loader"]],[[8,"hidden",0]],null,null,null,null)),(e()(),i.\u0275ted(null,["\n  "])),(e()(),i.\u0275eld(0,null,null,1,"p",[],[[8,"hidden",0]],null,null,null,null)),(e()(),i.\u0275ted(null,["",""])),(e()(),i.\u0275ted(null,["\n"])),(e()(),i.\u0275ted(null,["\n"]))],function(e,t){e(t,7,0,t.component.days)},function(e,t){var n=t.component;e(t,4,0,n.scrollTop),e(t,9,0,n.days||n.error),e(t,11,0,!n.error),e(t,12,0,n.error)})}function L(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,2,"days-view",[],null,null,null,M,t.RenderType_DaysView)),i.\u0275prd(512,null,l.DaysService,l.DaysService,[s.HttpClient]),i.\u0275did(638976,null,0,a.DaysView,[l.DaysService],null,null)],function(e,t){e(t,2,0)},null)}t.RenderType_DaysView=i.\u0275crt({encapsulation:0,styles:u,data:{}}),t.View_DaysView_0=M,t.View_DaysView_Host_0=L,t.DaysViewNgFactory=i.\u0275ccf("days-view",a.DaysView,L,{tripId:"tripId"},{selectLocation:"selectLocation"},[])},Ve9u:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("nge0"),i=n("OTRu"),o=n("aQzM"),a=n("esYe"),l=function(){function e(e,t,n){this.AlertMessageService=n;var r=e||{};this.nodes=r.node||{},this.edges=r.edges||[],this.defaultEdgeProp=t}return e.generateControlPoints=function(e,t,n,i){var o=r.Point.minus(n,t).mul(1/3),a=new r.Point(-o.y,o.x);return[r.Point.plus(r.Point.plus(t,o),a),r.Point.plus(r.Point.minus(n,o),a)]},e.bezierFromPoints=function(e){for(var t=[],n=0;n<4;++n)t.push(e[n].x),t.push(e[n].y);return new Bezier(t)},e.bezierThroughPoints=function(t){for(var n=[],i=1;i<t.length;++i){var o=1===i?t[i-1]:t[i-2],a=t[i-1],l=t[i],s=i===t.length-1?t[i]:t[i+1];n.push(e.bezierFromPoints([a,r.Point.plus(a,r.Point.times(.2,r.Point.minus(l,o))),r.Point.plus(l,r.Point.times(.2,r.Point.minus(a,s))),l]))}return n},e.placeLeaderLine=function(e,t,n){e.properties||(e.properties={});var i,a=e.properties.leaderLine||"bestAnchor",l=e.properties.labelBbox;if("center"===a){l.max.x,l.min.x;var s=new r.Point((l.min.x+l.max.x)/2,(l.min.y+l.max.y)/2),u=r.Point.minus(e.coord,s);u.mul(.02),i=r.Point.plus(s,u)}else i="closestOnBbox"===a?o.BoundingBox.closestPoint(e.coord,l):d3.labeler.closestLineAnchorPoint(e.coord,{left:l.min.x,right:l.max.x,top:l.min.y,bottom:l.max.y,cx:(l.min.x+l.max.x)/2,cy:(l.min.y+l.max.y)/2});e.properties.leaderLineAnchorPixelOffset=void 0,e.properties.leaderLineAnchor=i,e.convertToPixelOffset(t,n)},e.prototype.createDefaultBezier=function(){for(var t in this.edges)for(var n=this.edges[t],r=this.nodes[n.from],i=this.nodes[n.to],o=e.generateControlPoints(void 0,r.coord,i.coord,void 0),a=0;a<o.length;++a)n.controlPoints[a]=o[a]},e.prototype.edgeProperty=function(e,t){return e.getProperty(t,this.defaultEdgeProp)},e.prototype.getEdgeRoute=function(e){if("route"==this.edgeProperty(e,"geom")&&e.properties&&e.properties.route&&e.properties.route.geom&&this.edgeProperty(e,"travelMean")==e.properties.route.mean)return e.properties.route},e.prototype.bezier=function(t){if(!t.controlPoints||t.properties.hidden)return[];if("straight"==this.edgeProperty(t,"geom"))return e.bezierThroughPoints([this.nodes[t.from].coord,this.nodes[t.to].coord]);if(2===t.controlPoints.length){var n=[this.nodes[t.from].coord,t.controlPoints[0],t.controlPoints[1],this.nodes[t.to].coord];return[e.bezierFromPoints(n)]}if(5===t.controlPoints.length){var r=[this.nodes[t.from].coord,t.controlPoints[0],t.controlPoints[1],t.controlPoints[2]],i=[t.controlPoints[2],t.controlPoints[3],t.controlPoints[4],this.nodes[t.to].coord];return[e.bezierFromPoints(r),e.bezierFromPoints(i)]}var o=[this.nodes[t.from].coord].concat(t.controlPoints,[this.nodes[t.to].coord]);return e.bezierThroughPoints(o)},e.prototype.bounds=function(){var e=new o.BoundingBox;for(var t in this.nodes)this.nodes[t].properties.skip||e.addPoint(this.nodes[t].coord);for(var t in this.edges){var n=this.edges[t],r=this.getEdgeRoute(n);if(r)for(var i=0,a=r.geom;i<a.length;i++){var l=a[i];e.addPoint(l)}else for(var s=0,u=this.bezier(n);s<u.length;s++)for(var p=0,c=u[s].getLUT(8);p<c.length;p++){l=c[p];e.addPoint(l)}}return e},e.prototype.frame=function(e,t){var n=this.bounds();if(t=t||1.1,n.max&&n.min){if(n.min.x===n.max.x){var i=new r.Point(1/32,1/32);n.addPoint(r.Point.plus(n.min,i)),n.addPoint(r.Point.minus(n.min,i))}}else n.min=new r.Point(0,0),n.max=new r.Point(1,1),t=1;e=e||(n.max.x-n.min.x)/(n.max.y-n.min.y);var a="number"==typeof t?new r.Point(t,t):t,l=r.Point.minus(n.max,n.min);l.x*=a.x,l.y*=a.y;var s,u=l.y*e;(s=l.x>u?new r.Point(l.x,l.x/e):new r.Point(l.y*e,l.y)).mul(.5);var p=r.Point.times(.5,r.Point.plus(n.max,n.min)),c=new o.BoundingBox;return c.addPoint(r.Point.minus(p,s)),c.addPoint(r.Point.plus(p,s)),c},e.prototype.location=function(e,t){var n=this.frame(e,t);n.max.x,n.min.x;return{x:(n.max.x+n.min.x)/2,y:(n.max.y+n.min.y)/2,scale:Math.max(1/32768,n.max.x-n.min.x)}},e.prototype.compareNodes=function(e){var t=function(e,t){for(var n in e)if(!(n in t))return!1;return!0};return t(this.nodes,e.nodes)&&t(e.nodes,this.nodes)},e.prototype.getEdgeDirections=function(e,t){var n=this,o=Utils.worldToLatLon(this.nodes[e.from].coord),l=Utils.worldToLatLon(this.nodes[e.to].coord),s=new i.AlertMessage("Finding route from "+this.nodes[e.from].label+" to "+this.nodes[e.to].label+" is taking longer than usual, please check your internet connection or Openrouteservice status","alert-warning"),u=setTimeout(function(){n.AlertMessageService.alert(s),setTimeout(function(){n.AlertMessageService.removeAlert(s)},1e4)},2e3);return a.getDirections(o,l,t).then(function(i){clearTimeout(u),n.AlertMessageService.removeAlert(s);var o=i.geometry.coordinates.map(function(e){return new r.Point(Utils.latLonToWorld(e))}),l={mean:t,geom:o,from:e.from,to:e.to,midpoint:a.midPoint(o)};return i.summary&&(l.distance_m=i.summary.distance,l.duration_s=i.summary.duration),l}).catch(function(e){throw console.log(e),clearTimeout(u),e})},e}();t.TripGraph=l},VgMH:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function l(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,l)}s((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n("nge0"),a=n("Lhz1");function l(e){if(!e)throw new Error("worldToLatLon: Point is not defined");var t=Utils.worldToLatLon(e);return[t.lon,t.lat]}function s(e,t,n){var r={sources:{},layers:[],filters:[],articleId:t},i="ic-"+t,o={};if(e.length>0){var a={"icon-image":["concat","jpm-",["get","icon"]],"icon-size":["*",2/64,["coalesce",["get","radius"],16]]};n.withText&&(a["text-optional"]=!0,a["text-size"]=12,a["text-field"]=["coalesce",["get","name:LANG"],["get","name"]],a["text-font"]=n.textFont||["match",["get","fontName"],"noto",["literal",["Noto Sans Bold"]],["literal",["Open Sans Regular"]]],a["text-anchor"]=n.textAnchor||"top",a["text-offset"]="left"==n.textAnchor?[1.75,0]:[0,1.2],"left"==n.textAnchor&&(a["text-justify"]="left",a["text-size"]=10),o["text-halo-color"]="rgba(255,255,255,0.8)",o["text-halo-width"]=1.5);for(var s="source-symbol-"+i,u=function(e,t){for(var n={},r=0,i=e;r<i.length;r++){var o=i[r];o.properties&&void 0!=o.properties.publishedIcon?n[o.properties.publishedIcon]=1:n[t||"generic"]=1}return Object.keys(n)}(e,n.defaultIcon),p=0,c=u;p<c.length;p++){var d=c[p],f={type:"symbol",id:"symbol-"+i+"-"+d,source:s,layout:a,filter:["==","icon",d],metadata:{filter:d}};o&&(f.paint=o),r.layers.push(f),r.filters.push({key:d,icon:d})}r.sources[s]={type:"geojson",data:function(e,t){var n=[];for(var r in e){var i=e[r];if(!i.properties.skip){for(var o=i.properties||{},a={name:i.label,icon:o.publishedIcon||t||"generic"},s=0,u=Object.keys(o);s<u.length;s++){var p=u[s];p.match(/name_/)&&(a[p.replace("_",":")]=o[p])}for(var c={type:"Feature",geometry:{type:"Point",coordinates:l(i.coord)},properties:a},d={poiId:"poi-id",articleId:"articleID"},f=0,h=Object.keys(d);f<h.length;f++){var m=h[f];o[m]&&(c.properties[d[m]]=o[m])}n.push(c)}}return{type:"FeatureCollection",features:n}}(e,n.defaultIcon)}}return r}function u(e,t,n){return r(this,void 0,Promise,function(){var o=this;return i(this,function(a){switch(a.label){case 0:return[4,Promise.all(e.map(function(e){return r(o,void 0,void 0,function(){var o;return i(this,function(a){switch(a.label){case 0:return o={edge:e},[4,function(e,t,n){return r(this,void 0,Promise,function(){var r,o,a,s,u,p,c,d,f;return i(this,function(i){switch(i.label){case 0:if(r=n.nodes,o=t.edgeProperty(e,"geom"),e.properties&&e.properties.hidden||r[e.from].properties.skip||r[e.to].properties.skip)return[2,[]];if("route"!=o)return[3,5];if(a=n.getEdgeRoute(e),s="route data from: "+r[e.from].label+" to "+r[e.to].label,a)return[3,4];console.log("Trying to fetch missing "+s+"."),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,n.getEdgeDirections(e,n.edgeProperty(e,"travelMean"))];case 2:return a=i.sent(),console.log("Done fetching "+s+"."),e.properties.route=a,[3,4];case 3:return i.sent(),console.log("Failed to fetch "+s+"."),[3,4];case 4:if(a&&a.geom)return[2,a.geom.map(l)];o="straight",i.label=5;case 5:if("straight"==o)return[2,[r[e.from].coord,r[e.to].coord].map(l)];if(2==e.controlPoints.length){for(u=[r[e.from].coord,e.controlPoints[0],e.controlPoints[1],r[e.to].coord],p=[],c=0,d=u;c<d.length;c++)f=d[c],p.push(f.x),p.push(f.y);return[2,new Bezier(p).getLUT(128).map(l)]}return console.log("Unexpected edge structure, not drawing"),[2,[]]}})})}(e,t,n)];case 1:return[2,(o.coords=a.sent(),o)]}})})}))];case 1:return[2,{type:"FeatureCollection",features:a.sent().map(function(e){var n={mean:t.edgeProperty(e.edge,"travelMean"),color:t.edgeProperty(e.edge,"lineColor"),width:parseFloat(t.edgeProperty(e.edge,"lineWidth"))};return{type:"Feature",geometry:{type:"LineString",coordinates:e.coords},properties:n}})}]}})})}function p(e,t){var n,r=t.nodes,i=t.edgeProperty(e,"geom");if(e.properties&&e.properties.hidden||r[e.from].properties.skip||r[e.to].properties.skip)return[];if("route"===i&&e.properties.route&&e.properties.route.midpoint)n=[e.properties.route.geom[e.properties.route.midpoint]];else if("spline"==i){var a=t.bezier(e);n=[];for(var s=0,u=a;s<u.length;s++){var p=u[s];n.push(new o.Point(p.get(.5)))}}else if("straight"==i){var c=r[e.from].coord,d=r[e.to].coord;n=[o.Point.plus(c,d).mul(.5)]}else n=[];var f={Bike:"bicycle-solid",Bus:"bus-solid",Car:"car-solid",Helicopter:"helicopter-solid",Plane:"plane-solid",Boat:"ship-solid",Train:"train-solid",Walk:"walking-solid"},h=t.edgeProperty(e,"travelMean");return n.map(function(t){var n=r[e.from].coord,i=r[e.to].coord,a=o.Point.minus(i,n),s=180*Math.atan2(a.x,-a.y)/Math.PI;return{type:"Feature",geometry:{type:"Point",coordinates:l(t)},properties:{orient:s,icon:f[h]}}})}function c(e,t,n){if(t){var r,i,o,l,s,u=e+"-poly";switch(n.sources[u]={type:"geojson",data:t},function(){var e=a.globalMapParams();if(e.preferences&&e.preferences.map_style)return e.preferences.map_style;return}()){case"topo":case"streets":i="#000000",o=r="#ffffff",l=s=.2;break;case"positron":case"https://api.maptiler.com/maps/dda79759-12f3-4996-b7c3-b3df0f9e4676/style.json?key=e7trAnc5053j8mX60MlQ":i="#000000",o="#664444",r="#000000",l=.15,s=.25}var p={type:"fill",id:e+"-poly-fill",source:u,paint:{"fill-color":["case",["coalesce",["get","selected"],!1],i,r],"fill-opacity":["case",["coalesce",["get","selected"],!1],s,l]},metadata:{beforeFirstLayerOfType:"symbol"}},c={type:"line",id:e+"-poly-line",source:u,layout:{"line-join":"round"},paint:{"line-color":["coalesce",["get","stroke"],o],"line-width":["coalesce",["get","stroke-width"],6]},metadata:{afterLayer:p.id}};n.layers||(n.layers=[]),n.layers.push(p),n.layers.push(c)}}t.worldToLatLon=l,t.buildInteractiveContent=function(e){return r(this,void 0,Promise,function(){var t,n;return i(this,function(o){switch(o.label){case 0:return(t=function(e){var t=(e._tripData.additionalPlaces||[]).filter(function(e){return e.name.match(/^kml-/)}),n=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if(r.properties&&r.properties.articleId)return"a:"+r.properties.articleId}}(t);if(void 0!=n){var r=s(t,n,{defaultIcon:"generic",withText:!0,textAnchor:"left",textFont:["Noto Sans Bold"]});return c(n,e.getInteractiveData(),r),r}}(e))?[2,t]:(l=a.globalMapParams(),(n=l.day_id?"d:"+l.day_id:l.trip_id?"t:"+l.trip_id:void 0)?(t=function(e,t){return s(t._tripData.places||[],e,{defaultIcon:"tripstop",withText:!0,textFont:["Noto Sans Bold"]})}(n,e),[4,function(e,t,n){return r(this,void 0,void 0,function(){var r,o,a,l,s,c,d,f,h,m,g,y,v,b,P;return i(this,function(i){switch(i.label){case 0:return r=e.makeGraph(),0==(o=r.edges||[]).length?[2]:(l={type:"line",id:"edge-"+t,source:a="s-edge-"+t,layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":["get","color"],"line-width":["get","width"]},metadata:{beforeFirstLayerOfType:"symbol",filter:"tripstop",clickable:!1}},n.layers.push(l),s=n.sources,c=a,d={type:"geojson"},[4,u(o,e,r)]);case 1:for(s[c]=(d.data=i.sent(),d),f={type:"FeatureCollection",features:[]},h=0,m=o;h<m.length;h++)g=m[h],(y=e.edgeProperty(g,"travelMean"))&&"Unspecified"!=y&&(f.features=f.features.concat(p(g,r)));return f.features.length>0&&(v=a+"-mean",n.sources[v]={type:"geojson",data:f},b={type:"symbol",id:l.id+"-bubble",source:v,layout:{"icon-image":"jpm-circle_with_arrow","icon-size":.25,"icon-ignore-placement":!0,"icon-rotation-alignment":"map","icon-rotate":{type:"identity",property:"orient"},"icon-padding":0},metadata:{filter:"tripstop",beforeLayer:n.layers[0].id,clickable:!1}},n.layers.push(b),P={type:"symbol",id:l.id+"-mean",source:v,layout:{"icon-image":["concat","jpm-",["get","icon"]],"icon-size":10/64,"icon-ignore-placement":!0,"icon-rotate":["case",["==",["get","icon"],"plane-solid"],["-",["get","orient"],90],0],"icon-padding":18},metadata:{filter:"tripstop",afterLayer:b.id,clickable:!1}},n.layers.push(P)),[2]}})})}(e,n,t)]):[3,2]);case 1:o.sent(),o.label=2;case 2:return[2,t]}var l})})}},XJCn:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.environment={production:!1}},YfwQ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("3j3K"),i=n("nUeW"),o=n("63Yu"),a=n("2+Z4"),l=n("2Je8"),s=n("Qbdm"),u=n("1GJ2"),p=n("KN8t"),c=n("KdFd"),d=n("Um43"),f=n("kEL7"),h=n("z+o6"),m=n("R5ku");t.AppModuleNgFactory=r.\u0275cmf(i.AppModule,[o.TestApp],function(e){return r.\u0275mod([r.\u0275mpd(512,r.ComponentFactoryResolver,r.\u0275CodegenComponentFactoryResolver,[[8,[a.TestAppNgFactory]],[3,r.ComponentFactoryResolver],r.NgModuleRef]),r.\u0275mpd(5120,r.LOCALE_ID,r.\u0275m,[[3,r.LOCALE_ID]]),r.\u0275mpd(4608,l.NgLocalization,l.NgLocaleLocalization,[r.LOCALE_ID]),r.\u0275mpd(4608,r.Compiler,r.Compiler,[]),r.\u0275mpd(5120,r.APP_ID,r.\u0275f,[]),r.\u0275mpd(5120,r.IterableDiffers,r.\u0275k,[]),r.\u0275mpd(5120,r.KeyValueDiffers,r.\u0275l,[]),r.\u0275mpd(4608,s.DomSanitizer,s.\u0275e,[l.DOCUMENT]),r.\u0275mpd(6144,r.Sanitizer,null,[s.DomSanitizer]),r.\u0275mpd(4608,s.HAMMER_GESTURE_CONFIG,s.HammerGestureConfig,[]),r.\u0275mpd(5120,s.EVENT_MANAGER_PLUGINS,function(e,t,n,r){return[new s.\u0275DomEventsPlugin(e),new s.\u0275KeyEventsPlugin(t),new s.\u0275HammerGesturesPlugin(n,r)]},[l.DOCUMENT,l.DOCUMENT,l.DOCUMENT,s.HAMMER_GESTURE_CONFIG]),r.\u0275mpd(4608,s.EventManager,s.EventManager,[s.EVENT_MANAGER_PLUGINS,r.NgZone]),r.\u0275mpd(135680,s.\u0275DomSharedStylesHost,s.\u0275DomSharedStylesHost,[l.DOCUMENT]),r.\u0275mpd(4608,s.\u0275DomRendererFactory2,s.\u0275DomRendererFactory2,[s.EventManager,s.\u0275DomSharedStylesHost]),r.\u0275mpd(5120,u.AnimationDriver,p.\u0275c,[]),r.\u0275mpd(5120,u.\u0275AnimationStyleNormalizer,p.\u0275d,[]),r.\u0275mpd(4608,u.\u0275AnimationEngine,p.\u0275b,[u.AnimationDriver,u.\u0275AnimationStyleNormalizer]),r.\u0275mpd(5120,r.RendererFactory2,p.\u0275e,[s.\u0275DomRendererFactory2,u.\u0275AnimationEngine,r.NgZone]),r.\u0275mpd(6144,s.\u0275SharedStylesHost,null,[s.\u0275DomSharedStylesHost]),r.\u0275mpd(4608,r.Testability,r.Testability,[r.NgZone]),r.\u0275mpd(4608,s.Meta,s.Meta,[l.DOCUMENT]),r.\u0275mpd(4608,s.Title,s.Title,[l.DOCUMENT]),r.\u0275mpd(4608,c.HttpXsrfTokenExtractor,c.\u0275g,[l.DOCUMENT,r.PLATFORM_ID,c.\u0275e]),r.\u0275mpd(4608,c.\u0275h,c.\u0275h,[c.HttpXsrfTokenExtractor,c.\u0275f]),r.\u0275mpd(5120,c.HTTP_INTERCEPTORS,function(e){return[e]},[c.\u0275h]),r.\u0275mpd(4608,c.\u0275d,c.\u0275d,[]),r.\u0275mpd(6144,c.XhrFactory,null,[c.\u0275d]),r.\u0275mpd(4608,c.HttpXhrBackend,c.HttpXhrBackend,[c.XhrFactory]),r.\u0275mpd(6144,c.HttpBackend,null,[c.HttpXhrBackend]),r.\u0275mpd(5120,c.HttpHandler,c.\u0275interceptingHandler,[c.HttpBackend,[2,c.HTTP_INTERCEPTORS]]),r.\u0275mpd(4608,c.HttpClient,c.HttpClient,[c.HttpHandler]),r.\u0275mpd(4608,d.AnimationBuilder,p.\u0275BrowserAnimationBuilder,[r.RendererFactory2,s.DOCUMENT]),r.\u0275mpd(4608,f.AlertMessageService,f.AlertMessageService,[]),r.\u0275mpd(4608,h.DaysService,h.DaysService,[c.HttpClient]),r.\u0275mpd(512,l.CommonModule,l.CommonModule,[]),r.\u0275mpd(1024,r.ErrorHandler,s.\u0275a,[]),r.\u0275mpd(1024,r.APP_INITIALIZER,function(e,t){return[s.\u0275c(e,t)]},[[2,s.NgProbeToken],[2,r.NgProbeToken]]),r.\u0275mpd(512,r.ApplicationInitStatus,r.ApplicationInitStatus,[[2,r.APP_INITIALIZER]]),r.\u0275mpd(131584,r.\u0275e,r.\u0275e,[r.NgZone,r.\u0275Console,r.Injector,r.ErrorHandler,r.ComponentFactoryResolver,r.ApplicationInitStatus]),r.\u0275mpd(2048,r.ApplicationRef,null,[r.\u0275e]),r.\u0275mpd(512,r.ApplicationModule,r.ApplicationModule,[r.ApplicationRef]),r.\u0275mpd(512,s.BrowserModule,s.BrowserModule,[[3,s.BrowserModule]]),r.\u0275mpd(512,c.HttpClientXsrfModule,c.HttpClientXsrfModule,[]),r.\u0275mpd(512,c.HttpClientModule,c.HttpClientModule,[]),r.\u0275mpd(512,p.BrowserAnimationsModule,p.BrowserAnimationsModule,[]),r.\u0275mpd(512,m.AlertMessageModule,m.AlertMessageModule,[]),r.\u0275mpd(512,i.AppModule,i.AppModule,[]),r.\u0275mpd(256,c.\u0275e,"XSRF-TOKEN",[]),r.\u0275mpd(256,c.\u0275f,"X-XSRF-TOKEN",[])])})},YpSn:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n){this.name=e,this.width_mm=t,this.height_mm=n}return e.fromPt=function(t,n,r){return new e(t,n/e.mmToPoint,r/e.mmToPoint)},e.fromIPageSize=function(t){return new e(t.name,t.width_mm,t.height_mm)},e.prototype.widthPt=function(){return Math.round(this.width_mm*e.mmToPoint)},e.prototype.heightPt=function(){return Math.round(this.height_mm*e.mmToPoint)},e.prototype.key=function(){return Math.round(this.width_mm)+"x"+Math.round(this.height_mm)},e.mmToPoint=2.83465,e}();t.PageSize=r},"Z/5/":function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function l(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,l)}s((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n("nge0"),a=n("Lhz1"),l=n("8eCU"),s=n("Ve9u"),u=n("x/Ch"),p=n("/IiW"),c=n("YpSn"),d=n("VgMH"),f=n("ZpN4"),h=function(){function e(e){this.AlertMessageService=e,this.reset()}return e.makePlaneIcon=function(e,t){var n=new u.TripNode;return n.name=t.dbid+"-"+e,n.labelIcon={url:"/ng-map/assets/plane.png",width:20,autorotate:Math.PI/2*("landing"===e?1:-1),ratioX:.5,ratioY:"landing"===e?0:1},n.coord=t.coord,n.properties={point:!1,leaderLine:"center",dashed:[5,3],leaderLineWidth:2,maxLeaderLineLength:2},n},e.prototype.places=function(){return this._tripData.places},e.prototype.stages=function(){return this._tripData.stages},e.prototype.setLocation=function(e){this._tripData.location=e},e.prototype.location=function(){return this._tripData.location},e.prototype.width_mm=function(){return this._tripData.width},e.prototype.height_mm=function(){return this._tripData.height},e.prototype.pageSizeName=function(){return this._tripData.pageSizeName},e.prototype.world=function(){return this._tripData.world||(this._tripData.world={}),this._tripData.world},e.prototype.setSize=function(e,t,n){this._tripData.width=t,this._tripData.height=n,this._tripData.pageSizeName=e},e.prototype.defaultRadius=function(){return this._tripData.defaultRadius},e.prototype.defaultTextProp=function(){return this._tripData.defaultTextProp||(this._tripData.defaultTextProp={}),this._tripData.defaultTextProp},e.prototype.defaultEdgeProp=function(){return this._tripData.defaultEdgeProp||(this._tripData.defaultEdgeProp=e.defaultTrip().defaultEdgeProp),this._tripData.defaultEdgeProp},e.prototype.edgeProperty=function(e,t){var n=e.properties[t]||this._tripData.defaultEdgeProp[t];if("geom"==t&&"route"==n){var r=e.properties.travelMean||this._tripData.defaultEdgeProp.travelMean;if(!r||!l.TripEdge.isRoutable(r))return"straight"}return n},e.prototype.nodeProperty=function(e,t){return e.properties[t]||this._tripData.defaultTextProp[t]},e.prototype.reset=function(){this._tripData=e.defaultTrip()},e.defaultTrip=function(){window;var e=a.globalMapParams().preferences||{},t=new c.PageSize("Full page",128,190);if(e.default_page_size&&e.page_sizes)for(var n=0,r=e.page_sizes;n<r.length;n++){var i=r[n];if(i.name==e.default_page_size){t=i;break}}return{places:[],stages:[],additionalPlaces:[],location:{x:.5,y:.5,scale:1/8},defaultRadius:8,width:t.width_mm,height:t.height_mm,pageSizeName:t.name,borderColor:"#fefefe",landColor:"#cecece",seaColor:"#c4e3ff",showRivers:!1,world:{},defaultTextProp:Object.assign({fontSize:12,font:"'PT Sans', sans-serif",stroke:"rgba(255,255,255,.8)",fill:"#000000"},e.default_node_prop),defaultEdgeProp:Object.assign({lineWidth:2,lineColor:"#000000",geom:e.line_shape||"straight"},e.default_edge_prop)}},e.prototype.setPlaces=function(e){this._tripData.places.splice.apply(this._tripData.places,[0,this._tripData.places.length].concat(e)),this.updateStages(),this.updateLandingsAndTakeoff()},e.prototype.stagesAsDict=function(){for(var e={},t=0,n=this._tripData.stages;t<n.length;t++){var r=n[t];r.from in e||(e[r.from]={}),e[r.from][r.to]=r}return e},e.prototype.edgeFrom=function(e){for(var t=0,n=this._tripData.stages;t<n.length;t++){var r=n[t];if(r.from==e)return r}},e.prototype.updateStages=function(){for(var e=this._tripData.places,t=e.length-1,n=(this._tripData.stages,[]),r=this.stagesAsDict(),i=1;i<=t;++i){var o=e[i-1].dbid,a=e[i].dbid;if(r[o]&&r[o][a]){var u=r[o][a];u.to=e[i].name,u.fromIndex=i-1,n.push(u)}else n.push(new l.TripEdge({from:e[i-1].name,fromIndex:i-1,to:e[i].name,fromDbId:o,controlPoints:s.TripGraph.generateControlPoints(i>=2?e[i-2].coord:void 0,e[i-1].coord,e[i].coord,i+1<e.length?e[i+1].coord:void 0),properties:e[i-1].followingEdgeProp||{}}))}this._tripData.stages.splice.apply(this._tripData.stages,[0,this._tripData.stages.length].concat(n))},e.prototype.updateLandingsAndTakeoff=function(){for(var t={},n=this._tripData.additionalPlaces,r=0;r<n.length;++r)t[n[r].name]=r;for(var i=[],o={},a={},l=["landing","takeoff"],s=0,u=this._tripData.places;s<u.length;s++)for(var p=u[s],c=0,d=l;c<d.length;c++){var f=d[c],h=p.dbid+"-"+f;a[h]=!0,!p.properties.skip&&p.properties[f]?h in t||i.push(e.makePlaneIcon(f,p)):h in t&&(o[h]=!0)}var m=/-(landing|takeoff)$/,g=n.filter(function(e){return!(e.name in o)&&(e.name in a||null==e.name.match(m))}).concat(i);this._tripData.additionalPlaces.splice.apply(this._tripData.additionalPlaces,[0,this._tripData.additionalPlaces.length].concat(g))},e.prototype.nodeRadius=function(e,t){var n=this._tripData.defaultRadius;return e.properties&&e.properties.radius&&(n=e.properties.radius),n*t},e.prototype.makeGraph=function(e){for(var t={},n=function(e,n){var r=u.TripNode.parse(e);r.name=e.name+","+n.name,r.allPlaces=e.allPlaces.concat([n]);var i=e.label.split("\n");return i.indexOf(n.label)<0&&i.push(n.label),r.label=i.join("\n"),t[e.name]=t[n.name]=r.name,r},r=function(e){for(var n=e;n in t;)n=t[n];return n},i=0,a=this._tripData.places;i<a.length;i++){if(!(w=a[i]).name)throw new Error("nodes should have names and labels")}var l=[];if(e){for(var c=e.renderer.pinchZoom,d=e.renderer.pixelRatio,h=0,m=this._tripData.places;h<m.length;h++){(L=m[h]).viewerPos=c.viewerPosFromWorldPos(L.coord)}for(var g=0,y=this._tripData.places;g<y.length;g++){if(!(!(L=y[g]).label||L.properties&&L.properties.skip)){for(var v=this.nodeRadius(L,d),b=!0,P=0;P<l.length;++P){var w=l[P];if(o.Point.dist(w.viewerPos,L.viewerPos)<this.nodeRadius(w,d)+v){l[P]=n(w,L),b=!1;break}}if(b)L.properties||(L.properties={}),(M=u.TripNode.parse(L)).place=L,M.allPlaces=[L],l.push(M)}}}else for(var _=0,x=this._tripData.places;_<x.length;_++){var M,L=x[_];(M=u.TripNode.parse(L)).place=L,M.allPlaces=[L],l.push(M)}var C=this._tripData.places,T={};for(P=0;P<C.length;++P){T[(w=C[P]).name]=P}for(var k=new s.TripGraph(void 0,this._tripData.defaultEdgeProp,this.AlertMessageService),O=0,D=l;O<D.length;O++){w=D[O];k.nodes[w.name]=w}this.updateLandingsAndTakeoff();for(var S=0,I=this._tripData.additionalPlaces;S<I.length;S++){w=I[S];k.nodes[w.name]=w}for(var E=0,A=this._tripData.stages;E<A.length;E++){var R=A[E];if(void 0==R.fromIndex&&(R.fromIndex=T[R.from]),!(R.properties.hidden||C[R.fromIndex]&&C[R.fromIndex].isSkipped())){var F=r(R.from),N=R.fromIndex+1;if(!Number.isNaN(N)){for(;N<C.length&&C[N].isSkipped();)++N;if(!(N>=C.length||C[N].isSkipped())){var j=r(C[N].name);if(F!==j){var z=p.TripGraphLayer.shallowCopy(R);z.from=F,z.to=j,z.originalEdge=R;var V=z.properties.route;V&&V.from==F&&V.to==j&&V.mean==R.properties.travelMean||(R.properties.travelMean&&"Unspecified"!=R.properties.travelMean?z.properties.route={mean:R.properties.travelMean,from:F,to:j,distance_m:f.CrowFliesDistanceInMeters(C[N].coord,C[R.fromIndex].coord)}:delete z.properties.route),k.edges.push(z)}}}}}return k},e.prototype.save=function(){return r(this,void 0,Promise,function(){var e;return i(this,function(t){switch(t.label){case 0:return e=this._tripData,[4,d.buildInteractiveContent(this)];case 1:return e.interactiveContent=t.sent(),[2,this._tripData]}})})},e.prototype.load=function(e){if("string"==typeof e&&(e=JSON.parse(e)),!e||!e.places||!e.stages)throw new Error("no data");var t=e,n=function(e){for(var t=0;t<e.length;++t)e[t]=u.TripNode.parse(e[t])};n(t.places);for(var r=t.stages,i=0;i<r.length;++i)r[i]=new l.TripEdge(r[i]),void 0==r[i].fromIndex&&(r[i].fromIndex=i);n(t.additionalPlaces),this._tripData=t,this.defaultEdgeProp(),this.setSize(e.pageSizeName,e.width,e.height)},e.prototype.seaColor=function(){return this._tripData.seaColor},e.prototype.setSeaColor=function(e){this._tripData.seaColor=e},e.prototype.landColor=function(){return this._tripData.landColor},e.prototype.setLandColor=function(e){this._tripData.landColor=e},e.prototype.borderColor=function(){return this._tripData.borderColor},e.prototype.setBorderColor=function(e){this._tripData.borderColor=e},e.prototype.showRivers=function(){return this._tripData.showRivers},e.prototype.toggleShowRiver=function(){this._tripData.showRivers=!this._tripData.showRivers},e.prototype.language=function(){return this._tripData.language||"en"},e.prototype.setLanguage=function(e){this._tripData.language=e},e.prototype.placeByName=function(e){for(var t=0,n=this._tripData.places;t<n.length;t++){var r=n[t];if(e===r.name)return r}},e.prototype.markFirstLocation=function(){for(var e=0,t=this._tripData.places;e<t.length;e++){"firstVisited"in(i=t[e]).properties&&delete i.properties.firstVisited}for(var n=0,r=this._tripData.places;n<r.length;n++){var i;if(!(!(i=r[n]).label||i.properties&&i.properties.skip))return void(i.properties.firstVisited=!0)}},e.prototype.clearUserPlacements=function(){for(var e=0,t=this._tripData.additionalPlaces.concat(this._tripData.places);e<t.length;e++){var n=t[e];n.properties&&(n.properties.userPlacement&&delete n.properties.userPlacement,n.properties.userPlacementPixelOffset&&delete n.properties.userPlacementPixelOffset)}},e.prototype.getMapStyle=function(){return a.globalMapParams().preferences.map_style||"streets"},e.prototype.filterAdditionalPlace=function(e){var t=this._tripData.additionalPlaces.filter(e);this._tripData.additionalPlaces.splice.apply(this._tripData.additionalPlaces,[0,this._tripData.additionalPlaces.length].concat(t))},e.prototype.setAdditionalPlace=function(e){var t=this._tripData.additionalPlaces,n=t.find(function(t){return t.name==e.name});n?t[t.indexOf(n)]=e:t.push(e)},e.prototype.renameNodes=function(e,t,n){for(var r=0,i=this._tripData.places;r<i.length;r++){var o=i[r];-1!=o.name.search(e)&&(o.label=o.label.replace(t,n))}},e.prototype.getInteractiveData=function(){return this._tripData.interactiveData},e.prototype.clearInteractiveData=function(){this._tripData.interactiveData&&delete this._tripData.interactiveData},e.prototype.addInteractiveData=function(e){this._tripData.interactiveData||(this._tripData.interactiveData={type:"FeatureCollection",features:[]}),this._tripData.interactiveData.features.push(e)},e}();t.SeqTrip=h},ZpN4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("VgMH");t.CrowFliesDistanceInMeters=function(e,t){var n=r.worldToLatLon(e),i=r.worldToLatLon(t),o=Math.PI*n[1]/180,a=Math.PI*i[1]/180,l=Math.PI*n[0]/180-Math.PI*i[0]/180,s=Math.sin(o)*Math.sin(a)+Math.cos(o)*Math.cos(a)*Math.cos(l);return 1609.344*(s=60*(s=180*(s=Math.acos(s))/Math.PI)*1.1515)}},aQzM:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("nge0"),i=function(){function e(e){e&&(e.min&&(this.min=new r.Point(e.min)),e.max&&(this.max=new r.Point(e.max)))}return e.closestPoint=function(e,t){var n=new r.Point(0,0);for(var i in n)e[i]<t.min[i]?n[i]=t.min[i]:e[i]>t.max[i]?n[i]=t.max[i]:n[i]=e[i];return n},e.overlaps=function(e,t){return!(e.max.x<t.min.x||e.min.x>t.max.x||e.max.y<t.min.y||e.min.y>t.max.y)},e.contains=function(e,t){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y},e.prototype.addPoint=function(e){this.min=void 0===this.min?new r.Point(e):r.Point.min(this.min,e),this.max=void 0===this.max?new r.Point(e):r.Point.max(this.max,e)},e.prototype.addArray=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];this.addPoint(r)}},e.prototype.overlaps=function(t){return e.overlaps(this,t)},e.prototype.contains=function(t){return e.contains(this,t)},e}();t.BoundingBox=i},esYe:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function l(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,l)}s((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n("nge0"),a={};var l={};function s(e){var t=this,n=JSON.stringify(e);return l[n]?l[n]:l[n]=r(t,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(e){return r(this,void 0,Promise,function(){return i(this,function(t){return[2,new Promise(function(t,n){$.getJSON("https://overpass-api.de/api/interpreter?data="+encodeURIComponent('[out:json];(way["highway"~"^(road|motorway|trunk|primary|secondary|tertiary|residential)$"]["access:conditional"!~"no"]["access"!~"no"]["name"](around:15000,'+e.lat+","+e.lon+");>;);out 32;\n")).done(function(r){if(r&&Array.isArray(r.elements)&&r.elements.length>=1&&r.elements[0].lat&&r.elements[0].lon){var i=function(e,t){for(var n,r,i,o,a,l,s=0,u=t;s<u.length;s++){var p=u[s],c=(o=p,a=(i=e).lat-o.lat,l=i.lon-o.lon,Math.sqrt(a*a+l*l));(void 0==n||c<n)&&(n=c,r=p)}return r}(e,r.elements);t(i)}else n("Bad or empty reply from overpass")}).fail(n)})]})})}(e)];case 1:return[2,t.sent()];case 2:return t.sent(),[3,3];case 3:return t.trys.push([3,5,,6]),[4,function(e){var t=["https://api.openrouteservice.org/geocode/reverse?api_key=5b3ce3597851110001cf6248e0fee72951d5494c8b4cf5d8b4ff2b76","point.lat="+e.lat,"point.lon="+e.lon,"sources=oa"].join("&");return new Promise(function(e,n){$.getJSON(t).done(function(t){t&&t.features&&t.features[0]&&t.features[0].geometry&&t.features[0].geometry.coordinates?e({lon:t.features[0].geometry.coordinates[0],lat:t.features[0].geometry.coordinates[1]}):n(new Error("Empty or bad data from openrouteservice"))}).fail(function(e){"object"==typeof e&&"number"==typeof e.status&&e.status>=400&&e.status<500&&n(e),n(e)})})}(e)];case 4:return[2,t.sent()];case 5:return t.sent(),[3,6];case 6:return[2,e]}})})}function u(e,t,n){var r=["https://api.openrouteservice.org/directions?api_key=5b3ce3597851110001cf6248e0fee72951d5494c8b4cf5d8b4ff2b76","coordinates="+e.lon+"%2C"+e.lat+"%7C"+t.lon+"%2C"+t.lat,"profile="+n,"geometry_format=geojson","geometry_simplify=true","radiuses=-1%7C-1"].join("&");return new Promise(function(e,t){$.getJSON(r).done(function(n){n&&n.routes&&n.routes[0]&&n.routes[0].geometry&&n.routes[0].geometry.coordinates?e(n.routes[0]):t(new Error("Empty or bad data from openrouteservice"))}).fail(t)})}t.getDirections=function(e,t,n,o){var l=this;void 0===o&&(o=!1);var p=function(e){switch(e){case"Car":return"driving-car";case"Bus":return"driving-hgv";case"Bike":return"cycling-regular";case"Walk":return"foot-walking";default:return}}(n);if(!p)return Promise.reject(new Error("Transportation mean unsupported: "+n));var c=JSON.stringify({from:e,to:t,mean:n});return c in a?a[c]:(a[c]=r(l,void 0,void 0,function(){var n,r,o,a,l,c,d,f,h;return i(this,function(i){switch(i.label){case 0:n=!1,r=!1,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,u(e,t,p)];case 2:return[2,i.sent()];case 3:if("object"!=typeof(o=i.sent())||!o.responseJSON||2010!=o.responseJSON.error.code)throw o;for(a=/not find point ([0-9]+)/g,l=void 0;l=a.exec(o.responseJSON.error.message);)switch(l[1]){case"0":n=!0;break;case"1":r=!0}if(!n&&!r)throw o;return[3,4];case 4:return n?[4,s(e)]:[3,6];case 5:return d=i.sent(),[3,7];case 6:d=e,i.label=7;case 7:return c=d,r?[4,s(t)]:[3,9];case 8:return f=i.sent(),[3,10];case 9:f=t,i.label=10;case 10:return[4,u(c,f,p)];case 11:return(h=i.sent()).geometry.coordinates.unshift([e.lon,e.lat]),h.geometry.coordinates.push([t.lon,t.lat]),[2,h]}})}),a[c])},t.midPoint=function(e){for(var t=0,n=[0],r=1;r<e.length;++r)t+=o.Point.dist(e[r],e[r-1]),n.push(t);var i=t/2;for(r=0;r<n.length;++r)if(n[r]>i)return r-1;return 0}},i80t:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.styles=[".bootstrap-alert[_ngcontent-%COMP%]{z-index:2000;position:fixed}.top-left[_ngcontent-%COMP%]{left:1rem;top:1rem}.top-center[_ngcontent-%COMP%]{margin:auto;left:0;right:0;top:1rem}.top-right[_ngcontent-%COMP%]{right:1rem;top:1rem}.bottom-left[_ngcontent-%COMP%]{left:1rem;bottom:1rem}.bottom-center[_ngcontent-%COMP%]{margin:auto;left:0;right:0;bottom:1rem}.bottom-right[_ngcontent-%COMP%]{right:1rem;bottom:1rem}"]},ifMO:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.styles=["div.progview[_ngcontent-%COMP%]{background-color:#eee;overflow:auto;height:100%}.progview[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding:5px}.progview[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style-type:none;position:relative;left:0;background-color:#fff}.dayEntryUl[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:first-child   header[_ngcontent-%COMP%]{border-top:0;padding-top:0}.progview[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .clickable[_ngcontent-%COMP%]:hover{background-color:#72b866}li[_ngcontent-%COMP%]   .clickable[_ngcontent-%COMP%]{color:#fff;padding:6px 12px;font-size:14px;display:inline-block;border-radius:12px;margin:3px 3px 9px;cursor:pointer;font-weight:700}.locations[_ngcontent-%COMP%]{display:inline-block}header[_ngcontent-%COMP%]{position:relative;padding-top:40px}.date[_ngcontent-%COMP%]{float:right;font-size:18px}.day[_ngcontent-%COMP%]{font-size:18px;border-bottom:1px solid}.dayTitle[_ngcontent-%COMP%]{font-size:18px;font-weight:800;margin:10px 0}.daySubTitle[_ngcontent-%COMP%]{font-size:18px;font-weight:300;padding:0 0 10px;color:#949494}.eventDescription[_ngcontent-%COMP%], .eventIndication[_ngcontent-%COMP%], .eventTitle[_ngcontent-%COMP%]{font-size:16px}.eventIndication[_ngcontent-%COMP%], .eventTitle[_ngcontent-%COMP%]{font-weight:600}.eventSubTitle[_ngcontent-%COMP%]{padding-bottom:5px;font-weight:300;color:#949494}.eventDescription[_ngcontent-%COMP%]{margin-top:10px}ul[_ngcontent-%COMP%]   .locations[_ngcontent-%COMP%]{padding:0}.thumbnail-schedule[_ngcontent-%COMP%]{padding:0 10px 10px 0}"]},kEL7:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n("eErF");var r=n("Gvdl"),i=function(){function e(){this._alertMessage=new r.BehaviorSubject(null),this._removeAlertMessage=new r.BehaviorSubject(null)}return e.prototype.alert=function(e){this._alertMessage.next(e)},e.prototype.removeAlert=function(e){this._removeAlertMessage.next(e)},e.ctorParameters=function(){return[]},e}();t.AlertMessageService=i},kYoo:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.styles=[".flex-col[_ngcontent-%COMP%]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.flex-col-or-row[_ngcontent-%COMP%], .flex-row[_ngcontent-%COMP%]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.flex-auto[_ngcontent-%COMP%]{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;overflow:auto}.flex-fixed[_ngcontent-%COMP%]{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;overflow:auto}.schedule-link[_ngcontent-%COMP%]:hover{text-decoration:underline;cursor:pointer}@media (orientation :portrait){.rotate[_ngcontent-%COMP%]{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}}agm-map[_ngcontent-%COMP%], days-view[_ngcontent-%COMP%], mapContainer[_ngcontent-%COMP%]{width:100%;height:100%;display:block}.relative[_ngcontent-%COMP%]{position:relative}.abs-fill[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0}article[_ngcontent-%COMP%]{background:#4b3}.region-header[_ngcontent-%COMP%]{padding-bottom:14px}#initerary[_ngcontent-%COMP%]   .region-header[_ngcontent-%COMP%]{margin-top:0!important}.h100[_ngcontent-%COMP%]{height:100%}.backtohomepage[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-transform:uppercase}.white-shadow[_ngcontent-%COMP%]{position:absolute;top:0;width:100%;height:30px;background:-webkit-gradient(linear,left top,left bottom,from(white),to(rgba(255,255,255,0)));background:linear-gradient(white,rgba(255,255,255,0))}"]},nUeW:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(){}}();t.AppModule=r},nge0:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){if("number"==typeof e&&"number"==typeof t?(this.x=e,this.y=t):Array.isArray(e)?(this.x=e[0],this.y=e[1]):"object"==typeof e&&(this.x=e.x,this.y=e.y),void 0===this.x||void 0===this.y)throw new Error("invalid point")}return e.minus=function(t,n){return new e(t.x-n.x,t.y-n.y)},e.plus=function(t,n){return new e(t.x+n.x,t.y+n.y)},e.times=function(t,n){return new e(t*n.x,t*n.y)},e.min=function(t,n){return new e(Math.min(t.x,n.x),Math.min(t.y,n.y))},e.max=function(t,n){return new e(Math.max(t.x,n.x),Math.max(t.y,n.y))},e.dist=function(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)},e.norm=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},e.nearest=function(t,n){for(var r,i,o=0,a=n;o<a.length;o++){var l=a[o],s=e.dist(l,t);(void 0===r||s<i)&&(i=s,r=l)}return r},e.rotate=function(t,n){var r=Math.cos(n),i=Math.sin(n);return new e(t.x*r-t.y*i,t.x*i+t.y*r)},e.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},e.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},e.prototype.mul=function(e){return this.x*=e,this.y*=e,this},e.prototype.norm=function(){return e.norm(this)},e}();t.Point=r},qJxO:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("3j3K"),i=n("0qPf");function o(e){return r.\u0275vid(0,[r.\u0275qud(402653184,1,{mapDiv:0}),(e()(),r.\u0275eld(0,[[1,0],["mapDiv",1]],null,0,"div",[["style","position: absolute;"]],[[4,"width","px"],[4,"height","px"]],null,null,null,null)),(e()(),r.\u0275ted(null,["\n"]))],null,function(e,t){var n=t.component;e(t,1,0,n.canvasWidth,n.canvasHeight)})}function a(e){return r.\u0275vid(0,[(e()(),r.\u0275eld(0,null,null,1,"mapview2",[],null,null,null,o,t.RenderType_MapView2)),r.\u0275did(49152,null,0,i.MapView2,[],null,null)],null,null)}t.RenderType_MapView2=r.\u0275crt({encapsulation:2,styles:[],data:{}}),t.View_MapView2_0=o,t.View_MapView2_Host_0=a,t.MapView2NgFactory=r.\u0275ccf("mapview2",i.MapView2,a,{canvasWidth:"canvasWidth",canvasHeight:"canvasHeight",compactAttribution:"compactAttribution",lang:"lang"},{},[])},r5kr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("3j3K"),i=n("z+o6"),o=function(){function e(e){this.daysService=e,this.selectLocation=new r.EventEmitter,this.scrollTop=0,this.toUTCDate=function(e){var t;return t=new Date(e),new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds())},this.dateTimeToTime=function(e){return e.getMinutes()>=10?e.getHours()+":"+e.getMinutes():e.getHours()+":0"+e.getMinutes()},this.translations=translations}return e.prototype.ngOnInit=function(){this.fetchDays()},e.prototype.ngOnChanges=function(){this.fetchDays()},e.prototype.fetchDays=function(){var e=this;this.tripId&&this.daysService.getDays(this.tripId).then(function(t){e.setDays(t)}).catch(function(t){e.error="Failed to load trip content"})},e.prototype.setDays=function(e){this.days=e,this.days.days=e.days.filter(function(e){return null!=e.title||null!=e.subtitle||null!=e.description||e.events.length||e.locations.length||e.pictures.length})},e.prototype.fireSelectLocation=function(e){this.selectLocation.next(e)},e.eventBaseLocations=function(e){return e.locations},e.dayLocations=function(t){for(var n=e.eventBaseLocations(t).slice(),r=0,i=t.events;r<i.length;r++){var o=i[r];n=n.concat(e.eventBaseLocations(o))}return n},e.dist=function(e,t){var n=e.latitude-t.latitude,r=e.longitude-t.longitude;return n*n+r*r},e.distanceToDay=function(t,n){var r=e.dayLocations(t).map(function(t){return e.dist(t,n)});if(r.length>0)return Math.min.apply(Math,r)},e.prototype.scrollTo=function(t){if(this.dayEntryUl){for(var n,r,i=0;i<this.days.days.length;++i){var o=this.days.days[i],a=e.distanceToDay(o,t);a&&(!n||a<n)&&(n=a,r=i)}if(void 0!=r){var l=this.dayEntryUl.nativeElement.children[r].offsetTop;this.scrollTop=Math.max(0,l-5)}}},e.prototype.locationsForDay=function(e){for(var t=e.locations.slice(),n=0,r=e.events;n<r.length;n++){var i=r[n];t=t.concat(i.locations)}var o={};return t.filter(function(e){return!(e.name in o)&&(o[e.name]=!0)})},e.prototype.T=function(e){for(var t=e.split("."),n=translations;t.length>0;){var r=t[0];if(!n[r])return console.log("Missing translation: "+e),e;n=n[r],t=t.slice(1)}return"object"==typeof n?(console.log("invalid translation key: "+e),e):n},e.ctorParameters=function(){return[{type:i.DaysService}]},e}();t.DaysView=o},rIWh:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.T={CanvasTilesRenderer:CanvasTilesRenderer,PinchZoom:PinchZoom,Utils:Utils}},wNJ6:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("i80t"),i=n("3j3K"),o=n("2Je8"),a=n("Q+ap"),l=n("kEL7"),s=[r.styles];function u(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,6,"div",[["class","alert alert-dismissible"]],[[8,"id",0],[24,"@alertVisible",0]],null,null,null,null)),i.\u0275did(278528,null,0,o.NgClass,[i.IterableDiffers,i.KeyValueDiffers,i.ElementRef,i.Renderer],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(e()(),i.\u0275ted(null,["\n    "])),(e()(),i.\u0275eld(0,null,null,2,"button",[["aria-label","Close"],["class","close"],["data-dismiss","alert"],["type","button"]],null,null,null,null,null)),(e()(),i.\u0275eld(0,null,null,1,"span",[["aria-hidden","true"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\xd7"])),(e()(),i.\u0275ted(null,["\n    ","\n  "]))],function(e,t){e(t,1,0,"alert alert-dismissible",t.context.$implicit.type)},function(e,t){e(t,0,0,i.\u0275inlineInterpolate(1,"",t.context.$implicit.uuid,""),t.context.$implicit.state),e(t,6,0,t.context.$implicit.message)})}function p(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,4,"div",[["class","alert-message-container"]],null,null,null,null,null)),(e()(),i.\u0275ted(null,["\n  "])),(e()(),i.\u0275and(16777216,null,null,1,null,u)),i.\u0275did(802816,null,0,o.NgForOf,[i.ViewContainerRef,i.TemplateRef,i.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),i.\u0275ted(null,["\n"])),(e()(),i.\u0275ted(null,["\n\n"]))],function(e,t){e(t,3,0,t.component.alertMessages)},null)}function c(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,1,"alert-message",[],null,null,null,p,t.RenderType_AlertMessageComponent)),i.\u0275did(49152,null,0,a.AlertMessageComponent,[l.AlertMessageService],null,null)],null,null)}t.RenderType_AlertMessageComponent=i.\u0275crt({encapsulation:0,styles:s,data:{animation:[{type:7,name:"alertVisible",definitions:[{type:0,name:"visible",styles:{type:6,styles:{opacity:1},offset:null},options:void 0},{type:0,name:"destroyed",styles:{type:6,styles:{opacity:0},offset:null},options:void 0},{type:1,expr:"visible => destroyed",animation:{type:4,styles:null,timings:"600ms"},options:null},{type:1,expr:"destroyed => visible",animation:{type:4,styles:null,timings:"600ms"},options:null}],options:{}}]}}),t.View_AlertMessageComponent_0=p,t.View_AlertMessageComponent_Host_0=c,t.AlertMessageComponentNgFactory=i.\u0275ccf("alert-message",a.AlertMessageComponent,c,{},{},[])},"x/Ch":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("nge0"),i=n("aQzM"),o=function(){function e(){this.allPlaces=[]}return e.parse=function(t){var n=new e;n.coord=new r.Point(t.coord),t.place&&(t.place=e.parse(t.place)),t.viewerPos&&(n.viewerPos=new r.Point(t.viewerPos));for(var o=0,a=["dbid","name","label","indication","labelIcon","properties"];o<a.length;o++){var l=a[o];t[l]&&(n[l]=t[l])}return n.name||(void 0!==n.dbid?n.name=""+n.dbid:n.label&&(n.name=n.label)),n.properties=t.properties||{},n.properties.labelBbox&&(n.properties.labelBbox=new i.BoundingBox(n.properties.labelBbox)),n.properties.leaderLineAnchor&&(n.properties.leaderLineAnchor=new r.Point(n.properties.leaderLineAnchor)),n.properties.labelCoord&&(n.properties.labelCoord=new r.Point(n.properties.labelCoord)),n.properties.labelPixelOffset&&(n.properties.labelPixelOffset=new r.Point(n.properties.labelPixelOffset)),n},e.prototype.isSkipped=function(){return!(this.label&&(!this.properties||void 0===this.properties.skip))&&this.properties.skip},e.prototype.labelPixelPos=function(e,t){return this.properties&&this.properties.labelPixelOffset?r.Point.plus(e.viewerPosFromWorldPos(this.coord),r.Point.times(t,this.properties.labelPixelOffset)):e.viewerPosFromWorldPos(this.properties&&this.properties.labelCoord?this.properties.labelCoord:this.coord)},e.prototype.leaderLineAnchorPos=function(e,t){if(this.properties&&(this.properties.leaderLineAnchor||this.properties.leaderLineAnchorPixelOffset))return this.properties.leaderLineAnchorPixelOffset?r.Point.plus(e.viewerPosFromWorldPos(this.coord),r.Point.times(t,this.properties.leaderLineAnchorPixelOffset)):e.viewerPosFromWorldPos(this.properties.leaderLineAnchor)},e.prototype.convertToPixelOffset=function(e,t){this.properties.labelCoord&&(this.properties.labelPixelOffset||(this.properties.labelPixelOffset=r.Point.minus(e.viewerPosFromWorldPos(this.properties.labelCoord),e.viewerPosFromWorldPos(this.coord)).mul(1/t)),delete this.properties.labelCoord),this.properties.leaderLineAnchor&&(this.properties.leaderLineAnchorPixelOffset||(this.properties.leaderLineAnchorPixelOffset=r.Point.minus(e.viewerPosFromWorldPos(this.properties.leaderLineAnchor),e.viewerPosFromWorldPos(this.coord)).mul(1/t)),delete this.properties.leaderLineAnchor)},e}();t.TripNode=o},xkj0:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("3j3K"),i=(n("XJCn"),n("YfwQ")),o=n("Qbdm");r.enableProdMode(),o.platformBrowser().bootstrapModuleFactory(i.AppModuleNgFactory)},"z+o6":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("KdFd");n("eErF"),n("+pb+");var i=function(){function e(e){this.http=e}return e.prototype.getDays=function(e){return this.http.get("/api/trips/"+e+"/days.json").toPromise()},e.ctorParameters=function(){return[{type:r.HttpClient}]},e}();t.DaysService=i}},[0]);