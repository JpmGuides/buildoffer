webpackJsonp([1],{0:function(e,t,n){e.exports=n("DXDq")},"0j86":function(e,t,n){"use strict";function i(e){return l.\u0275vid(0,[l.\u0275qud(402653184,1,{days:0}),l.\u0275qud(402653184,2,{mapview:0}),l.\u0275qud(402653184,3,{mapview_parent:0}),(e()(),l.\u0275ted(null,["\n\n"])),(e()(),l.\u0275eld(0,null,null,38,"div",[["class","h100 flex-col"],["id","initerary"]],null,null,null,null,null)),(e()(),l.\u0275ted(null,["\n  "])),(e()(),l.\u0275eld(0,null,null,13,"header",[["class","flex-row region region-header schedule_menu_color schedule_menu_text_color"]],null,null,null,null,null)),(e()(),l.\u0275ted(null,["\n\n    "])),(e()(),l.\u0275eld(0,null,null,10,"span",[["class","title flex-auto"]],null,null,null,null,null)),(e()(),l.\u0275ted(null,["\n      "])),(e()(),l.\u0275eld(0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-map"]],null,null,null,null,null)),(e()(),l.\u0275ted(null,["\n       | "])),(e()(),l.\u0275eld(0,null,null,2,"span",[["class","backtohomepage"]],null,null,null,null,null)),(e()(),l.\u0275eld(0,null,null,1,"a",[["href","."]],null,null,null,null,null)),(e()(),l.\u0275ted(null,["",""])),(e()(),l.\u0275ted(null,[" |\n      "])),(e()(),l.\u0275eld(0,null,null,1,"span",[["class","schedule-link"]],null,[[null,"click"]],function(e,t,n){var i=!0,r=e.component;if("click"===t){i=!1!==r.fullMap()&&i}return i},null,null)),(e()(),l.\u0275ted(null,["",""])),(e()(),l.\u0275ted(null,["\n    "])),(e()(),l.\u0275ted(null,["\n  "])),(e()(),l.\u0275ted(null,["\n\n  "])),(e()(),l.\u0275eld(0,null,null,20,"div",[["class","flex-auto flex-row rotate"]],null,null,null,null,null)),(e()(),l.\u0275ted(null,["\n    "])),(e()(),l.\u0275ted(null,["\n    "])),(e()(),l.\u0275eld(0,null,null,7,"div",[["class","flex-auto relative"]],null,null,null,null,null)),(e()(),l.\u0275ted(null,["\n      "])),(e()(),l.\u0275eld(0,[[3,0],["mapviewparent",1]],null,4,"div",[["class","abs-fill"]],null,null,null,null,null)),(e()(),l.\u0275ted(null,["\n  "])),(e()(),l.\u0275eld(0,null,null,1,"mapview",[["style","display:block;width:100%;height:100%;"]],null,null,null,s.View_MapView_0,s.RenderType_MapView)),l.\u0275did(49152,[[2,4],["mapview",4]],0,p.MapView,[l.ElementRef],{compactAttribution:[0,"compactAttribution"],lang:[1,"lang"]},null),(e()(),l.\u0275ted(null,["\n      "])),(e()(),l.\u0275ted(null,["\n    "])),(e()(),l.\u0275ted(null,["\n    "])),(e()(),l.\u0275eld(0,null,null,7,"div",[["class","flex-auto relative"]],null,null,null,null,null)),(e()(),l.\u0275ted(null,["\n      "])),(e()(),l.\u0275eld(0,null,null,2,"days-view",[["class","abs-fill"]],null,[[null,"selectLocation"]],function(e,t,n){var i=!0,r=e.component;if("selectLocation"===t){i=!1!==r.selectLocation(n)&&i}return i},u.View_DaysView_0,u.RenderType_DaysView)),l.\u0275prd(512,null,d.DaysService,d.DaysService,[c.HttpClient]),l.\u0275did(638976,[[1,4],["days",4]],0,h.DaysView,[d.DaysService],{tripId:[0,"tripId"]},{selectLocation:"selectLocation"}),(e()(),l.\u0275ted(null,["\n      "])),(e()(),l.\u0275eld(0,null,null,0,"div",[["class","white-shadow"]],null,null,null,null,null)),(e()(),l.\u0275ted(null,["\n    "])),(e()(),l.\u0275ted(null,["\n  "])),(e()(),l.\u0275ted(null,["\n"])),(e()(),l.\u0275ted(null,["\n"]))],function(e,t){var n=t.component;e(t,29,0,!0,n.language),e(t,37,0,n.tripId)},function(e,t){var n=t.component;e(t,14,0,n.T("back")),e(t,17,0,n.T("schedule"))})}function r(e){return l.\u0275vid(0,[(e()(),l.\u0275eld(0,null,null,1,"test-app",[],null,[["window","resize"]],function(e,t,n){var i=!0;if("window:resize"===t){i=!1!==l.\u0275nov(e,1).onResize()&&i}return i},i,t.RenderType_TestApp)),l.\u0275did(4243456,null,0,a.TestApp,[l.ChangeDetectorRef],null,null)],null,null)}Object.defineProperty(t,"__esModule",{value:!0});var o=n("uTZG"),l=n("/oeL"),a=n("i+6n"),s=n("eewr"),p=n("MksE"),u=n("rDkg"),d=n("yJCl"),c=n("XKz0"),h=n("xHFf"),f=[o.styles];t.RenderType_TestApp=l.\u0275crt({encapsulation:0,styles:f,data:{}}),t.View_TestApp_0=i,t.View_TestApp_Host_0=r,t.TestAppNgFactory=l.\u0275ccf("test-app",a.TestApp,r,{tripId:"tripId"},{},[])},"8wyk":function(e,t,n){"use strict";function i(e){return o.\u0275vid(0,[o.\u0275qud(402653184,1,{mapDiv:0}),(e()(),o.\u0275eld(0,[[1,0],["mapDiv",1]],null,0,"div",[["style","position: absolute;"]],[[4,"width","px"],[4,"height","px"]],null,null,null,null)),(e()(),o.\u0275ted(null,["\n"]))],null,function(e,t){var n=t.component;e(t,1,0,n.canvasWidth,n.canvasHeight)})}function r(e){return o.\u0275vid(0,[(e()(),o.\u0275eld(0,null,null,1,"mapview2",[],null,null,null,i,t.RenderType_MapView2)),o.\u0275did(49152,null,0,l.MapView2,[],null,null)],null,null)}Object.defineProperty(t,"__esModule",{value:!0});var o=n("/oeL"),l=n("iRJu"),a=[];t.RenderType_MapView2=o.\u0275crt({encapsulation:2,styles:a,data:{}}),t.View_MapView2_0=i,t.View_MapView2_Host_0=r,t.MapView2NgFactory=o.\u0275ccf("mapview2",l.MapView2,r,{canvasWidth:"canvasWidth",canvasHeight:"canvasHeight",compactAttribution:"compactAttribution",lang:"lang"},{},[])},DXDq:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("/oeL"),r=(n("OKwi"),n("hCN4")),o=n("fc+i");i.enableProdMode(),o.platformBrowser().bootstrapModuleFactory(r.AppModuleNgFactory)},"LYv+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,n){this.name=e,this.width_mm=t,this.height_mm=n}return e.fromPt=function(t,n,i){return new e(t,n/e.mmToPoint,i/e.mmToPoint)},e.fromIPageSize=function(t){return new e(t.name,t.width_mm,t.height_mm)},e.prototype.widthPt=function(){return Math.round(this.width_mm*e.mmToPoint)},e.prototype.heightPt=function(){return Math.round(this.height_mm*e.mmToPoint)},e.prototype.key=function(){return Math.round(this.width_mm)+"x"+Math.round(this.height_mm)},e}();i.mmToPoint=2.83465,t.PageSize=i},MksE:function(e,t,n){"use strict";function i(e,t){var n=e.x-t.x,i=e.y-t.y,r=e.scale-t.scale;return Math.abs(n)<1e-7&&Math.abs(i)<1e-7&&Math.abs(r)<1e-7}Object.defineProperty(t,"__esModule",{value:!0});var r=n("y+vL"),o=n("/oeL"),l=n("ibj/"),a=mapboxgl.AttributionControl,s=(mapboxgl.Map,function(){function e(e){this.el=e,this.waitingList=[],this._showOld=!0,this._removeMapLabels=!1}return e.prototype.pixelRatio=function(){return this._renderer&&this._renderer.pixelRatio?this._renderer.pixelRatio:1},e.prototype.getCanvasWidth=function(){return this.canvasWidth?this.canvasWidth:this.el&&this.el.nativeElement?this.el.nativeElement.offsetWidth:0},e.prototype.getCanvasHeight=function(){return this.canvasHeight?this.canvasHeight:this.el&&this.el.nativeElement?this.el.nativeElement.offsetHeight:0},e.prototype.prepareCanvas=function(e){var t=this;if(this._options=e,!this.canvas||!this.canvas.nativeElement||this._renderer||this._map)return void(e.alreadyCreated&&(this._map.loaded()?e.alreadyCreated(this._renderer,this._tripLayer):this.waitingList.push(e)));this._map=this.mapview.createMap(e.trip),this._map.on("load",function(){var n=t.canvas.nativeElement,i=e.trip.location();t._renderer=new r.T.CanvasTilesRenderer({canvas:n,width:1,clearBorder:!1,downsampleDuringMotion:!1,fillScreen:!1,downgradeIfSlowerFPS:1e-8,url:"https://tiles.wmflabs.org/bw-mapnik/$scale/$x/$y.png",initialLocation:i,onLocationChange:function(n){var i=n.getLocation();t.setMapboxLocation(i),e.onLocationChange&&e.onLocationChange(n)}}),t._renderer.pinchZoom.maxScale=t.getScaleFromZoom(0),e.disableMouseWheel&&(t._renderer.pinchZoom.handleMouseWheel=function(e){}),t._renderer.layers=[{draw:function(){var e=t.renderCanvas.nativeElement,n=t.canvas.nativeElement;e.width=n.width,e.height=n.height,e.getContext("2d").clearRect(0,0,e.width,e.height)}}],t._tripLayer=new l.TripGraphLayer({renderer:t._renderer,graph:e.graph}),t._renderer.addLayer(t._tripLayer);var o=t._tripLayer.draw,a=t;t._tripLayer.draw=function(){if(this.hideLabels=!a._removeMapLabels,this.forceLeaderLines=!0,a._showOld){var e=a.renderCanvas.nativeElement;arguments[0]=e,o.apply(this,arguments);var t=e.width,n=e.height;a._canvasWorldCoord=[[0,0],[t,0],[t,n],[0,n]].map(function(e){return a._renderer.pinchZoom.worldPosFromViewerPos({x:e[0],y:e[1]})}),a.updateCanvas()}},e.created&&e.created(t._renderer,t._tripLayer);for(var s=0,p=t.waitingList;s<p.length;s++){var u=p[s];u.alreadyCreated&&u.alreadyCreated(t._renderer,t._tripLayer)}setTimeout(function(){t.setSeqTrip(e.trip),i&&(t._removeMapLabels=i.scale>1,t.switchCanvasVisibility(t._removeMapLabels),t.mapview.switchCustomLayers(!t._removeMapLabels))},10)})},e.prototype.getLayer=function(e){},e.prototype.setLayerColors=function(e){},e.prototype.resize=function(){this.mapview.resize(),this._renderer&&(this._renderer.pinchZoom.maxScale=this.getScaleFromZoom(0),this.setMapboxLocation(this._renderer.getLocation()))},e.prototype.setMapboxLocation=function(e){this.mapview.setMapboxLocation(e),this._removeMapLabels=e.scale>1,this.switchCanvasVisibility(this._removeMapLabels),this.mapview.switchCustomLayers(!this._removeMapLabels)},e.prototype.getZoomFromLocation=function(e){if(e){var t=this.getCanvasWidth();return Math.log2(1/(e.scale*(512/t)))}return 8},e.prototype.getScaleFromZoom=function(e){return this.getCanvasWidth()/512*1/Math.pow(2,e)},e.prototype.setSeqTrip=function(e){var t=this;this._seqTrip=e;var n;this._tripLayer.graph&&Object.keys(this._tripLayer.graph.nodes).length>0?n=this._tripLayer.graph:(n=e.makeGraph(this._tripLayer),this._tripLayer.graph=n),this._tripLayer.defaultRadius=e.defaultRadius(),this._tripLayer.defaultTextProp=e.defaultTextProp(),this._tripLayer.defaultEdgeProp=e.defaultEdgeProp();var r=e.location();i(r,this._renderer.location)||this._renderer.setLocation(r),this.setMapboxLocation(r),this.setLayerColors(e),this._renderer.refresh(),this.resize(),this._tripLayer.loadIcons(function(e){e&&console.log(e),t._renderer.refresh()});var o=this.renderCanvas.nativeElement,l=o.width,a=o.height;return this.mapview.addTripLayers(e,n,o,[[0,0],[l,0],[l,a],[0,a]].map(function(e){return t._renderer.pinchZoom.worldPosFromViewerPos({x:e[0],y:e[1]})}),this._tripLayer.markedPlaces),n},e.prototype.updateCanvas=function(){if(this._canvasWorldCoord){var e=this.renderCanvas.nativeElement;e.width,e.height;this.mapview.updateCanvasLayer(e,this._canvasWorldCoord,this._tripLayer.markedPlaces)}},e.prototype.refresh=function(){this._renderer&&this._renderer.refresh(),this._seqTrip&&this.setSeqTrip(this._seqTrip)},e.prototype.attribution=function(){var e=this._map;if(e.style){var t=[],n=e.style.sourceCaches;for(var i in n){var r=n[i];if(r.used){var o=r.getSource();o.attribution&&t.indexOf(o.attribution)<0&&t.push(o.attribution)}}return t.sort(function(e,t){return e.length-t.length}),t=t.filter(function(e,n){for(var i=n+1;i<t.length;i++)if(t[i].indexOf(e)>=0)return!1;return!0})}},e.prototype.switchCanvasVisibility=function(e){var t=this.renderCanvas.nativeElement,n=t.parentElement;e?n.insertBefore(t,this.canvas.nativeElement):n.insertBefore(t,n.firstChild)},e.prototype.addMarker=function(e,t){if(this._map){return new mapboxgl.Marker(t).setLngLat([e.longitude,e.latitude]).addTo(this._map)}},e.prototype.addAttributionControl=function(e){this._map&&this._map.addControl(new a({compact:e}))},e.ctorParameters=function(){return[{type:o.ElementRef}]},e}());t.MapView=s},MqDx:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("zb0d"),r=n("e3kh"),o=function(){function e(){this.allPlaces=[]}return e.parse=function(t){var n=new e;n.coord=new i.Point(t.coord),t.place&&(t.place=e.parse(t.place)),t.viewerPos&&(n.viewerPos=new i.Point(t.viewerPos));for(var o=0,l=["dbid","name","label","labelIcon","properties"];o<l.length;o++){var a=l[o];t[a]&&(n[a]=t[a])}return n.name||(void 0!==n.dbid?n.name=""+n.dbid:n.label&&(n.name=n.label)),n.properties=t.properties||{},n.properties.labelBbox&&(n.properties.labelBbox=new r.BoundingBox(n.properties.labelBbox)),n.properties.leaderLineAnchor&&(n.properties.leaderLineAnchor=new i.Point(n.properties.leaderLineAnchor)),n.properties.labelCoord&&(n.properties.labelCoord=new i.Point(n.properties.labelCoord)),n.properties.labelPixelOffset&&(n.properties.labelPixelOffset=new i.Point(n.properties.labelPixelOffset)),n},e.prototype.isSkipped=function(){return!(this.label&&(!this.properties||void 0===this.properties.skip))&&this.properties.skip},e.prototype.labelPixelPos=function(e,t){return this.properties&&this.properties.labelPixelOffset?i.Point.plus(e.viewerPosFromWorldPos(this.coord),i.Point.times(t,this.properties.labelPixelOffset)):e.viewerPosFromWorldPos(this.properties&&this.properties.labelCoord?this.properties.labelCoord:this.coord)},e.prototype.leaderLineAnchorPos=function(e,t){if(this.properties&&(this.properties.leaderLineAnchor||this.properties.leaderLineAnchorPixelOffset))return this.properties.leaderLineAnchorPixelOffset?i.Point.plus(e.viewerPosFromWorldPos(this.coord),i.Point.times(t,this.properties.leaderLineAnchorPixelOffset)):e.viewerPosFromWorldPos(this.properties.leaderLineAnchor)},e.prototype.convertToPixelOffset=function(e,t){this.properties.labelCoord&&(this.properties.labelPixelOffset||(this.properties.labelPixelOffset=i.Point.minus(e.viewerPosFromWorldPos(this.properties.labelCoord),e.viewerPosFromWorldPos(this.coord)).mul(1/t)),delete this.properties.labelCoord),this.properties.leaderLineAnchor&&(this.properties.leaderLineAnchorPixelOffset||(this.properties.leaderLineAnchorPixelOffset=i.Point.minus(e.viewerPosFromWorldPos(this.properties.leaderLineAnchor),e.viewerPosFromWorldPos(this.coord)).mul(1/t)),delete this.properties.leaderLineAnchor)},e}();t.TripNode=o},Nf9t:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e}();t.AppModule=i},OKwi:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.environment={production:!1}},PWOr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("zb0d"),r=n("ddSW"),o=n("tnZY"),l=n("gsQE"),a=n("MqDx"),s=n("ibj/"),p=n("LYv+"),u=function(){function e(){this.reset()}return e.makePlaneIcon=function(e,t){var n=new a.TripNode;return n.name=t.dbid+"-"+e,n.labelIcon={url:"/ng-map/assets/plane.png",width:20,autorotate:Math.PI/2*("landing"===e?1:-1),ratioX:.5,ratioY:"landing"===e?0:1},n.coord=t.coord,n.properties={point:!1,leaderLine:"center",dashed:[5,3],leaderLineWidth:2,maxLeaderLineLength:2},n},e.prototype.places=function(){return this._tripData.places},e.prototype.stages=function(){return this._tripData.stages},e.prototype.setLocation=function(e){this._tripData.location=e},e.prototype.location=function(){return this._tripData.location},e.prototype.width_mm=function(){return this._tripData.width},e.prototype.height_mm=function(){return this._tripData.height},e.prototype.pageSizeName=function(){return this._tripData.pageSizeName},e.prototype.world=function(){return this._tripData.world||(this._tripData.world={}),this._tripData.world},e.prototype.setSize=function(e,t,n){this._tripData.width=t,this._tripData.height=n,this._tripData.pageSizeName=e},e.prototype.defaultRadius=function(){return this._tripData.defaultRadius},e.prototype.defaultTextProp=function(){return this._tripData.defaultTextProp||(this._tripData.defaultTextProp={}),this._tripData.defaultTextProp},e.prototype.defaultEdgeProp=function(){return this._tripData.defaultEdgeProp||(this._tripData.defaultEdgeProp=e.defaultTrip().defaultEdgeProp),this._tripData.defaultEdgeProp},e.prototype.edgeProperty=function(e,t){return e.properties[t]||this._tripData.defaultEdgeProp[t]},e.prototype.nodeProperty=function(e,t){return e.properties[t]||this._tripData.defaultTextProp[t]},e.prototype.reset=function(){this._tripData=e.defaultTrip()},e.defaultTrip=function(){var e=(window,r.globalMapParams().preferences||{}),t=new p.PageSize("Full page",128,190);if(e.default_page_size&&e.page_sizes)for(var n=0,i=e.page_sizes;n<i.length;n++){var o=i[n];if(o.name==e.default_page_size){t=o;break}}return{places:[],stages:[],additionalPlaces:[],location:{x:.5,y:.5,scale:1/8},defaultRadius:8,width:t.width_mm,height:t.height_mm,pageSizeName:t.name,borderColor:"#fefefe",landColor:"#cecece",seaColor:"#c4e3ff",showRivers:!1,world:{},defaultTextProp:Object.assign({fontSize:12,font:"'PT Sans', sans-serif",stroke:"rgba(255,255,255,.8)",fill:"#000000"},e.default_node_prop),defaultEdgeProp:Object.assign({lineWidth:2,lineColor:"#000000",geom:e.line_shape||"straight"},e.default_edge_prop)}},e.prototype.setPlaces=function(e){this._tripData.places.splice.apply(this._tripData.places,[0,this._tripData.places.length].concat(e)),this.updateStages(),this.updateLandingsAndTakeoff()},e.prototype.stagesAsDict=function(){for(var e={},t=0,n=this._tripData.stages;t<n.length;t++){var i=n[t];i.from in e||(e[i.from]={}),e[i.from][i.to]=i}return e},e.prototype.updateStages=function(){for(var e=this._tripData.places,t=e.length-1,n=(this._tripData.stages,[]),i=this.stagesAsDict(),r=1;r<=t;++r){var a=e[r-1].dbid,s=e[r].dbid;if(i[a]&&i[a][s]){var p=i[a][s];p.to=e[r].name,n.push(p)}else n.push(new o.TripEdge({from:e[r-1].name,to:e[r].name,fromDbId:a,controlPoints:l.TripGraph.generateControlPoints(r>=2?e[r-2].coord:void 0,e[r-1].coord,e[r].coord,r+1<e.length?e[r+1].coord:void 0),properties:e[r-1].followingEdgeProp}))}this._tripData.stages.splice.apply(this._tripData.stages,[0,this._tripData.stages.length].concat(n))},e.prototype.updateLandingsAndTakeoff=function(){for(var t={},n=this._tripData.additionalPlaces,i=0;i<n.length;++i)t[n[i].name]=i;for(var r=[],o={},l={},a=["landing","takeoff"],s=0,p=this._tripData.places;s<p.length;s++)for(var u=p[s],d=0,c=a;d<c.length;d++){var h=c[d],f=u.dbid+"-"+h;l[f]=!0,u.properties[h]?f in t||r.push(e.makePlaneIcon(h,u)):f in t&&(o[f]=!0)}var m=/-(landing|takeoff)$/,g=n.filter(function(e){return!(e.name in o)&&(e.name in l||null==e.name.match(m))}).concat(r);this._tripData.additionalPlaces.splice.apply(this._tripData.additionalPlaces,[0,this._tripData.additionalPlaces.length].concat(g))},e.prototype.nodeRadius=function(e,t){var n=this._tripData.defaultRadius;return e.properties&&e.properties.radius&&(n=e.properties.radius),n*t},e.prototype.makeGraph=function(e){for(var t={},n=(function(e){for(var n=e;n in t;)n=t[n];return n}),r=0,o=this._tripData.places;r<o.length;r++){var p=o[r];if(!p.name)throw new Error("nodes should have names and labels")}var u=[];if(e){for(var d=e.renderer.pinchZoom,c=e.renderer.pixelRatio,h=0,f=this._tripData.places;h<f.length;h++){var m=f[h];m.viewerPos=d.viewerPosFromWorldPos(m.coord)}for(var g=0,v=this._tripData.places;g<v.length;g++){var m=v[g];if(!(!m.label||m.properties&&m.properties.skip)){for(var y=this.nodeRadius(m,c),P=!0,x=0;x<u.length;++x){var p=u[x];if(i.Point.dist(p.viewerPos,m.viewerPos)<this.nodeRadius(p,c)+y){u[x]=function(e,n){var i=a.TripNode.parse(e);i.name=e.name+","+n.name,i.allPlaces=e.allPlaces.concat([n]);var r=e.label.split("\n");return r.indexOf(n.label)<0&&r.push(n.label),i.label=r.join("\n"),t[e.name]=t[n.name]=i.name,i}(p,m),P=!1;break}}if(P){m.properties||(m.properties={});var w=a.TripNode.parse(m);w.place=m,w.allPlaces=[m],u.push(w)}}}}else for(var b=0,_=this._tripData.places;b<_.length;b++){var m=_[b],w=a.TripNode.parse(m);w.place=m,w.allPlaces=[m],u.push(w)}for(var C=this._tripData.places,M={},x=0;x<C.length;++x){var p=C[x];M[p.name]=x}for(var L=new l.TripGraph(void 0,this._tripData.defaultEdgeProp),T=0,O=u;T<O.length;T++){var p=O[T];L.nodes[p.name]=p}this.updateLandingsAndTakeoff();for(var D=0,k=this._tripData.additionalPlaces;D<k.length;D++){var p=k[D];L.nodes[p.name]=p}for(var S=0,E=this._tripData.stages;S<E.length;S++){var R=E[S];if(!R.properties.hidden&&!C[M[R.from]].isSkipped()){for(var I=n(R.from),F=M[R.to];F<C.length&&C[F].isSkipped();)++F;if(!(F>=C.length||C[F].isSkipped())){var A=n(C[F].name);if(I!==A){var N=s.TripGraphLayer.shallowCopy(R);N.from=I,N.to=A,N.originalEdge=R,L.edges.push(N)}}}}return L},e.prototype.save=function(){return this._tripData},e.prototype.load=function(e){if("string"==typeof e&&(e=JSON.parse(e)),!e||!e.places||!e.stages)throw new Error("no data");var t=e,n=function(e){for(var t=0;t<e.length;++t)e[t]=a.TripNode.parse(e[t])};n(t.places);for(var i=t.stages,r=0;r<i.length;++r)i[r]=new o.TripEdge(i[r]);n(t.additionalPlaces),this._tripData=t,this.defaultEdgeProp(),this.setSize(e.pageSizeName,e.width,e.height)},e.prototype.seaColor=function(){return this._tripData.seaColor},e.prototype.setSeaColor=function(e){this._tripData.seaColor=e},e.prototype.landColor=function(){return this._tripData.landColor},e.prototype.setLandColor=function(e){this._tripData.landColor=e},e.prototype.borderColor=function(){return this._tripData.borderColor},e.prototype.setBorderColor=function(e){this._tripData.borderColor=e},e.prototype.showRivers=function(){return this._tripData.showRivers},e.prototype.toggleShowRiver=function(){this._tripData.showRivers=!this._tripData.showRivers},e.prototype.language=function(){return this._tripData.language||"en"},e.prototype.setLanguage=function(e){this._tripData.language=e},e.prototype.placeByName=function(e){for(var t=0,n=this._tripData.places;t<n.length;t++){var i=n[t];if(e===i.name)return i}},e.prototype.markFirstLocation=function(){for(var e=!0,t=0,n=this._tripData.places;t<n.length;t++){var i=n[t];!i.label||i.properties&&i.properties.skip||(e?i.properties.firstVisited=!0:"firstVisited"in i.properties&&delete i.properties.firstVisited,e=!1)}},e.prototype.clearUserPlacements=function(){for(var e=0,t=this._tripData.additionalPlaces.concat(this._tripData.places);e<t.length;e++){var n=t[e];n.properties&&(n.properties.userPlacement&&delete n.properties.userPlacement,n.properties.userPlacementPixelOffset&&delete n.properties.userPlacementPixelOffset)}},e.prototype.saveUserPlacements=function(){for(var e=0,t=this._tripData.additionalPlaces.concat(this._tripData.places);e<t.length;e++){var n=t[e];n.properties||(n.properties={}),n.properties.labelCoord&&(n.properties.userPlacement=n.properties.labelCoord),n.properties.labelPixelOffset&&(n.properties.userPlacementPixelOffset=n.properties.labelPixelOffset)}},e.prototype.getMapStyle=function(){return r.globalMapParams().preferences.map_style||"streets"},e}();t.SeqTrip=u},UY1U:function(e,t,n){"use strict";function i(e){switch(e){case"Car":return"driving-car";case"Bus":return"driving-hgv";case"Bike":return"cycling-regular";case"Walk":return"foot-walking";default:return}}function r(e,t,n){var r=i(n);if(!r)return Promise.reject("Transportation mean unsupported: "+n);var o=["https://api.openrouteservice.org/directions?api_key=5b3ce3597851110001cf6248e0fee72951d5494c8b4cf5d8b4ff2b76","coordinates="+e.lon+"%2C"+e.lat+"|"+t.lon+"%2C"+t.lat,"profile="+r,"geometry_format=geojson","geometry_simplify=true"].join("&");return o in a?a[o]:(a[o]=new Promise(function(e,t){$.getJSON(o).done(function(n){n&&n.routes&&n.routes[0]&&n.routes[0].geometry&&n.routes[0].geometry.coordinates?e(n.routes[0].geometry.coordinates):t(new Error("Empty or bad data from openrouteservice"))}).fail(function(e){"object"==typeof e&&"number"==typeof e.status&&e.status>=400&&e.status<500&&t(e),t(e)})}),a[o])}function o(e){for(var t=0,n=[0],i=1;i<e.length;++i){t+=l.Point.dist(e[i],e[i-1]),n.push(t)}for(var r=t/2,i=0;i<n.length;++i)if(n[i]>r)return i-1;return 0}Object.defineProperty(t,"__esModule",{value:!0});var l=n("zb0d"),a={};t.getDirections=r,t.midPoint=o},agHN:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.styles=["div.progview[_ngcontent-%COMP%]{background-color:#eee;overflow:auto;height:100%}.progview[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding:5px}.progview[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style-type:none;position:relative;left:0;background-color:#fff}.dayEntryUl[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:first-child   header[_ngcontent-%COMP%]{border-top:0;padding-top:0}.progview[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .clickable[_ngcontent-%COMP%]:hover{background-color:#72b866}li[_ngcontent-%COMP%]   .clickable[_ngcontent-%COMP%]{color:#fff;padding:6px 12px;font-size:14px;border-radius:12px;margin:3px 3px 9px;cursor:pointer;font-weight:700}.locations[_ngcontent-%COMP%], li[_ngcontent-%COMP%]   .clickable[_ngcontent-%COMP%]{display:inline-block}header[_ngcontent-%COMP%]{position:relative;padding-top:40px}.date[_ngcontent-%COMP%]{float:right}.date[_ngcontent-%COMP%], .day[_ngcontent-%COMP%]{font-size:18px}.day[_ngcontent-%COMP%]{border-bottom:1px solid}.dayTitle[_ngcontent-%COMP%]{font-size:18px;font-weight:800;margin:10px 0 10px 0}.daySubTitle[_ngcontent-%COMP%]{font-size:18px;font-weight:300;padding:0 0 10px;color:#949494}.eventDescription[_ngcontent-%COMP%], .eventIndication[_ngcontent-%COMP%], .eventTitle[_ngcontent-%COMP%]{font-size:16px}.eventIndication[_ngcontent-%COMP%], .eventTitle[_ngcontent-%COMP%]{font-weight:600}.eventSubTitle[_ngcontent-%COMP%]{padding-bottom:5px;font-weight:300;color:#949494}.eventDescription[_ngcontent-%COMP%]{margin-top:10px}ul[_ngcontent-%COMP%]   .locations[_ngcontent-%COMP%]{padding:0}.thumbnail-schedule[_ngcontent-%COMP%]{padding:0 10px 10px 0}"]},cHmR:function(e,t){function n(e){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+e+"'.")})}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="cHmR"},ddSW:function(e,t,n){"use strict";function i(){var e=window,t=e.global_map_params;if(!t&&thisTripApi){var n=window.cssserviceUrl||"https://destinationbook-cssservice.herokuapp.com/";e.global_map_params={locations_url:thisTripApi.locationsUrl,map_settings_url:thisTripApi.mapUrl,preferences:{line_shape:thisTripApi.lineShape},language:thisTripApi.tripLanguage,geoname_service_url:n,map_print_service_url:n},t=e.global_map_params}if(t||"undefined"==typeof mapJson||("object"==typeof mapJson&&mapJson.global_map_params?e.global_map_params=mapJson.global_map_params:e.global_map_params={map_settings:mapJson,language:mapJson.tripLanguage,geoname_service_url:"",map_print_service_url:"",hide_ui:!0},t=e.global_map_params),!t)throw new Error("Can't find map parameters");return t.preferences||(t.preferences={}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.globalMapParams=i},e3kh:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("zb0d"),r=function(){function e(e){e&&(e.min&&(this.min=new i.Point(e.min)),e.max&&(this.max=new i.Point(e.max)))}return e.closestPoint=function(e,t){var n=new i.Point(0,0);for(var r in n)e[r]<t.min[r]?n[r]=t.min[r]:e[r]>t.max[r]?n[r]=t.max[r]:n[r]=e[r];return n},e.overlaps=function(e,t){return!(e.max.x<t.min.x||e.min.x>t.max.x||e.max.y<t.min.y||e.min.y>t.max.y)},e.contains=function(e,t){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y},e.prototype.addPoint=function(e){this.min=void 0===this.min?e:i.Point.min(this.min,e),this.max=void 0===this.max?e:i.Point.max(this.max,e)},e.prototype.addArray=function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t];this.addPoint(i)}},e.prototype.overlaps=function(t){return e.overlaps(this,t)},e.prototype.contains=function(t){return e.contains(this,t)},e}();t.BoundingBox=r},eewr:function(e,t,n){"use strict";function i(e){return o.\u0275vid(0,[o.\u0275qud(402653184,1,{renderCanvas:0}),o.\u0275qud(402653184,2,{canvas:0}),o.\u0275qud(402653184,3,{mapview:0}),(e()(),o.\u0275eld(0,[[1,0],["renderCanvas",1]],null,0,"canvas",[["style","position: absolute;"]],[[4,"width","px"],[4,"height","px"],[1,"width",0],[1,"height",0]],null,null,null,null)),(e()(),o.\u0275eld(0,null,null,1,"mapview2",[["style","display:block; position:absolute;"]],[[4,"width","px"],[4,"height","px"]],null,null,l.View_MapView2_0,l.RenderType_MapView2)),o.\u0275did(49152,[[3,4],["mapview",4]],0,a.MapView2,[],{canvasWidth:[0,"canvasWidth"],canvasHeight:[1,"canvasHeight"],compactAttribution:[2,"compactAttribution"],lang:[3,"lang"]},null),(e()(),o.\u0275eld(0,[[2,0],["eventCanvas",1]],null,0,"canvas",[["style","position: absolute;"]],[[4,"width","px"],[4,"height","px"],[1,"width",0],[1,"height",0]],null,null,null,null)),(e()(),o.\u0275ted(null,["\n"])),(e()(),o.\u0275ted(null,["\n"]))],function(e,t){var n=t.component;e(t,5,0,n.getCanvasWidth(),n.getCanvasHeight(),!0,n.lang)},function(e,t){var n=t.component;e(t,3,0,n.getCanvasWidth(),n.getCanvasHeight(),n.getCanvasWidth()*n.pixelRatio(),n.getCanvasHeight()*n.pixelRatio()),e(t,4,0,n.getCanvasWidth(),n.getCanvasHeight()),e(t,6,0,n.getCanvasWidth(),n.getCanvasHeight(),n.getCanvasWidth()*n.pixelRatio(),n.getCanvasHeight()*n.pixelRatio())})}function r(e){return o.\u0275vid(0,[(e()(),o.\u0275eld(0,null,null,1,"mapview",[],null,null,null,i,t.RenderType_MapView)),o.\u0275did(49152,null,0,s.MapView,[o.ElementRef],null,null)],null,null)}Object.defineProperty(t,"__esModule",{value:!0});var o=n("/oeL"),l=n("8wyk"),a=n("iRJu"),s=n("MksE"),p=[];t.RenderType_MapView=o.\u0275crt({encapsulation:2,styles:p,data:{}}),t.View_MapView_0=i,t.View_MapView_Host_0=r,t.MapViewNgFactory=o.\u0275ccf("mapview",s.MapView,r,{canvasWidth:"canvasWidth",canvasHeight:"canvasHeight",compactAttribution:"compactAttribution",lang:"lang"},{},[])},gsQE:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("zb0d"),r=n("e3kh"),o=n("UY1U"),l=function(){function e(e,t){var n=e||{};this.nodes=n.node||{},this.edges=n.edges||[],this.defaultEdgeProp=t}return e.generateControlPoints=function(e,t,n,r){var o=i.Point.minus(n,t).mul(1/3),l=new i.Point(-o.y,o.x);return[i.Point.plus(i.Point.plus(t,o),l),i.Point.plus(i.Point.minus(n,o),l)]},e.bezierFromPoints=function(e){for(var t=[],n=0;n<4;++n)t.push(e[n].x),t.push(e[n].y);return new Bezier(t)},e.bezierThroughPoints=function(t){for(var n=[],r=1;r<t.length;++r){var o=1===r?t[r-1]:t[r-2],l=t[r-1],a=t[r],s=r===t.length-1?t[r]:t[r+1];n.push(e.bezierFromPoints([l,i.Point.plus(l,i.Point.times(.2,i.Point.minus(a,o))),i.Point.plus(a,i.Point.times(.2,i.Point.minus(l,s))),a]))}return n},e.placeLeaderLine=function(e,t,n){e.properties||(e.properties={});var o,l=e.properties.leaderLine||"bestAnchor",a=e.properties.labelBbox;if("center"===l){var s=(a.max.x,a.min.x,new i.Point((a.min.x+a.max.x)/2,(a.min.y+a.max.y)/2)),p=i.Point.minus(e.coord,s);p.mul(.02),o=i.Point.plus(s,p)}else o="closestOnBbox"===l?r.BoundingBox.closestPoint(e.coord,a):d3.labeler.closestLineAnchorPoint(e.coord,{left:a.min.x,right:a.max.x,top:a.min.y,bottom:a.max.y,cx:(a.min.x+a.max.x)/2,cy:(a.min.y+a.max.y)/2});e.properties.leaderLineAnchorPixelOffset=void 0,e.properties.leaderLineAnchor=o,e.convertToPixelOffset(t,n)},e.prototype.createDefaultBezier=function(){for(var t in this.edges)for(var n=this.edges[t],i=this.nodes[n.from],r=this.nodes[n.to],o=e.generateControlPoints(void 0,i.coord,r.coord,void 0),l=0;l<o.length;++l)n.controlPoints[l]=o[l]},e.prototype.edgeProperty=function(e,t){return e.properties[t]||this.defaultEdgeProp[t]},e.prototype.getEdgeRoute=function(e){if("route"==this.edgeProperty(e,"geom")&&e.properties&&e.properties.route&&e.properties.route.geom&&this.edgeProperty(e,"travelMean")==e.properties.route.mean)return e.properties.route},e.prototype.bezier=function(t){if(!t.controlPoints||t.properties.hidden)return[];if("straight"==this.edgeProperty(t,"geom"))return e.bezierThroughPoints([this.nodes[t.from].coord,this.nodes[t.to].coord]);if(2===t.controlPoints.length){var n=[this.nodes[t.from].coord,t.controlPoints[0],t.controlPoints[1],this.nodes[t.to].coord];return[e.bezierFromPoints(n)]}if(5===t.controlPoints.length){var i=[this.nodes[t.from].coord,t.controlPoints[0],t.controlPoints[1],t.controlPoints[2]],r=[t.controlPoints[2],t.controlPoints[3],t.controlPoints[4],this.nodes[t.to].coord];return[e.bezierFromPoints(i),e.bezierFromPoints(r)]}var o=[this.nodes[t.from].coord].concat(t.controlPoints,[this.nodes[t.to].coord]);return e.bezierThroughPoints(o)},e.prototype.bounds=function(){var e=new r.BoundingBox;for(var t in this.nodes)this.nodes[t].properties.skip||e.addPoint(this.nodes[t].coord);return e},e.prototype.frame=function(e,t){var n=this.bounds();if(t=t||1.1,n.max&&n.min){if(n.min.x===n.max.x){var o=new i.Point(1/32,1/32);n.addPoint(i.Point.plus(n.min,o)),n.addPoint(i.Point.minus(n.min,o))}}else n.min=new i.Point(0,0),n.max=new i.Point(1,1),t=1;e=e||(n.max.x-n.min.x)/(n.max.y-n.min.y);var l="number"==typeof t?new i.Point(t,t):t,a=i.Point.minus(n.max,n.min);a.x*=l.x,a.y*=l.y;var s,p=a.y*e;s=a.x>p?new i.Point(a.x,a.x/e):new i.Point(a.y*e,a.y),s.mul(.5);var u=i.Point.times(.5,i.Point.plus(n.max,n.min)),d=new r.BoundingBox;return d.addPoint(i.Point.minus(u,s)),d.addPoint(i.Point.plus(u,s)),d},e.prototype.location=function(e,t){var n=this.frame(e,t);n.max.x,n.min.x;return{x:(n.max.x+n.min.x)/2,y:(n.max.y+n.min.y)/2,scale:Math.max(1/32768,n.max.x-n.min.x)}},e.prototype.compareNodes=function(e){var t=function(e,t){for(var n in e)if(!(n in t))return!1;return!0};return t(this.nodes,e.nodes)&&t(e.nodes,this.nodes)},e.prototype.getEdgeDirections=function(e,t){var n=Utils.worldToLatLon(this.nodes[e.from].coord),r=Utils.worldToLatLon(this.nodes[e.to].coord);return o.getDirections(n,r,t).then(function(e){var n=e.map(function(e){return new i.Point(Utils.latLonToWorld(e))});return{mean:t,geom:n,midpoint:o.midPoint(n)}})},e}();t.TripGraph=l},hCN4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("/oeL"),r=n("Nf9t"),o=n("i+6n"),l=n("0j86"),a=n("qbdv"),s=n("fc+i"),p=n("XKz0"),u=n("yJCl");t.AppModuleNgFactory=i.\u0275cmf(r.AppModule,[o.TestApp],function(e){return i.\u0275mod([i.\u0275mpd(512,i.ComponentFactoryResolver,i.\u0275CodegenComponentFactoryResolver,[[8,[l.TestAppNgFactory]],[3,i.ComponentFactoryResolver],i.NgModuleRef]),i.\u0275mpd(5120,i.LOCALE_ID,i.\u0275m,[[3,i.LOCALE_ID]]),i.\u0275mpd(4608,a.NgLocalization,a.NgLocaleLocalization,[i.LOCALE_ID]),i.\u0275mpd(4608,i.Compiler,i.Compiler,[]),i.\u0275mpd(5120,i.APP_ID,i.\u0275f,[]),i.\u0275mpd(5120,i.IterableDiffers,i.\u0275k,[]),i.\u0275mpd(5120,i.KeyValueDiffers,i.\u0275l,[]),i.\u0275mpd(4608,s.DomSanitizer,s.\u0275e,[a.DOCUMENT]),i.\u0275mpd(6144,i.Sanitizer,null,[s.DomSanitizer]),i.\u0275mpd(4608,s.HAMMER_GESTURE_CONFIG,s.HammerGestureConfig,[]),i.\u0275mpd(5120,s.EVENT_MANAGER_PLUGINS,function(e,t,n,i){return[new s.\u0275DomEventsPlugin(e),new s.\u0275KeyEventsPlugin(t),new s.\u0275HammerGesturesPlugin(n,i)]},[a.DOCUMENT,a.DOCUMENT,a.DOCUMENT,s.HAMMER_GESTURE_CONFIG]),i.\u0275mpd(4608,s.EventManager,s.EventManager,[s.EVENT_MANAGER_PLUGINS,i.NgZone]),i.\u0275mpd(135680,s.\u0275DomSharedStylesHost,s.\u0275DomSharedStylesHost,[a.DOCUMENT]),i.\u0275mpd(4608,s.\u0275DomRendererFactory2,s.\u0275DomRendererFactory2,[s.EventManager,s.\u0275DomSharedStylesHost]),i.\u0275mpd(6144,i.RendererFactory2,null,[s.\u0275DomRendererFactory2]),i.\u0275mpd(6144,s.\u0275SharedStylesHost,null,[s.\u0275DomSharedStylesHost]),i.\u0275mpd(4608,i.Testability,i.Testability,[i.NgZone]),i.\u0275mpd(4608,s.Meta,s.Meta,[a.DOCUMENT]),i.\u0275mpd(4608,s.Title,s.Title,[a.DOCUMENT]),i.\u0275mpd(4608,p.HttpXsrfTokenExtractor,p.\u0275g,[a.DOCUMENT,i.PLATFORM_ID,p.\u0275e]),i.\u0275mpd(4608,p.\u0275h,p.\u0275h,[p.HttpXsrfTokenExtractor,p.\u0275f]),i.\u0275mpd(5120,p.HTTP_INTERCEPTORS,function(e){return[e]},[p.\u0275h]),i.\u0275mpd(4608,p.\u0275d,p.\u0275d,[]),i.\u0275mpd(6144,p.XhrFactory,null,[p.\u0275d]),i.\u0275mpd(4608,p.HttpXhrBackend,p.HttpXhrBackend,[p.XhrFactory]),i.\u0275mpd(6144,p.HttpBackend,null,[p.HttpXhrBackend]),i.\u0275mpd(5120,p.HttpHandler,p.\u0275interceptingHandler,[p.HttpBackend,[2,p.HTTP_INTERCEPTORS]]),i.\u0275mpd(4608,p.HttpClient,p.HttpClient,[p.HttpHandler]),i.\u0275mpd(4608,u.DaysService,u.DaysService,[p.HttpClient]),i.\u0275mpd(512,a.CommonModule,a.CommonModule,[]),i.\u0275mpd(1024,i.ErrorHandler,s.\u0275a,[]),i.\u0275mpd(1024,i.APP_INITIALIZER,function(e,t){return[s.\u0275c(e,t)]},[[2,s.NgProbeToken],[2,i.NgProbeToken]]),i.\u0275mpd(512,i.ApplicationInitStatus,i.ApplicationInitStatus,[[2,i.APP_INITIALIZER]]),i.\u0275mpd(131584,i.\u0275e,i.\u0275e,[i.NgZone,i.\u0275Console,i.Injector,i.ErrorHandler,i.ComponentFactoryResolver,i.ApplicationInitStatus]),i.\u0275mpd(2048,i.ApplicationRef,null,[i.\u0275e]),i.\u0275mpd(512,i.ApplicationModule,i.ApplicationModule,[i.ApplicationRef]),i.\u0275mpd(512,s.BrowserModule,s.BrowserModule,[[3,s.BrowserModule]]),i.\u0275mpd(512,p.HttpClientXsrfModule,p.HttpClientXsrfModule,[]),i.\u0275mpd(512,p.HttpClientModule,p.HttpClientModule,[]),i.\u0275mpd(512,r.AppModule,r.AppModule,[]),i.\u0275mpd(256,p.\u0275e,"XSRF-TOKEN",[]),i.\u0275mpd(256,p.\u0275f,"X-XSRF-TOKEN",[])])})},"i+6n":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("/oeL"),r=n("ddSW"),o=n("PWOr"),l=function(){function e(e){this.changeDetector=e,this.location="",this.canvasWidth=512,this.canvasHeight=512,this.tripId=currentTripId,this.translations=translations,console.log("TRIP ID: "+this.tripId);var t=r.globalMapParams();this.trip=new o.SeqTrip,this.trip.load(t.map_settings),this.originalLocation=this.trip.location(),this.trip.setLanguage(t.language),this.language=t.language}return e.prototype.selectLocation=function(e){e?(this.location=e.name,this.latitude=e.latitude,this.longitude=e.longitude):this.location="",this.setMarker(e);var t={x:this.originalLocation.x,y:this.originalLocation.y,scale:this.originalLocation.scale};if(e){var n=Utils.latLonToWorld([e.longitude,e.latitude]);t.x=n.x,t.y=n.y,t.scale*=.5}this.renderer.setLocation(t)},e.prototype.placeClicked=function(e){var t=Utils.worldToLatLon(e.coord),n={id:null,name:"",latitude:t.lat,longitude:t.lon};this.days&&this.days.scrollTo(n),this.setMarker()},e.prototype.fullMap=function(){this.selectLocation()},e.prototype.mapWidth=function(){return this.mapview_parent?this.mapview_parent.nativeElement.clientWidth:0},e.prototype.mapHeight=function(){return this.mapview_parent?this.mapview_parent.nativeElement.clientHeight:0},e.prototype.ngAfterViewInit=function(){var e=this;setTimeout(function(){e.mapview.prepareCanvas({trip:e.trip,created:function(t,n){e.renderer=t,e.tripLayer=n,e.mapview.addAttributionControl(!0),t.pinchZoom.touchEventHandlers.push(e)}})})},e.prototype.onResize=function(){this.mapview.refresh()},e.prototype.T=function(e){for(var t=e.split("."),n=translations;t.length>0;){var i=t[0];if(!n[i])return console.log("Missing translation: "+e),e;n=n[i],t=t.slice(1)}return"object"==typeof n?(console.log("invalid translation key: "+e),e):n},e.prototype.acceptTouchEvent=function(e,t,n){if("wheel"===n)return!1;var i=this.tripLayer.findLabelAtWorldPos(t)||this.tripLayer.findNodePointAtViewerPos(e);return!!i&&(this.placeClicked(i),this.changeDetector.detectChanges(),!0)},e.prototype.handleMouseDown=function(e){e.preventDefault()},e.prototype.handleMouseMove=function(e){e.preventDefault()},e.prototype.handleMouseUp=function(e){e.preventDefault()},e.prototype.handleMouseWheel=function(e){e.preventDefault()},e.prototype.handleStart=function(e){e.preventDefault()},e.prototype.handleEnd=function(e){e.preventDefault()},e.prototype.setMarker=function(e){if(this.marker&&(this.marker.remove(),this.marker=void 0),e){var t=document.createElement("i");t.className="fa fa-map-marker",t.style.color="red",t.style.fontSize="40px",this.marker=this.mapview.addMarker(e,{element:t,anchor:"bottom"})}},e.ctorParameters=function(){return[{type:i.ChangeDetectorRef}]},e}();t.TestApp=l},iRJu:function(e,t,n){"use strict";function i(e){if(!e)return[];var t=Utils.worldToLatLon(e);return[t.lon,t.lat]}function r(e,t,n){var r=n.nodes,o=t.edgeProperty(e,"geom");if(e.properties&&e.properties.hidden||r[e.from].properties.skip||r[e.to].properties.skip)return[];if("route"==o){if(e.properties&&e.properties.route&&e.properties.route.geom)return e.properties.route.geom.map(i);o="straight"}if("straight"==o)return[r[e.from].coord,r[e.to].coord].map(i);if(2==e.controlPoints.length){for(var l=[r[e.from].coord,e.controlPoints[0],e.controlPoints[1],r[e.to].coord],a=[],s=0,p=l;s<p.length;s++){var u=p[s];a.push(u.x),a.push(u.y)}return new Bezier(a).getLUT(128).map(i)}return console.log("Unexpected edge structure, not drawing"),[]}Object.defineProperty(t,"__esModule",{value:!0}),t.klokanApiKey="e7trAnc5053j8mX60MlQ";var o=(mapboxgl.AttributionControl,mapboxgl.Map),l=mapboxgl.ScaleControl,a=function(){function e(){this.waitingList=[]}return e.prototype.pixelRatio=function(){return window.devicePixelRatio||1},e.prototype.createMap=function(e){var n=this;if(!this._map){var r={container:this.mapDiv.nativeElement,style:"https://maps.tilehosting.com/styles/"+e.getMapStyle()+"/style.json?key="+t.klokanApiKey,center:i(e.location()),zoom:this.getZoomFromLocation(e.location()),attributionControl:!1,minZoom:0,renderWorldCopies:!0};this._map=new o(r),this._map.on("error",function(e){console.log("Map error:",e)}),this._map.on("load",function(){var e=Object.keys(n._map.getStyle().sources);n.lang&&n._map.setLanguage(n.lang);for(var t=0,i=e;t<i.length;t++){var r=i[t],o=n._map.getSource(r);o&&(o.tileSize=400,o.roundZoom=!0)}});var a=new l;return this._map.addControl(a),this._map}},e.prototype.addTripLayers=function(e,t,n,i,r){var o=this._map;this._graph=t;var l=this.buildPathGeoJson(e,t),a=o.getSource("dayEdges"),s=this.firstLayerOfType("symbol").id;if(n)this.updateCanvasLayer(n,i,r);else if(a?a.setData(l):o.addSource("dayEdges",{type:"geojson",data:l}),void 0==o.getLayer("dayEdgesLayer")){o.addLayer({id:"dayEdgesLayer",type:"line",source:"dayEdges",minZoom:0,layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":["get","color"],"line-width":["get","width"]}},s)}var p=this.buildPlacesGeoJson(e,t),u=o.getSource("dayPlaces");if(u)u.setData(p);else{o.addSource("dayPlaces",{type:"geojson",data:p}),o.addLayer({id:"dayLabels",type:"symbol",source:"dayPlaces",minZoom:0,layout:{"text-field":"{label}","text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-anchor":"center","text-offset":{type:"identity",property:"labelOffset"},"text-size":{property:"fontSize",type:"identity"},"text-allow-overlap":!0,"text-max-width":100,visibility:this._disabledLayers?"none":"visible"},paint:{"text-color":{property:"fill",type:"identity"},"text-halo-color":{property:"stroke",type:"identity"},"text-halo-width":1.2}});var d=e.places().filter(function(e){return!e.properties.skip}).map(function(e){return e.label+""});this.hidePlaces(d)}},e.prototype.updateCanvasLayer=function(e,t,n){var r=this;if(e&&t){var o=this._map,l=o.getSource("canvasSource");if(l){var a=l.coordinates,s=t.map(i);JSON.stringify(a)!=JSON.stringify(s)&&l.setCoordinates(s),l.play()}else{var p=this.firstLayerOfType("symbol").id;o.addSource("canvasSource",{type:"canvas",canvas:e,animate:!0,coordinates:t.map(i)}),o.addLayer({id:"canvasLayer",type:"raster",source:"canvasSource",paint:{"raster-fade-duration":0},layout:{visibility:this._disabledLayers?"none":"visible"},minZoom:0},p)}this.pauseCanvasSourceTimeout&&clearTimeout(this.pauseCanvasSourceTimeout),this.pauseCanvasSourceTimeout=setTimeout(function(){r.pauseCanvasSourceTimeout=void 0,o.getSource("canvasSource").pause()},200),this.killMapLabels(n)}},e.prototype.firstLayerOfType=function(e){for(var t=this._map.getStyle().layers,n=0;n<t.length;n++)if(t[n].type===e&&"contour_label"!=t[n].id&&!t[n].id.match(/^(water_name)|(highway)/))return t[n]},e.prototype.resize=function(){this._map&&(this._map.resize(),this._trip&&this.setMapboxLocation(this._trip.location()))},e.prototype.setMapboxLocation=function(e){if(!isFinite(e.x)||!isFinite(e.y))throw new Error("Invalid coordinates: "+e.x+", "+e.y);this._map&&(this._map.setCenter(i(e)),isFinite(e.scale)&&this._map.setZoom(this.getZoomFromLocation(e)))},e.prototype.getZoomFromLocation=function(e){if(e){var t=this.canvasWidth;return Math.log2(1/(e.scale*(512/t)))}return 8},e.prototype.buildPathGeoJson=function(e,t){return{type:"FeatureCollection",features:t.edges.map(function(n){return{type:"Feature",geometry:{type:"LineString",coordinates:r(n,e,t)},properties:{mean:n.properties.travelMean,color:e.edgeProperty(n,"lineColor"),width:parseFloat(e.edgeProperty(n,"lineWidth")),dashed:(e.edgeProperty(n,"dashed")||[]).concat([1])[0]}}})}},e.prototype.buildPlacesGeoJson=function(e,t){var n=[];for(var r in t.nodes){var o=t.nodes[r];if(o.properties.skip)return;var l=e.nodeProperty(o,"fontSize")||12,a=[0,-.5];if(o.properties.labelPixelOffset){var s=1/l;a=[o.properties.labelPixelOffset.x*s,o.properties.labelPixelOffset.y*s]}n.push({type:"Feature",geometry:{type:"Point",coordinates:i(o.coord)},properties:{label:o.label,labelOffset:a,fontSize:l,fill:e.nodeProperty(o,"fill"),stroke:e.nodeProperty(o,"stroke")}})}return{type:"FeatureCollection",features:n}},e.prototype.hidePlaces=function(e){var t=[["!in","name:"+this.lang].concat(e),["!in","name"].concat(e)],n=["","-"+this.lang],i=this._map;["place_city_capital","place_city","place_town","place_village","place_other"].forEach(function(e){n.forEach(function(n){var r=e+n;if(i.getLayer(r)){var o=i.getFilter(r);o=o.concat(t),i.setFilter(r,o)}})})},e.prototype.killMapLabels=function(e){var t=this,n=this._map;if(!n.hasImage("blank4")){for(var r=new Uint8Array(64),o=0;o<4;o++)for(var l=0;l<4;l++){var a=4*(4*l+o);r[a+0]=255,r[a+1]=0,r[a+2]=0,r[a+3]=0}n.addImage("blank4",{width:4,height:4,data:r})}e||console.log("No marked places!");var s=e.map(i);this._graph&&(s=s.concat(Object.keys(this._graph.nodes).map(function(e){return i(t._graph.nodes[e].coord)})));for(var p=n.getCanvas(),u=p.clientWidth,d=p.clientHeight,c=[],h=18;h<u;h+=18)c.push(n.unproject([h,0])),c.push(n.unproject([h,d]));for(var f=18;f<d;f+=18)c.push(n.unproject([0,f])),c.push(n.unproject([u,f]));s=s.concat(c.map(function(e){return[e.lng,e.lat]}));var m={type:"FeatureCollection",features:s.map(function(e){return{type:"Feature",geometry:{type:"Point",coordinates:e}}})},g=n.getSource("blankSource");g?g.setData(m):(n.addSource("blankSource",{type:"geojson",data:m}),n.addLayer({id:"blank",type:"symbol",source:"blankSource",minZoom:0,layout:{"icon-image":"blank4","icon-anchor":"center","icon-size":4,"icon-allow-overlap":!0,visibility:this._disabledLayers?"none":"visible"}}))},e.prototype.switchCustomLayers=function(e){if(this._map){var t=this._map;if(!e||this._disabledLayers){if(!e){if(this._disabledLayers)return;this._disabledLayers=["blank","dayLabels","canvasLayer"];for(var n=this._map.getStyle().layers,i=0;i<n.length;i++){var r=n[i];"symbol"==r.type&&"visible"==t.getLayoutProperty(r.id,"visibility")&&this._disabledLayers.push(r.id)}}var o=e?"visible":"none";this._disabledLayers.forEach(function(e){t.setLayoutProperty(e,"visibility",o)}),e&&(this._disabledLayers=void 0)}}},e}();t.MapView2=a},"ibj/":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("gsQE"),r=n("e3kh"),o=n("zb0d"),l=function(){function e(e){if(this.params=e,this.markedPlaces=[],this.renderer=e.renderer,this.defaultRadius=e.defaultRadius||6,this.icons={},this.defaultTextProp={fontSize:e.defaultFontSize||20,stroke:"rgba(255,255,255,.8)",fill:"#000000"},this.defaultEdgeProp=e.defaultEdgeProp||{lineWidth:1,lineColor:"#000000"},this.hideLabels=!!e.hideLabels,this.hideNodePoints=!!e.hideNodePoints,!this.renderer)throw new Error("TripGraphLayer: no renderer !");this.graph=e.graph||new i.TripGraph(void 0,this.defaultEdgeProp)}return e.prototype.draw=function(e,t,n,i){var r=this.graph,o=e.getContext("2d"),l=this.renderer.pixelRatio;this.markedPlaces=[];for(var a=0,s=r.edges;a<s.length;a++){var p=s[a];this.drawEdge(o,t,p,l,"curve")}for(var u=0,d=r.edges;u<d.length;u++){var p=d[u];this.drawEdge(o,t,p,l,"mark")}o.setLineDash([]);for(var c in r.nodes){var h=r.nodes[c];h.convertToPixelOffset(t,l),h.viewerPos=t.viewerPosFromWorldPos(h.coord)}if(!this.hideNodePoints)for(var c in r.nodes){var h=r.nodes[c];this.drawNodePoint(o,t,h)}for(var c in r.nodes)if(this.forceLeaderLines||!this.hideLabels||c.match(/-(takeoff)|(landing)$/)){var h=r.nodes[c];this.drawLeaderLine(o,t,h)}for(var c in r.nodes)if(!this.hideLabels||c.match(/-(takeoff)|(landing)$/)){var h=r.nodes[c];this.drawNodeLabel(o,t,h)}this.markedPlaces=this.markedPlaces.map(function(e){return t.worldPosFromViewerPos(e)})},e.prototype.drawEdge=function(e,t,n,i,r){this.setEdgeStrokeStyle(e,n),"route"==this.edgeProperty(n,"geom")?this.drawRoad(e,t,n,i,r):this.drawEdgeBezier(e,t,n,i,r)},e.prototype.drawRoad=function(e,t,n,i,r){var l=this,a=(this.edgeProperty(n,"travelMean"),this.graph.getEdgeRoute(n));if("curve"==r)if(a){var s=n.properties.route.geom;e.beginPath();var p=t.viewerPosFromWorldPos(s[0]);e.moveTo(p.x,p.y);for(var u=1;u<s.length;++u){var d=t.viewerPosFromWorldPos(s[u]);e.lineTo(d.x,d.y)}e.stroke()}else n.properties||(n.properties={}),this.graph.getEdgeDirections(n,this.edgeProperty(n,"travelMean")).then(function(e){n.properties.route=e,l.renderer.refresh()}).catch(function(e){console.log(e),n.properties.geom="straight",l.renderer.refresh()});else if("mark"==r&&a&&a.midpoint){var p=new o.Point(t.viewerPosFromWorldPos(a.geom[0])),c=new o.Point(t.viewerPosFromWorldPos(a.geom[a.geom.length-1]));if(o.Point.dist(c,p)>80*i){for(var h=a.midpoint,f=16*i,m=new o.Point(t.viewerPosFromWorldPos(a.geom[h])),g=void 0,u=h;u<a.geom.length;++u){var v=new o.Point(t.viewerPosFromWorldPos(a.geom[u])),y=o.Point.dist(m,v);if(y>f){g=o.Point.minus(v,m);break}}if(!g)return;var P=new o.Point(g.y,-g.x);this.drawEdgeMark(o.Point.plus(m,o.Point.times(8*i/g.norm(),g)),P,g,e,i,n,r)}}},e.prototype.drawEdgeBezier=function(e,t,n,i,r){for(var o=this.graph.bezier(n),l=0,a=o;l<a.length;l++){var s=a[l];this.drawBezier(e,t,s,i,n,r)}if("mark"!=r&&o.length>1&&n.drawMiddlePoint)for(var p in o){var u=t.viewerPosFromWorldPos(o[p].points[3]),d=5*i;e.beginPath(),e.arc(u.x,u.y,d,0,2*Math.PI,!1),e.fillStyle="#000000",e.fill()}},e.prototype.drawBezier=function(e,t,n,i,r,l){e.save();for(var a=new Array(8),s=n.points,p=0;p<4;++p){var u=t.viewerPosFromWorldPos(s[p]);a[2*p]=u.x,a[2*p+1]=u.y}var d=new Bezier(a),c=d.length(),h=Math.min(2,Math.floor(c/(40*i))),f=d.points;"mark"!=l&&(e.beginPath(),e.moveTo(f[0].x,f[0].y),e.bezierCurveTo(f[1].x,f[1].y,f[2].x,f[2].y,f[3].x,f[3].y),e.stroke());for(var m=1;m<h;++m){var g=m/h,u=new o.Point(d.get(g)),v=new o.Point(d.normal(g)),y=new o.Point(d.derivative(g));this.drawEdgeMark(u,v,y,e,i,r,l)}e.restore()},e.prototype.drawEdgeMark=function(t,n,i,r,o,l,a){switch(this.edgeProperty(l,"travelMean")){case"Bike":case"Boat":case"Bus":case"Car":case"Helicopter":case"Plane":case"Train":case"Walk":"curve"!=a&&this.drawEdgeMarkIcon(t,n,i,r,o,l);break;case"Unspecified":default:"mark"!=a&&e.drawEdgeMarkTriangle(t,n,i,r,o)}},e.drawEdgeMarkTriangle=function(e,t,n,i,r){var l=10*r;n.mul(l/n.norm()),e=o.Point.plus(e,o.Point.times(.5,n));var a=o.Point.minus(e,n);i.beginPath(),i.moveTo(a.x+l/2*t.x,a.y+l/2*t.y),i.lineTo(e.x,e.y),i.lineTo(a.x-l/2*t.x,a.y-l/2*t.y),i.closePath(),i.fill()},e.prototype.drawEdgeMarkIcon=function(e,t,n,i,r,l){i.fillStyle="#fff",i.setLineDash([]),i.lineWidth=1*r;var a=10*r,s=6*r;n=n.mul(1/n.norm());var p=o.Point.plus(e,o.Point.times((a+s)/2,n)),u=o.Point.minus(e,o.Point.times((a+s)/2,n)),d=o.Point.plus(u,o.Point.times(a,n)),c=new o.Point(-n.y,n.x).mul(4*r),h=o.Point.plus(d,c),f=o.Point.minus(d,c),m=o.Point.minus(h,u),g=Math.atan2(m.y,m.x),v=o.Point.minus(f,u),y=Math.atan2(v.y,v.x);i.beginPath(),i.arc(u.x,u.y,a,g,y),i.lineTo(p.x,p.y),i.closePath(),i.fill(),i.stroke(),i.fillStyle="#000",i.textAlign="center",i.textBaseline="middle",i.font=Math.round(10*r)+"px FontAwesome";var P={Bike:"\uf206",Boat:"\uf21a",Bus:"\uf207",Car:"\uf1b9",Helicopter:"H",Plane:"\uf072",Train:"\uf238",Walk:"\uf183"},x=this.edgeProperty(l,"travelMean");"Plane"==x&&(i.save(),i.translate(u.x,u.y),i.rotate(Math.PI/4+Math.atan2(n.y,n.x)),i.translate(-u.x,-u.y)),i.fillText(P[x],u.x,u.y),this.markedPlaces.push(u),"Plane"==x&&i.restore()},e.prototype.edgeProperty=function(e,t){return e.properties[t]||this.defaultEdgeProp[t]},e.prototype.setEdgeStrokeStyle=function(e,t){var n=this.edgeProperty(t,"lineColor");e.strokeStyle=n,e.fillStyle=n,e.lineWidth=this.renderer.pixelRatio*this.edgeProperty(t,"lineWidth"),this.setDashStyle(e,this.edgeProperty(t,"dashed"))},e.prototype.nodeRadius=function(e){var t=this.defaultRadius;return e.properties&&e.properties.radius&&(t=e.properties.radius),t*this.renderer.pixelRatio},e.prototype.drawNodePoint=function(e,t,n){if(!n.properties||0!=n.properties.point){var i=n.viewerPos;this.drawPoint(e,i,this.renderer.pixelRatio,n.properties||{})}},e.prototype.drawNodeLabel=function(t,n,i){var r=this;if(i.label||i.labelIcon){var o=i.labelPixelPos(n,this.renderer.pixelRatio);if(i.label&&e.drawText(t,i.label,o,this.renderer.pixelRatio,i.properties||{},this.defaultTextProp),i.labelIcon)if(i.labelIcon.url in this.icons){if(void 0!=i.labelIcon.autorotate){var l=n.viewerPosFromWorldPos(i.coord);i.labelIcon.angle=i.labelIcon.autorotate+Math.atan2(l.y-o.y,l.x-o.x)}this.drawIcon(t,this.icons[i.labelIcon.url],i.labelIcon,o,this.renderer.pixelRatio)}else this.loadIcons(function(){return r.renderer.refresh()});if(i.properties&&i.properties.frame&&i.label){var a=e.measureText(t,i.label,this.renderer.pixelRatio,i.properties||{},this.defaultTextProp);t.strokeStyle=i.properties.frame,a.width+=3*this.renderer.pixelRatio,a.height+=3*this.renderer.pixelRatio,t.rect(o.x-a.width/2,o.y-a.height/2,a.width,a.height),t.stroke()}}},e.prototype.setDashStyle=function(e,t){var n=[];if(t)for(var i=0,r=t;i<r.length;i++){var o=r[i];n.push(this.renderer.pixelRatio*o)}e.setLineDash(n)},e.prototype.drawLeaderLine=function(e,t,n){if(n.properties){var i=n.properties;if(i.leaderLineAnchor||i.leaderLineAnchorPixelOffset){var r=this.renderer.pixelRatio,l=n.leaderLineAnchorPos(t,r);e.lineWidth=(n.properties.leaderLineWidth||1)*r,e.beginPath();var a=t.viewerPosFromWorldPos(n.coord),s=this.nodeRadius(n),p=n.properties&&void 0!==n.properties.maxLeaderLineLength?n.properties.maxLeaderLineLength*r:3*s;o.Point.dist(l,a)>p&&(n.properties.dashed&&this.setDashStyle(e,n.properties.dashed),e.moveTo(l.x,l.y),e.lineTo(a.x,a.y),e.strokeStyle=n.properties.leaderLineColor||"#000000",e.stroke(),n.properties.dashed&&e.setLineDash([]))}}},e.prototype.drawPoint=function(e,t,n,i){e.strokeStyle="rgba(0,0,0,1)",e.fillStyle="rgba(255,255,255,1)",e.lineWidth=2*n,e.beginPath();var r=(i.radius||this.defaultRadius)*n;e.arc(t.x,t.y,r,0,2*Math.PI,!1),e.stroke(),e.fill();var o=i.markStyle;!o&&i.firstVisited&&(o="first"),"first"===o&&(e.fillStyle="rgba(0, 0, 0, 1)",e.beginPath(),e.arc(t.x,t.y,.6*r,0,2*Math.PI,!1),e.fill())},e.measureText=function(t,n,i,r,o){var l=n.split("\n"),a=e.setTextStyle(t,i,r,o),s={width:0,height:a*l.length*1.1};for(var p in l)s.width=Math.max(s.width,1.1*t.measureText(l[p]).width);return s},e.setTextStyle=function(e,t,n,i){n=n||{};var r=n.fontSize||i.fontSize;return r*=t,e.font=r+"px "+(n.font||"'PT Sans', sans-serif"),e.strokeStyle=n.stroke||i.stroke,e.lineWidth=(n.haloWidth||4)*t,e.fillStyle=n.fill||i.fill,parseInt(""+r)},e.drawText=function(t,n,i,r,o,l){var a,s,p=(void 0!=o.textOffset?o.textOffset:20)*r,u=((o.textPlacement||"S")+"").toUpperCase();switch(u){default:case"C":case"N":case"S":t.textAlign="center",a=0;break;case"E":case"NE":t.textAlign="start",a=p;break;case"O":case"W":t.textAlign="end",a=-p}switch(u){case"C":case"E":case"W":case"O":t.textBaseline="middle",s=0;break;case"N":case"NE":t.textBaseline="bottom",s=-p;break;default:case"S":t.textBaseline="top",s=p}var d=i.x+a,c=i.y+s,h=e.setTextStyle(t,r,o,l),f=n.split("\n");t.shadowBlur=3*r,t.shadowColor="#ffffff",t.lineWidth=2*r;for(var m=(f.length-1)/2,g=0;g<f.length;++g){var v=c+(g-m)*h;t.strokeText(f[g],d,v),t.fillText(f[g],d,v)}t.shadowColor="transparent"},e.prototype.drawIcon=function(e,t,n,i,r){if(t){var l=n.width?n.width*r:16*r,a=n.height?n.height*r:l,s="ratioX"in n?n.ratioX:.5,p="ratioY"in n?n.ratioY:.5,u=l*s,d=a*p;n.angle?(e.save(),e.translate(i.x,i.y),e.rotate(n.angle),e.drawImage(t,-u,-d,l,a),e.restore(),this.markedPlaces.push(o.Point.plus(i,o.Point.rotate(new o.Point(l/2-u,a/2-d),n.angle)))):(e.drawImage(t,i.x-u,i.y-d,l,a),this.markedPlaces.push({x:i.x-u+l/2,y:i.y-d+a/2}))}},e.prototype.getLabelIconSize=function(e,t){var n=this.renderer.pixelRatio,i=t.labelIcon;return{width:(i.width||16)*n,height:(i.height||i.width||16)*n}},e.prototype.computeNodeSizeWithMargin=function(t,n){var i;if(n.label){var r=this.renderer.pixelRatio;i=e.measureText(t,n.label,r,n.properties,this.defaultTextProp)}else n.labelIcon&&(i=this.getLabelIconSize(t,n),i.width*=1.4,i.height*=1.4);if(!i)throw"no label and no labIcon for node";var o=2*this.renderer.pixelRatio;return i.width+=2*o,i.height+=2*o,i},e.prototype.setLabelBbox=function(e,t,n){if(e&&(e.label||e.labelIcon)&&e.properties&&(e.properties.labelCoord||e.properties.labelPixelOffset)){t||(t=this.renderer.canvas.getContext("2d"));var i=this.renderer.pinchZoom;if(!n){var l=this.computeNodeSizeWithMargin(t,e),a=e.labelPixelPos(i,this.renderer.pixelRatio);n={x:a.x,y:a.y,width:l.width,height:l.height}}var s=e.properties,p=o.Point.times(.5,new o.Point(n.width,n.height));s.labelBbox=new r.BoundingBox({min:i.worldPosFromViewerPos(o.Point.minus(n,p)),max:i.worldPosFromViewerPos(o.Point.plus(n,p))})}},e.prototype.nodeName=function(e){if(e.label)return e.label;if(e.labelIcon)return"icon:"+e.labelIcon.url;throw"no label and no labIcon for node"},e.prototype.placeLabels=function(e){var t=this.renderer.pinchZoom,n=this.renderer.pixelRatio,l=[],a=[];for(var s in this.graph.nodes){var p=this.graph.nodes[s];if(p.label||p.labelIcon){var u=t.viewerPosFromWorldPos(p.coord),d=this.defaultRadius;p.properties&&p.properties.radius&&(d=p.properties.radius),a.push({x:u.x,y:u.y,r:d*n});var c=this.computeNodeSizeWithMargin(e,p),h=this.nodeName(p),f=u,m=void 0;p.properties&&p.properties.userPlacement&&(m=f=t.viewerPosFromWorldPos(p.properties.userPlacement)),p.properties&&p.properties.userPlacementPixelOffset&&(m=f=o.Point.plus(u,o.Point.times(n,p.properties.userPlacementPixelOffset)));var g={x:f.x,y:f.y,name:h,width:c.width,height:c.height,node:p,userPlacement:m};l.push(g)}}var v=d3.labeler().label(l).anchor(a).width(this.renderer.canvas.width).height(this.renderer.canvas.height),y=v.alt_energy(),P=[],x=[];for(var w in this.graph.edges){var b=this.graph.getEdgeRoute(this.graph.edges[w]);if(b){for(var _=[],C=0,M=b.geom;C<M.length;C++){var L=M[C],T=t.viewerPosFromWorldPos(L);(0==_.length||o.Point.dist(_[_.length-1],T)>4*n)&&_.push(T)}var O=new r.BoundingBox;O.addArray(_),P.push(O),x.push(_)}else{var D=this.graph.bezier(this.graph.edges[w]);for(var s in D){var k=D[s],O=k.bbox();P.push({min:t.viewerPosFromWorldPos(O.x.min,O.y.min),max:t.viewerPosFromWorldPos(O.x.max,O.y.max)});var S=k.getLUT(30),E=[];for(var R in S)E.push(t.viewerPosFromWorldPos(S[R]));x.push(E)}}}v.alt_energy(function(e,t,n){var i=0,a=v.boxOfLabel(e),s=new r.BoundingBox;s.addPoint(new o.Point(a.left,a.top)),s.addPoint(new o.Point(a.right,a.bottom));for(var p in P)if(r.BoundingBox.overlaps(P[p],s)){var u=x[p];for(var d in u)s.contains(u[d])&&i++}var c=10*i+y(e),h=l[e].userPlacement;if(h){c+=o.Point.dist(h,l[e])}return c});v.start(5e3,1);for(var s in l){var I=l[s];I.node.properties||(I.node.properties={});var F=I.node.properties,A=t.viewerPosFromWorldPos(I.node.coord);F.labelPixelOffset=o.Point.minus(I,A).mul(1/n),"labelCoord"in F&&delete F.labelCoord,this.setLabelBbox(I.node,e,I),i.TripGraph.placeLeaderLine(I.node,t,n),F.textPlacement="C",F.textOffset=0}},e.shallowCopy=function(e){var t,n=Object.create(Object.getPrototypeOf(e)),i=Object.getOwnPropertyNames(e);for(t=0;t<i.length;t++)Object.defineProperty(n,i[t],Object.getOwnPropertyDescriptor(e,i[t]));return n},e.prototype.forEachNode=function(e){for(var t in this.graph.nodes)e(this.graph.nodes[t])},e.prototype.loadIcons=function(e){var t=this;this.iconsToLoad=1,this.failedIcons=0;var n=function(){t.iconsToLoad--,e&&0===t.iconsToLoad&&(t.failedIcons>0?e(new Error(t.failedIcons+" icons failed to load.")):e())};this.forEachNode(function(e){if(e.labelIcon){var i=e.labelIcon.url;t.iconsToLoad++;var r=window.imageUrlPrefix||"";t.renderer.loadImage(r+e.labelIcon.url,function(e){t.icons[i]=e,n()},function(e){console.log("Failed to load: "+i+" (prefix: "+r+")"),t.failedIcons++,n()})}}),n()},e.prototype.findLabelAtWorldPos=function(e){var t=this.graph.nodes;for(var n in t)if(t.hasOwnProperty(n)){var i=this.graph.nodes[n];if(i.properties&&(i.properties.labelCoord||i.properties.labelPixelOffset)&&this.setLabelBbox(i),i.properties&&i.properties.labelBbox&&r.BoundingBox.contains(i.properties.labelBbox,e))return i}},e.prototype.findNodePointAtViewerPos=function(e){var t=this.graph;for(var n in t.nodes){var i=t.nodes[n];if(!i.properties||0!=i.properties.point){var r=i.properties,l=(r.radius||this.defaultRadius)*this.renderer.pixelRatio;if(o.Point.dist(i.viewerPos,e)<l)return i}}},e}();t.TripGraphLayer=l},rDkg:function(e,t,n){"use strict";function i(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,1,"h2",[],null,null,null,null,null)),(e()(),P.\u0275ted(null,["",""]))],null,function(e,t){e(t,1,0,t.component.days.title)})}function r(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,1,"div",[["class","daySubTitle"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["",""]))],null,function(e,t){e(t,1,0,t.parent.context.$implicit.subtitle)})}function o(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,1,"li",[["class","clickable schedule_location_button_color"]],null,[[null,"click"]],function(e,t,n){var i=!0,r=e.component;if("click"===t){i=!1!==r.fireSelectLocation(e.context.$implicit)&&i}return i},null,null)),(e()(),P.\u0275ted(null,["",""]))],null,function(e,t){e(t,1,0,t.context.$implicit.name)})}function l(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,0,"div",[],[[8,"innerHTML",1]],null,null,null,null))],null,function(e,t){e(t,0,0,t.parent.context.$implicit.description)})}function a(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,2,"span",[["class","eventIndication"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["",""])),(e()(),P.\u0275eld(0,null,null,0,"br",[],null,null,null,null,null))],null,function(e,t){e(t,1,0,t.parent.context.$implicit.indication)})}function s(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,2,"span",[["class","eventIndication"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["",""])),(e()(),P.\u0275eld(0,null,null,0,"br",[],null,null,null,null,null))],null,function(e,t){var n=t.component;e(t,1,0,n.dateTimeToTime(n.toUTCDate(t.parent.context.$implicit.time)))})}function p(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,2,"span",[["class","eventTitle"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["",""])),(e()(),P.\u0275eld(0,null,null,0,"br",[],null,null,null,null,null))],null,function(e,t){e(t,1,0,t.parent.context.$implicit.title)})}function u(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,2,"span",[["class","eventSubTitle"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["",""])),(e()(),P.\u0275eld(0,null,null,0,"br",[],null,null,null,null,null))],null,function(e,t){e(t,1,0,t.parent.context.$implicit.subtitle)})}function d(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,3,"a",[["data-gallery","gallery1"],["data-toggle","lightbox"]],[[8,"href",4]],null,null,null,null)),(e()(),P.\u0275ted(null,["\n                "])),(e()(),P.\u0275eld(0,null,null,0,"img",[["class","thumbnail-schedule"]],[[8,"src",4]],null,null,null,null)),(e()(),P.\u0275ted(null,["\n              "]))],null,function(e,t){e(t,0,0,P.\u0275inlineInterpolate(1,"",t.context.$implicit.thumb_url,"")),e(t,2,0,P.\u0275inlineInterpolate(1,"",t.context.$implicit.thumb_url,""))})}function c(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,21,"li",[["style","margin: 20px 0px; border-bottom: 1px solid #efefef;"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["\n            "])),(e()(),P.\u0275and(16777216,null,null,1,null,a)),P.\u0275did(16384,null,0,x.NgIf,[P.ViewContainerRef,P.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),P.\u0275ted(null,["\n            "])),(e()(),P.\u0275and(16777216,null,null,1,null,s)),P.\u0275did(16384,null,0,x.NgIf,[P.ViewContainerRef,P.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),P.\u0275ted(null,["\n            "])),(e()(),P.\u0275and(16777216,null,null,1,null,p)),P.\u0275did(16384,null,0,x.NgIf,[P.ViewContainerRef,P.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),P.\u0275ted(null,["\n            "])),(e()(),P.\u0275and(16777216,null,null,1,null,u)),P.\u0275did(16384,null,0,x.NgIf,[P.ViewContainerRef,P.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),P.\u0275ted(null,["\n            "])),(e()(),P.\u0275eld(0,null,null,0,"div",[["class","eventDescription"]],[[8,"innerHTML",1]],null,null,null,null)),(e()(),P.\u0275ted(null,["\n\n            "])),(e()(),P.\u0275eld(0,null,null,4,"div",[["class","slick-carousel"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["\n              "])),(e()(),P.\u0275and(16777216,null,null,1,null,d)),P.\u0275did(802816,null,0,x.NgForOf,[P.ViewContainerRef,P.TemplateRef,P.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),P.\u0275ted(null,["\n            "])),(e()(),P.\u0275ted(null,["\n          "]))],function(e,t){e(t,3,0,t.context.$implicit.indication),e(t,6,0,t.context.$implicit.time),e(t,9,0,t.context.$implicit.title),e(t,12,0,t.context.$implicit.subtitle),e(t,19,0,t.context.$implicit.pictures)},function(e,t){e(t,14,0,t.context.$implicit.description)})}function h(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,3,"a",[["data-gallery","gallery2"],["data-toggle","lightbox"]],[[8,"href",4]],null,null,null,null)),(e()(),P.\u0275ted(null,["\n            "])),(e()(),P.\u0275eld(0,null,null,0,"img",[["class","thumbnail-schedule img-fluid"]],[[8,"src",4]],null,null,null,null)),(e()(),P.\u0275ted(null,["\n          "]))],null,function(e,t){e(t,0,0,P.\u0275inlineInterpolate(1,"",t.context.$implicit.thumb_url,"")),e(t,2,0,P.\u0275inlineInterpolate(1,"",t.context.$implicit.thumb_url,""))})}function f(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,40,"li",[["style","padding:5px 20px;margin:0px;"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["\n        "])),(e()(),P.\u0275eld(0,null,null,16,"header",[],null,null,null,null,null)),(e()(),P.\u0275ted(null,["\n        "])),(e()(),P.\u0275eld(0,null,null,7,"div",[["class","day schedule_day_title_color separatorColor"],["style","width: 100%"]],null,null,null,null,null)),(e()(),P.\u0275eld(0,null,null,4,"strong",[],null,null,null,null,null)),(e()(),P.\u0275ted(null,["",""])),P.\u0275ppd(2),P.\u0275ppd(1),P.\u0275ppd(1),(e()(),P.\u0275ted(null,[", ",""])),P.\u0275ppd(2),(e()(),P.\u0275ted(null,["\n        "])),(e()(),P.\u0275eld(0,null,null,1,"div",[["class","dayTitle"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["",""])),(e()(),P.\u0275ted(null,["\n        "])),(e()(),P.\u0275and(16777216,null,null,1,null,r)),P.\u0275did(16384,null,0,x.NgIf,[P.ViewContainerRef,P.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),P.\u0275ted(null,["\n        "])),(e()(),P.\u0275ted(null,["\n\n        "])),(e()(),P.\u0275eld(0,null,null,4,"ul",[["class","locations"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["\n          "])),(e()(),P.\u0275and(16777216,null,null,1,null,o)),P.\u0275did(802816,null,0,x.NgForOf,[P.ViewContainerRef,P.TemplateRef,P.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),P.\u0275ted(null,["\n        "])),(e()(),P.\u0275ted(null,["\n\n        "])),(e()(),P.\u0275and(16777216,null,null,1,null,l)),P.\u0275did(16384,null,0,x.NgIf,[P.ViewContainerRef,P.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),P.\u0275ted(null,["\n\n        "])),(e()(),P.\u0275eld(0,null,null,4,"ul",[],null,null,null,null,null)),(e()(),P.\u0275ted(null,["\n          "])),(e()(),P.\u0275and(16777216,null,null,1,null,c)),P.\u0275did(802816,null,0,x.NgForOf,[P.ViewContainerRef,P.TemplateRef,P.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),P.\u0275ted(null,["\n        "])),(e()(),P.\u0275ted(null,["\n        "])),(e()(),P.\u0275eld(0,null,null,4,"div",[["class","slick-carousel"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["\n          "])),(e()(),P.\u0275and(16777216,null,null,1,null,h)),P.\u0275did(802816,null,0,x.NgForOf,[P.ViewContainerRef,P.TemplateRef,P.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),P.\u0275ted(null,["\n        "])),(e()(),P.\u0275ted(null,["\n      "]))],function(e,t){var n=t.component;e(t,17,0,t.context.$implicit.subtitle),e(t,23,0,n.locationsForDay(t.context.$implicit)),e(t,27,0,t.context.$implicit.description),e(t,32,0,t.context.$implicit.events),e(t,38,0,t.context.$implicit.pictures)},function(e,t){var n=t.component;e(t,6,0,P.\u0275unv(t,6,0,e(t,9,0,P.\u0275nov(t.parent.parent,0),n.T(P.\u0275unv(t,6,0,e(t,8,0,P.\u0275nov(t.parent.parent,1),P.\u0275unv(t,6,0,e(t,7,0,P.\u0275nov(t.parent.parent,2),t.context.$implicit.date,"EEEE")))))))),e(t,10,0,P.\u0275unv(t,10,0,e(t,11,0,P.\u0275nov(t.parent.parent,2),t.context.$implicit.date,"dd.MM.yy"))),e(t,14,0,t.context.$implicit.title)})}function m(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,10,"div",[],null,null,null,null,null)),(e()(),P.\u0275ted(null,["\n    "])),(e()(),P.\u0275and(16777216,null,null,1,null,i)),P.\u0275did(16384,null,0,x.NgIf,[P.ViewContainerRef,P.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),P.\u0275ted(null,["\n    "])),(e()(),P.\u0275eld(0,[[1,0],["dayEntryUl",1]],null,4,"ul",[["class","dayEntryUl"],["style","padding:5px;margin:5px;margin-top:10px;"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["\n      "])),(e()(),P.\u0275and(16777216,null,null,1,null,f)),P.\u0275did(802816,null,0,x.NgForOf,[P.ViewContainerRef,P.TemplateRef,P.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),P.\u0275ted(null,["\n    "])),(e()(),P.\u0275ted(null,["\n  "]))],function(e,t){var n=t.component;e(t,3,0,n.days.title),e(t,8,0,n.days.days)},null)}function g(e){return P.\u0275vid(0,[P.\u0275pid(0,x.UpperCasePipe,[]),P.\u0275pid(0,x.LowerCasePipe,[]),P.\u0275pid(0,x.DatePipe,[P.LOCALE_ID]),P.\u0275qud(671088640,1,{dayEntryUl:0}),(e()(),P.\u0275eld(0,null,null,9,"div",[["class","progview"]],[[8,"scrollTop",0]],null,null,null,null)),(e()(),P.\u0275ted(null,["\n  "])),(e()(),P.\u0275and(16777216,null,null,1,null,m)),P.\u0275did(16384,null,0,x.NgIf,[P.ViewContainerRef,P.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),P.\u0275ted(null,["\n  "])),(e()(),P.\u0275eld(0,null,null,0,"div",[["id","spin-loader"]],[[8,"hidden",0]],null,null,null,null)),(e()(),P.\u0275ted(null,["\n  "])),(e()(),P.\u0275eld(0,null,null,1,"p",[],[[8,"hidden",0]],null,null,null,null)),(e()(),P.\u0275ted(null,["",""])),(e()(),P.\u0275ted(null,["\n"])),(e()(),P.\u0275ted(null,["\n"]))],function(e,t){e(t,7,0,t.component.days)},function(e,t){var n=t.component;e(t,4,0,n.scrollTop),e(t,9,0,n.days||n.error),e(t,11,0,!n.error),e(t,12,0,n.error)})}function v(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,2,"days-view",[],null,null,null,g,t.RenderType_DaysView)),P.\u0275prd(512,null,b.DaysService,b.DaysService,[_.HttpClient]),P.\u0275did(638976,null,0,w.DaysView,[b.DaysService],null,null)],function(e,t){e(t,2,0)},null)}Object.defineProperty(t,"__esModule",{value:!0});var y=n("agHN"),P=n("/oeL"),x=n("qbdv"),w=n("xHFf"),b=n("yJCl"),_=n("XKz0"),C=[y.styles];t.RenderType_DaysView=P.\u0275crt({encapsulation:0,styles:C,data:{}}),t.View_DaysView_0=g,t.View_DaysView_Host_0=v,t.DaysViewNgFactory=P.\u0275ccf("days-view",w.DaysView,v,{tripId:"tripId"},{selectLocation:"selectLocation"},[])},tnZY:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("zb0d"),r=function(){function e(t){if(this.properties={},t){if(t.controlPoints){this.controlPoints=[];for(var n=0;n<t.controlPoints.length;++n)this.controlPoints[n]=new i.Point(t.controlPoints[n])}t.originalEdge&&(this.originalEdge=new e(t.originalEdge));for(var r=0,o=["from","to","drawMiddlePoint","properties","fromDbId"];r<o.length;r++){var l=o[r];l in t&&(this[l]=t[l])}if(t.properties&&(this.properties=t.properties,t.properties.lineWidth&&(this.properties.lineWidth=parseFloat(t.properties.lineWidth)),t.properties.dashed))for(var n=0;n<t.properties.dashed.length;++n)this.properties.dashed[n]=parseInt(t.properties.dashed[n])}}return e.prototype.propagateToOriginal=function(){if(this.originalEdge)for(var e=0,t=["controlPoints","drawMiddlePoint"];e<t.length;e++){var n=t[e];n in this&&(this.originalEdge[n]=this[n])}},e}();t.TripEdge=r},uTZG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.styles=[".flex-col[_ngcontent-%COMP%]{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column}.flex-col[_ngcontent-%COMP%], .flex-col-or-row[_ngcontent-%COMP%], .flex-row[_ngcontent-%COMP%]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}.flex-col-or-row[_ngcontent-%COMP%], .flex-row[_ngcontent-%COMP%]{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row}.flex-auto[_ngcontent-%COMP%]{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;overflow:auto}.flex-fixed[_ngcontent-%COMP%]{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;overflow:auto}.schedule-link[_ngcontent-%COMP%]:hover{text-decoration:underline;cursor:pointer}@media (orientation:portrait){.rotate[_ngcontent-%COMP%]{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}}agm-map[_ngcontent-%COMP%], days-view[_ngcontent-%COMP%], mapContainer[_ngcontent-%COMP%]{width:100%;height:100%;display:block}.relative[_ngcontent-%COMP%]{position:relative}.abs-fill[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0}article[_ngcontent-%COMP%]{background:#4b3}.region-header[_ngcontent-%COMP%]{padding-bottom:14px}#initerary[_ngcontent-%COMP%]   .region-header[_ngcontent-%COMP%]{margin-top:0!important}.h100[_ngcontent-%COMP%]{height:100%}.backtohomepage[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-transform:uppercase}.white-shadow[_ngcontent-%COMP%]{position:absolute;top:0;width:100%;height:30px;background:linear-gradient(#fff,hsla(0,0%,100%,0))}"]},xHFf:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("/oeL"),r=n("yJCl"),o=function(){function e(e){this.daysService=e,this.selectLocation=new i.EventEmitter,this.scrollTop=0,this.toUTCDate=function(e){var t;return t=new Date(e),new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds())},this.dateTimeToTime=function(e){return e.getMinutes()>=10?e.getHours()+":"+e.getMinutes():e.getHours()+":0"+e.getMinutes()},this.translations=translations}return e.prototype.ngOnInit=function(){this.fetchDays()},e.prototype.ngOnChanges=function(){this.fetchDays()},e.prototype.fetchDays=function(){var e=this;this.tripId&&this.daysService.getDays(this.tripId).then(function(t){e.setDays(t)}).catch(function(t){e.error="Failed to load trip content"})},e.prototype.setDays=function(e){this.days=e,this.days.days=e.days.filter(function(e){return null!=e.title||null!=e.subtitle||null!=e.description||e.events.length||e.locations.length||e.pictures.length})},e.prototype.fireSelectLocation=function(e){this.selectLocation.next(e)},e.eventBaseLocations=function(e){return e.locations},e.dayLocations=function(t){for(var n=e.eventBaseLocations(t).slice(),i=0,r=t.events;i<r.length;i++){var o=r[i];n=n.concat(e.eventBaseLocations(o))}return n},e.dist=function(e,t){var n=e.latitude-t.latitude,i=e.longitude-t.longitude;return n*n+i*i},e.distanceToDay=function(t,n){var i=e.dayLocations(t).map(function(t){return e.dist(t,n)});if(i.length>0)return Math.min.apply(Math,i)},e.prototype.scrollTo=function(t){if(this.dayEntryUl){for(var n,i,r=0;r<this.days.days.length;++r){var o=this.days.days[r],l=e.distanceToDay(o,t);l&&(!n||l<n)&&(n=l,i=r)}if(void 0!=i){var a=this.dayEntryUl.nativeElement.children[i].offsetTop;this.scrollTop=Math.max(0,a-5)}}},e.prototype.locationsForDay=function(e){for(var t=e.locations.slice(),n=0,i=e.events;n<i.length;n++){var r=i[n];t=t.concat(r.locations)}var o={};return t.filter(function(e){return!(e.name in o)&&(o[e.name]=!0)})},e.prototype.T=function(e){for(var t=e.split("."),n=translations;t.length>0;){var i=t[0];if(!n[i])return console.log("Missing translation: "+e),e;n=n[i],t=t.slice(1)}return"object"==typeof n?(console.log("invalid translation key: "+e),e):n},e.ctorParameters=function(){return[{type:r.DaysService}]},e}();t.DaysView=o},"y+vL":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.T={CanvasTilesRenderer:CanvasTilesRenderer,PinchZoom:PinchZoom,Utils:Utils}},yJCl:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("XKz0");n("82j9"),n("5v8a");var r=function(){function e(e){this.http=e}return e.prototype.getDays=function(e){return this.http.get("/api/trips/"+e+"/days.json").toPromise()},e.ctorParameters=function(){return[{type:i.HttpClient}]},e}();t.DaysService=r},zb0d:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){if("number"==typeof e&&"number"==typeof t?(this.x=e,this.y=t):Array.isArray(e)?(this.x=e[0],this.y=e[1]):"object"==typeof e&&(this.x=e.x,this.y=e.y),void 0===this.x||void 0===this.y)throw new Error("invalid point")}return e.minus=function(t,n){return new e(t.x-n.x,t.y-n.y)},e.plus=function(t,n){return new e(t.x+n.x,t.y+n.y)},e.times=function(t,n){return new e(t*n.x,t*n.y)},e.min=function(t,n){return new e(Math.min(t.x,n.x),Math.min(t.y,n.y))},e.max=function(t,n){return new e(Math.max(t.x,n.x),Math.max(t.y,n.y))},e.dist=function(e,t){var n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)},e.norm=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},e.nearest=function(t,n){for(var i,r,o=0,l=n;o<l.length;o++){var a=l[o],s=e.dist(a,t);(void 0===i||s<r)&&(r=s,i=a)}return i},e.rotate=function(t,n){var i=Math.cos(n),r=Math.sin(n);return new e(t.x*i-t.y*r,t.x*r+t.y*i)},e.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},e.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},e.prototype.mul=function(e){return this.x*=e,this.y*=e,this},e.prototype.norm=function(){return e.norm(this)},e}();t.Point=i}},[0]);