webpackJsonp([1],{0:function(e,t,n){e.exports=n("DXDq")},"0j86":function(e,t,n){"use strict";function o(e){return a.\u0275vid(0,[(e()(),a.\u0275eld(0,null,null,2,"agm-marker",[],null,[[null,"markerClick"]],function(e,t,n){var o=!0,r=e.component;if("markerClick"===t){o=!1!==r.mapClicked({coords:e.context.$implicit})&&o}return o},null,null)),a.\u0275did(1720320,null,1,s.AgmMarker,[u.MarkerManager],{latitude:[0,"latitude"],longitude:[1,"longitude"],openInfoWindow:[2,"openInfoWindow"]},{markerClick:"markerClick"}),a.\u0275qud(603979776,3,{infoWindow:1})],function(e,t){e(t,1,0,t.context.$implicit.lat,t.context.$implicit.lng,!1)},null)}function r(e){return a.\u0275vid(0,[a.\u0275qud(402653184,1,{days:0}),a.\u0275qud(402653184,2,{tripLayer:0}),(e()(),a.\u0275ted(null,["\n\n"])),(e()(),a.\u0275eld(0,null,null,53,"div",[["class","h100 flex-col"],["id","initerary"]],null,null,null,null,null)),(e()(),a.\u0275ted(null,["\n  "])),(e()(),a.\u0275eld(0,null,null,13,"header",[["class","flex-row region region-header schedule_menu_color schedule_menu_text_color"]],null,null,null,null,null)),(e()(),a.\u0275ted(null,["\n\n    "])),(e()(),a.\u0275eld(0,null,null,10,"span",[["class","title flex-auto"]],null,null,null,null,null)),(e()(),a.\u0275ted(null,["\n      "])),(e()(),a.\u0275eld(0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-map"]],null,null,null,null,null)),(e()(),a.\u0275ted(null,["\n       | "])),(e()(),a.\u0275eld(0,null,null,2,"span",[["class","backtohomepage"]],null,null,null,null,null)),(e()(),a.\u0275eld(0,null,null,1,"a",[["href","."]],null,null,null,null,null)),(e()(),a.\u0275ted(null,["",""])),(e()(),a.\u0275ted(null,[" |\n      "])),(e()(),a.\u0275eld(0,null,null,1,"span",[["class","schedule-link"]],null,[[null,"click"]],function(e,t,n){var o=!0,r=e.component;if("click"===t){o=!1!==r.fullMap()&&o}return o},null,null)),(e()(),a.\u0275ted(null,["",""])),(e()(),a.\u0275ted(null,["\n    "])),(e()(),a.\u0275ted(null,["\n  "])),(e()(),a.\u0275ted(null,["\n\n  "])),(e()(),a.\u0275eld(0,null,null,35,"div",[["class","flex-auto flex-row rotate"]],null,null,null,null,null)),(e()(),a.\u0275ted(null,["\n    "])),(e()(),a.\u0275ted(null,["\n    "])),(e()(),a.\u0275eld(0,null,null,22,"div",[["class","flex-auto relative"]],null,null,null,null,null)),(e()(),a.\u0275ted(null,["\n      "])),(e()(),a.\u0275eld(0,null,null,19,"div",[["class","abs-fill"]],null,null,null,null,null)),(e()(),a.\u0275ted(null,["\n      "])),(e()(),a.\u0275eld(0,null,null,16,"agm-map",[],[[2,"sebm-google-map-container",null]],[[null,"zoomChange"],[null,"mapClick"]],function(e,t,n){var o=!0,r=e.component;if("zoomChange"===t){o=!1!==r.zoomChanged(n)&&o}if("mapClick"===t){o=!1!==r.mapClicked(n)&&o}return o},d.View_AgmMap_0,d.RenderType_AgmMap)),a.\u0275prd(4608,null,u.MarkerManager,u.MarkerManager,[c.GoogleMapsAPIWrapper,a.NgZone]),a.\u0275prd(4608,null,f.InfoWindowManager,f.InfoWindowManager,[c.GoogleMapsAPIWrapper,a.NgZone,u.MarkerManager]),a.\u0275prd(4608,null,h.CircleManager,h.CircleManager,[c.GoogleMapsAPIWrapper,a.NgZone]),a.\u0275prd(4608,null,g.PolylineManager,g.PolylineManager,[c.GoogleMapsAPIWrapper,a.NgZone]),a.\u0275prd(4608,null,m.PolygonManager,m.PolygonManager,[c.GoogleMapsAPIWrapper,a.NgZone]),a.\u0275prd(4608,null,v.KmlLayerManager,v.KmlLayerManager,[c.GoogleMapsAPIWrapper,a.NgZone]),a.\u0275prd(4608,null,y.DataLayerManager,y.DataLayerManager,[c.GoogleMapsAPIWrapper,a.NgZone]),a.\u0275prd(512,null,c.GoogleMapsAPIWrapper,c.GoogleMapsAPIWrapper,[P.MapsAPILoader,a.NgZone]),a.\u0275did(770048,null,0,x.AgmMap,[a.ElementRef,c.GoogleMapsAPIWrapper],{longitude:[0,"longitude"],latitude:[1,"latitude"],draggableCursor:[2,"draggableCursor"]},{mapClick:"mapClick",zoomChange:"zoomChange"}),(e()(),a.\u0275ted(0,["\n        "])),(e()(),a.\u0275eld(0,null,0,1,"trip-layer",[],null,null,null,w.View_TripLayer_0,w.RenderType_TripLayer)),a.\u0275did(114688,[[2,4],["tripLayer",4]],0,b.TripLayer,[c.GoogleMapsAPIWrapper,_.Http],null,null),(e()(),a.\u0275ted(0,["\n\n        "])),(e()(),a.\u0275and(16777216,null,0,1,null,o)),a.\u0275did(802816,null,0,M.NgForOf,[a.ViewContainerRef,a.TemplateRef,a.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),a.\u0275ted(0,["\n\n      "])),(e()(),a.\u0275ted(null,["\n      "])),(e()(),a.\u0275ted(null,["\n    "])),(e()(),a.\u0275ted(null,["\n    "])),(e()(),a.\u0275eld(0,null,null,7,"div",[["class","flex-auto relative"]],null,null,null,null,null)),(e()(),a.\u0275ted(null,["\n      "])),(e()(),a.\u0275eld(0,null,null,2,"days-view",[["class","abs-fill"]],null,[[null,"selectLocation"]],function(e,t,n){var o=!0,r=e.component;if("selectLocation"===t){o=!1!==r.selectLocation(n)&&o}return o},T.View_DaysView_0,T.RenderType_DaysView)),a.\u0275prd(512,null,C.DaysService,C.DaysService,[_.Http]),a.\u0275did(638976,[[1,4],["days",4]],0,D.DaysView,[C.DaysService],{tripId:[0,"tripId"]},{selectLocation:"selectLocation"}),(e()(),a.\u0275ted(null,["\n      "])),(e()(),a.\u0275eld(0,null,null,0,"div",[["class","white-shadow"]],null,null,null,null,null)),(e()(),a.\u0275ted(null,["\n    "])),(e()(),a.\u0275ted(null,["\n  "])),(e()(),a.\u0275ted(null,["\n"])),(e()(),a.\u0275ted(null,["\n"]))],function(e,t){var n=t.component;e(t,36,0,n.longitude,n.latitude,"auto"),e(t,39,0),e(t,42,0,n.markers),e(t,51,0,n.tripId)},function(e,t){var n=t.component;e(t,13,0,n.T("back")),e(t,16,0,n.T("schedule"));e(t,27,0,!0)})}function i(e){return a.\u0275vid(0,[(e()(),a.\u0275eld(0,null,null,1,"test-app",[],null,null,null,r,t.RenderType_TestApp)),a.\u0275did(49152,null,0,p.TestApp,[],null,null)],null,null)}Object.defineProperty(t,"__esModule",{value:!0});var l=n("uTZG"),a=n("/oeL"),s=n("57RD"),u=n("dY6p"),p=n("i+6n"),d=n("SDf9"),c=n("BfPg"),f=n("KdOF"),h=n("DCX4"),g=n("Ds4W"),m=n("9fk+"),v=n("mECe"),y=n("7PDj"),P=n("wW3n"),x=n("t+Rn"),w=n("o3eO"),b=n("VY9+"),_=n("CPp0"),M=n("qbdv"),T=n("rDkg"),C=n("yJCl"),D=n("xHFf"),L=[l.styles];t.RenderType_TestApp=a.\u0275crt({encapsulation:0,styles:L,data:{}}),t.View_TestApp_0=r,t.View_TestApp_Host_0=i,t.TestAppNgFactory=a.\u0275ccf("test-app",p.TestApp,i,{tripId:"tripId"},{},[])},DXDq:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("/oeL"),r=(n("OKwi"),n("hCN4")),i=n("fc+i");o.enableProdMode(),i.platformBrowser().bootstrapModuleFactory(r.AppModuleNgFactory)},"E+5d":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("x88H"),r=function(){function e(e){e&&(e.min&&(this.min=new o.Point(e.min)),e.max&&(this.max=new o.Point(e.max)))}return e.closestPoint=function(e,t){var n=new o.Point(0,0);for(var r in n)e[r]<t.min[r]?n[r]=t.min[r]:e[r]>t.max[r]?n[r]=t.max[r]:n[r]=e[r];return n},e.overlaps=function(e,t){return!(e.max.x<t.min.x||e.min.x>t.max.x||e.max.y<t.min.y||e.min.y>t.max.y)},e.contains=function(e,t){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y},e.prototype.addPoint=function(e){this.min=void 0===this.min?e:o.Point.min(this.min,e),this.max=void 0===this.max?e:o.Point.max(this.max,e)},e.prototype.addArray=function(e){for(var t=0,n=e;t<n.length;t++){var o=n[t];this.addPoint(o)}},e.prototype.overlaps=function(t){return e.overlaps(this,t)},e.prototype.contains=function(t){return e.contains(this,t)},e}();t.BoundingBox=r},Nf9t:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e}();t.AppModule=o},Nh04:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("x88H"),r=function(){function e(t){if(this.properties={},t){if(t.controlPoints){this.controlPoints=[];for(var n=0;n<t.controlPoints.length;++n)this.controlPoints[n]=new o.Point(t.controlPoints[n])}t.originalEdge&&(this.originalEdge=new e(t.originalEdge));for(var r=0,i=["from","to","drawMiddlePoint","properties","fromDbId"];r<i.length;r++){var l=i[r];l in t&&(this[l]=t[l])}}}return e.prototype.propagateToOriginal=function(){if(this.originalEdge)for(var e=0,t=["controlPoints","drawMiddlePoint"];e<t.length;e++){var n=t[e];n in this&&(this.originalEdge[n]=this[n])}},e}();t.TripEdge=r},OKwi:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.environment={production:!1}},Rp1X:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("x88H"),r=n("E+5d"),i=n("ZKuw"),l=function(){function e(e,t){var n=e||{};this.nodes=n.node||{},this.edges=n.edges||[],this.defaultEdgeProp=t}return e.generateControlPoints=function(e,t,n,r){var i=o.Point.minus(n,t).mul(1/3),l=new o.Point(-i.y,i.x);return[o.Point.plus(o.Point.plus(t,i),l),o.Point.plus(o.Point.minus(n,i),l)]},e.bezierFromPoints=function(e){for(var t=[],n=0;n<4;++n)t.push(e[n].x),t.push(e[n].y);return new Bezier(t)},e.bezierThroughPoints=function(t){for(var n=[],r=1;r<t.length;++r){var i=1===r?t[r-1]:t[r-2],l=t[r-1],a=t[r],s=r===t.length-1?t[r]:t[r+1];n.push(e.bezierFromPoints([l,o.Point.plus(l,o.Point.times(.2,o.Point.minus(a,i))),o.Point.plus(a,o.Point.times(.2,o.Point.minus(l,s))),a]))}return n},e.placeLeaderLine=function(e){e.properties||(e.properties={});var t,n=e.properties.leaderLine||"bestAnchor",i=e.properties.labelBbox;if("center"===n){var l=(i.max.x,i.min.x,new o.Point((i.min.x+i.max.x)/2,(i.min.y+i.max.y)/2)),a=o.Point.minus(e.coord,l);a.mul(.02),t=o.Point.plus(l,a)}else t="closestOnBbox"===n?r.BoundingBox.closestPoint(e.coord,i):d3.labeler.closestLineAnchorPoint(e.coord,{left:i.min.x,right:i.max.x,top:i.min.y,bottom:i.max.y,cx:(i.min.x+i.max.x)/2,cy:(i.min.y+i.max.y)/2});e.properties.leaderLineAnchor=t},e.prototype.createDefaultBezier=function(){for(var t in this.edges){var n=this.edges[t],o=this.nodes[n.from],r=this.nodes[n.to];n.controlPoints=e.generateControlPoints(void 0,o.coord,r.coord,void 0)}},e.prototype.edgeProperty=function(e,t){return e.properties[t]||this.defaultEdgeProp[t]},e.prototype.getEdgeRoute=function(e){if("route"==this.edgeProperty(e,"geom")&&e.properties&&e.properties.route&&e.properties.route.geom&&this.edgeProperty(e,"travelMean")==e.properties.route.mean)return e.properties.route},e.prototype.bezier=function(t){if(!t.controlPoints||t.properties.hidden)return[];if("straight"==this.edgeProperty(t,"geom"))return e.bezierThroughPoints([this.nodes[t.from].coord,this.nodes[t.to].coord]);if(2===t.controlPoints.length){var n=[this.nodes[t.from].coord,t.controlPoints[0],t.controlPoints[1],this.nodes[t.to].coord];return[e.bezierFromPoints(n)]}if(5===t.controlPoints.length){var o=[this.nodes[t.from].coord,t.controlPoints[0],t.controlPoints[1],t.controlPoints[2]],r=[t.controlPoints[2],t.controlPoints[3],t.controlPoints[4],this.nodes[t.to].coord];return[e.bezierFromPoints(o),e.bezierFromPoints(r)]}var i=[this.nodes[t.from].coord].concat(t.controlPoints,[this.nodes[t.to].coord]);return e.bezierThroughPoints(i)},e.prototype.bounds=function(){var e=new r.BoundingBox;for(var t in this.nodes)this.nodes[t].properties.skip||e.addPoint(this.nodes[t].coord);return e},e.prototype.frame=function(e,t){var n=this.bounds();if(t=t||1.1,n.max&&n.min){if(n.min.x===n.max.x){var i=new o.Point(1/32,1/32);n.addPoint(o.Point.plus(n.min,i)),n.addPoint(o.Point.minus(n.min,i))}}else n.min=new o.Point(0,0),n.max=new o.Point(1,1),t=1;e=e||(n.max.x-n.min.x)/(n.max.y-n.min.y);var l="number"==typeof t?new o.Point(t,t):t,a=o.Point.minus(n.max,n.min);a.x*=l.x,a.y*=l.y;var s,u=a.y*e;s=a.x>u?new o.Point(a.x,a.x/e):new o.Point(a.y*e,a.y),s.mul(.5);var p=o.Point.times(.5,o.Point.plus(n.max,n.min)),d=new r.BoundingBox;return d.addPoint(o.Point.minus(p,s)),d.addPoint(o.Point.plus(p,s)),d},e.prototype.location=function(e,t){var n=this.frame(e,t);n.max.x,n.min.x;return{x:(n.max.x+n.min.x)/2,y:(n.max.y+n.min.y)/2,scale:Math.max(1/32768,n.max.x-n.min.x)}},e.prototype.compareNodes=function(e){var t=function(e,t){for(var n in e)if(!(n in t))return!1;return!0};return t(this.nodes,e.nodes)&&t(e.nodes,this.nodes)},e.prototype.getEdgeDirections=function(e,t){var n=Utils.worldToLatLon(this.nodes[e.from].coord),r=Utils.worldToLatLon(this.nodes[e.to].coord);return i.getDirections(n,r,t).then(function(e){var n=e.map(function(e){return new o.Point(Utils.latLonToWorld(e))});return{mean:t,geom:n,midpoint:i.midPoint(n)}})},e}();t.TripGraph=l},"VY9+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("CPp0"),r=n("bAF1"),i=n("cWpu"),l=function(){function e(e,t){this.gmap=e,this.http=t}return e.prototype.ngOnInit=function(){var e=this;this.overlay=new i.CanvasOverlay,this.gmap.getNativeMap().then(function(t){e.overlay.setMap(t)}),this.gmap.subscribeToMapEvent("center_changed").subscribe(function(){e.overlay.refresh()}),console.log("Fetching "+currentTripmapUrl),$.getJSON(currentTripmapUrl,function(t){e.overlay.setTrip(t)})},e.prototype.focusOnPoint=function(e){this.overlay.focusOnPoint(e)},e.prototype.setZoom=function(e){this.overlay.setZoom(e)},e.ctorParameters=function(){return[{type:r.GoogleMapsAPIWrapper},{type:o.Http}]},e}();t.TripLayer=l},ZKuw:function(e,t,n){"use strict";function o(e){switch(e){case"Car":return"driving-car";case"Bus":return"driving-hgv";case"Bike":return"cycling-regular";case"Walk":return"foot-walking";default:return}}function r(e,t,n){var r=o(n);if(!r)return Promise.reject("Transportation mean unsupported: "+n);var i=["https://api.openrouteservice.org/directions?api_key=5b3ce3597851110001cf6248e0fee72951d5494c8b4cf5d8b4ff2b76","coordinates="+e.lon+"%2C"+e.lat+"|"+t.lon+"%2C"+t.lat,"profile="+r,"geometry_format=geojson","geometry_simplify=true"].join("&");return i in a?a[i]:(a[i]=new Promise(function(e,t){$.getJSON(i).done(function(n){n&&n.routes&&n.routes[0]&&n.routes[0].geometry&&n.routes[0].geometry.coordinates?e(n.routes[0].geometry.coordinates):t(new Error("Empty or bad data from openrouteservice"))}).fail(function(e){"object"==typeof e&&"number"==typeof e.status&&e.status>=400&&e.status<500&&t(e),t(e)})}),a[i])}function i(e){for(var t=0,n=[0],o=1;o<e.length;++o){t+=l.Point.dist(e[o],e[o-1]),n.push(t)}for(var r=t/2,o=0;o<n.length;++o)if(n[o]>r)return o-1;return 0}Object.defineProperty(t,"__esModule",{value:!0});var l=n("x88H"),a={};t.getDirections=r,t.midPoint=i},agHN:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.styles=["div.progview[_ngcontent-%COMP%]{background-color:#eee;overflow:auto;height:100%}.progview[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding:5px}.progview[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style-type:none;position:relative;left:0;background-color:#fff}.dayEntryUl[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:first-child   header[_ngcontent-%COMP%]{border-top:0;padding-top:0}.progview[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .clickable[_ngcontent-%COMP%]:hover{background-color:#72b866}li[_ngcontent-%COMP%]   .clickable[_ngcontent-%COMP%]{color:#fff;padding:6px 12px;font-size:14px;border-radius:12px;margin:3px 3px 9px;cursor:pointer;font-weight:700}.locations[_ngcontent-%COMP%], li[_ngcontent-%COMP%]   .clickable[_ngcontent-%COMP%]{display:inline-block}header[_ngcontent-%COMP%]{position:relative;padding-top:40px}.date[_ngcontent-%COMP%]{float:right}.date[_ngcontent-%COMP%], .day[_ngcontent-%COMP%]{font-size:18px}.day[_ngcontent-%COMP%]{border-bottom:1px solid}.dayTitle[_ngcontent-%COMP%]{font-size:18px;font-weight:800;margin:10px 0 10px 0}.daySubTitle[_ngcontent-%COMP%]{font-size:18px;font-weight:300;padding:0 0 10px;color:#949494}.eventDescription[_ngcontent-%COMP%], .eventIndication[_ngcontent-%COMP%], .eventTitle[_ngcontent-%COMP%]{font-size:16px}.eventIndication[_ngcontent-%COMP%], .eventTitle[_ngcontent-%COMP%]{font-weight:600}.eventSubTitle[_ngcontent-%COMP%]{padding-bottom:5px;font-weight:300;color:#949494}.eventDescription[_ngcontent-%COMP%]{margin-top:10px}ul[_ngcontent-%COMP%]   .locations[_ngcontent-%COMP%]{padding:0}.thumbnail-schedule[_ngcontent-%COMP%]{padding:0 10px 10px 0}"]},cHmR:function(e,t){function n(e){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+e+"'.")})}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="cHmR"},cWpu:function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n("x88H"),i=n("v0bJ"),l=n("Rp1X"),a=n("owx+"),s=n("dggI"),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inDraw=!1,t.refreshTimeout=void 0,t}return o(t,e),t.prototype.onAdd=function(){this.canvas||(this.canvas=document.createElement("canvas"));var e=this.canvas;e.style.border="none",e.style.borderWidth="0px",e.style.position="absolute",e.style.top="0 px",e.style.left="0 px",this.canvas=e,this.getPanes().mapPane.appendChild(this.canvas)},t.prototype.setTrip=function(e){this.canvas||(this.canvas=document.createElement("canvas"));var t=new i.SeqTrip;try{t.load(e)}catch(e){return console.log(e),void console.log(e.stack)}this.trip=t,this.initialLocation=this.trip.location();this.renderer=new s.T.CanvasTilesRenderer({canvas:this.canvas,noInteraction:!0,clearBorder:!1});this.graph=new l.TripGraph(void 0,t.defaultTextProp());this.tripLayer=new a.TripGraphLayer({renderer:this.renderer,graph:this.graph,defaultEdgeProp:t.defaultEdgeProp(),hideLabels:!0}),this.canvas;this.renderer.layers=[],this.renderer.addLayer(this.tripLayer),this.focusOnPoint(),this.draw()},t.prototype.draw=function(){var e=this;if(this.renderer){var t=this.getProjection();if(t){this.inDraw=!0;try{var n=this.getMap(),o=n.getDiv();if(!o)return;var r={x:o.clientWidth,y:o.clientHeight},i={x:0,y:0},l=t.fromContainerPixelToLatLng(i,!0),a=t.fromContainerPixelToLatLng(r,!0),s=l.lng(),u=a.lng();s>u&&(s-=360);var p=u-s,d=r.x-i.x,c=d/p,f={x:r.x/2,y:r.y/2},h=t.fromContainerPixelToLatLng(f),g=t.fromLatLngToDivPixel(h),m=this.canvas;m.style.left=g.x-f.x+"px",m.style.top=g.y-f.y+"px";var v=d,y=r.y-i.y,P=this.renderer.pixelRatio;m.width=v*P,m.height=y*P,m.style.width=v+"px",m.style.height=y+"px",this.tripLayer.graph=this.graph=this.trip.makeGraph(this.tripLayer),this.tripLayer.loadIcons(function(t){t&&console.log(t),e.refresh()});var x=m.getContext("2d");this.renderer.inDraw=!0,x.clearRect(0,0,m.width,m.height);for(var w=s;w<u;){var b=Math.min(a.lng(),360*Math.floor((w+180)/360)+180),_=(w+180+3600)%360-180,M=(b+180+3600)%360-180;M<_&&(M+=360);var T=Utils.latLonToWorld([_,l.lat()]),C=Utils.latLonToWorld([M,a.lat()]);C.x<T.x&&(C.x+=1);var D={x:(i.x+(w-s)*c)*P,y:i.y*P},L={x:(i.x+(b-s)*c)*P,y:r.y*P},O=[{viewer:D,world:T},{viewer:L,world:C}],I=this.renderer.pinchZoom;I.ignoreLimits=!0,I.processConstraints(O),this.renderer.inDraw=!1,this.renderer.draw(),this.renderer.inDraw=!0,w=b}}catch(e){console.log(e),console.log(e.stack)}this.inDraw=!1}}},t.prototype.onRemove=function(){this.redrawInterval&&clearInterval(this.redrawInterval),this.canvas&&(this.canvas.parentNode.removeChild(this.canvas),this.canvas=void 0)},t.prototype.refresh=function(){var e=this;this.inDraw||(this.refreshTimeout&&clearTimeout(this.refreshTimeout),this.refreshTimeout=setTimeout(function(){e.draw()},100))},t.prototype.bounds=function(){var e=this.graph.bounds(),t=Utils.worldToLatLon(e.min),n=Utils.worldToLatLon(e.max);return{north:t.lat,south:n.lat,east:n.lon,west:t.lon}},t.prototype.focusOnPoint=function(e){var t=this.initialLocation,n=this.trip.width_mm()/this.trip.height_mm(),o=e?Utils.latLonToWorld([e.lng,e.lat]):t,i=t.scale*(e?.25:.5),l=i/n,a=Utils.worldToLatLon(new r.Point(o.x-i,o.y-l)),s=Utils.worldToLatLon(new r.Point(o.x+i,o.y+l)),u={north:a.lat,south:s.lat,east:s.lon,west:a.lon};this.getMap().fitBounds(u)},t.prototype.setZoom=function(e){this.getMap().setZoom(e)},t}(google.maps.OverlayView);t.CanvasOverlay=u},dggI:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.T={CanvasTilesRenderer:CanvasTilesRenderer,PinchZoom:PinchZoom,Utils:Utils}},hCN4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("/oeL"),r=n("Nf9t"),i=n("i+6n"),l=n("0j86"),a=n("qbdv"),s=n("fc+i"),u=n("CPp0"),p=n("niyx"),d=n("wW3n"),c=n("/Pdz"),f=n("yJCl"),h=n("q+Vp");t.AppModuleNgFactory=o.\u0275cmf(r.AppModule,[i.TestApp],function(e){return o.\u0275mod([o.\u0275mpd(512,o.ComponentFactoryResolver,o.\u0275CodegenComponentFactoryResolver,[[8,[l.TestAppNgFactory]],[3,o.ComponentFactoryResolver],o.NgModuleRef]),o.\u0275mpd(5120,o.LOCALE_ID,o.\u0275m,[[3,o.LOCALE_ID]]),o.\u0275mpd(4608,a.NgLocalization,a.NgLocaleLocalization,[o.LOCALE_ID]),o.\u0275mpd(4608,o.Compiler,o.Compiler,[]),o.\u0275mpd(5120,o.APP_ID,o.\u0275f,[]),o.\u0275mpd(5120,o.IterableDiffers,o.\u0275k,[]),o.\u0275mpd(5120,o.KeyValueDiffers,o.\u0275l,[]),o.\u0275mpd(4608,s.DomSanitizer,s.\u0275e,[a.DOCUMENT]),o.\u0275mpd(6144,o.Sanitizer,null,[s.DomSanitizer]),o.\u0275mpd(4608,s.HAMMER_GESTURE_CONFIG,s.HammerGestureConfig,[]),o.\u0275mpd(5120,s.EVENT_MANAGER_PLUGINS,function(e,t,n,o){return[new s.\u0275DomEventsPlugin(e),new s.\u0275KeyEventsPlugin(t),new s.\u0275HammerGesturesPlugin(n,o)]},[a.DOCUMENT,a.DOCUMENT,a.DOCUMENT,s.HAMMER_GESTURE_CONFIG]),o.\u0275mpd(4608,s.EventManager,s.EventManager,[s.EVENT_MANAGER_PLUGINS,o.NgZone]),o.\u0275mpd(135680,s.\u0275DomSharedStylesHost,s.\u0275DomSharedStylesHost,[a.DOCUMENT]),o.\u0275mpd(4608,s.\u0275DomRendererFactory2,s.\u0275DomRendererFactory2,[s.EventManager,s.\u0275DomSharedStylesHost]),o.\u0275mpd(6144,o.RendererFactory2,null,[s.\u0275DomRendererFactory2]),o.\u0275mpd(6144,s.\u0275SharedStylesHost,null,[s.\u0275DomSharedStylesHost]),o.\u0275mpd(4608,o.Testability,o.Testability,[o.NgZone]),o.\u0275mpd(4608,s.Meta,s.Meta,[a.DOCUMENT]),o.\u0275mpd(4608,s.Title,s.Title,[a.DOCUMENT]),o.\u0275mpd(4608,u.BrowserXhr,u.BrowserXhr,[]),o.\u0275mpd(4608,u.ResponseOptions,u.BaseResponseOptions,[]),o.\u0275mpd(5120,u.XSRFStrategy,u.\u0275b,[]),o.\u0275mpd(4608,u.XHRBackend,u.XHRBackend,[u.BrowserXhr,u.ResponseOptions,u.XSRFStrategy]),o.\u0275mpd(4608,u.RequestOptions,u.BaseRequestOptions,[]),o.\u0275mpd(5120,u.Http,u.\u0275c,[u.XHRBackend,u.RequestOptions]),o.\u0275mpd(4608,p.WindowRef,p.WindowRef,[]),o.\u0275mpd(4608,p.DocumentRef,p.DocumentRef,[]),o.\u0275mpd(4608,d.MapsAPILoader,c.NoOpMapsAPILoader,[]),o.\u0275mpd(4608,f.DaysService,f.DaysService,[u.Http]),o.\u0275mpd(512,a.CommonModule,a.CommonModule,[]),o.\u0275mpd(1024,o.ErrorHandler,s.\u0275a,[]),o.\u0275mpd(1024,o.APP_INITIALIZER,function(e,t){return[s.\u0275c(e,t)]},[[2,s.NgProbeToken],[2,o.NgProbeToken]]),o.\u0275mpd(512,o.ApplicationInitStatus,o.ApplicationInitStatus,[[2,o.APP_INITIALIZER]]),o.\u0275mpd(131584,o.\u0275e,o.\u0275e,[o.NgZone,o.\u0275Console,o.Injector,o.ErrorHandler,o.ComponentFactoryResolver,o.ApplicationInitStatus]),o.\u0275mpd(2048,o.ApplicationRef,null,[o.\u0275e]),o.\u0275mpd(512,o.ApplicationModule,o.ApplicationModule,[o.ApplicationRef]),o.\u0275mpd(512,s.BrowserModule,s.BrowserModule,[[3,s.BrowserModule]]),o.\u0275mpd(512,u.HttpModule,u.HttpModule,[]),o.\u0275mpd(512,h.AgmCoreModule,h.AgmCoreModule,[]),o.\u0275mpd(512,r.AppModule,r.AppModule,[])])})},"i+6n":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){this.location="",this.markers=[],this.tripId=currentTripId,this.translations=translations,console.log("TRIP ID: "+this.tripId)}return e.prototype.selectLocation=function(e){this.location=e.name,this.latitude=e.latitude,this.longitude=e.longitude;var t={lat:this.latitude,lng:this.longitude};this.markers=[t],this.tripLayer&&this.tripLayer.focusOnPoint(t)},e.prototype.zoomChanged=function(e){this.zoom=e,e<2&&this.tripLayer.setZoom(2)},e.prototype.mapClicked=function(e){this.days&&(this.days.scrollTo(e.coords),this.markers=[])},e.prototype.fullMap=function(){this.tripLayer.focusOnPoint(),this.markers=[]},e.prototype.T=function(e){for(var t=e.split("."),n=translations;t.length>0;){var o=t[0];if(!n[o])return console.log("Missing translation: "+e),e;n=n[o],t=t.slice(1)}return"object"==typeof n?(console.log("invalid translation key: "+e),e):n},e.ctorParameters=function(){return[]},e}();t.TestApp=o},o3eO:function(e,t,n){"use strict";function o(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,0,"div",[],null,null,null,null,null))],null,null)}function r(e){return i.\u0275vid(0,[(e()(),i.\u0275eld(0,null,null,1,"trip-layer",[],null,null,null,o,t.RenderType_TripLayer)),i.\u0275did(114688,null,0,l.TripLayer,[a.GoogleMapsAPIWrapper,s.Http],null,null)],function(e,t){e(t,1,0)},null)}Object.defineProperty(t,"__esModule",{value:!0});var i=n("/oeL"),l=n("VY9+"),a=n("BfPg"),s=n("CPp0"),u=[];t.RenderType_TripLayer=i.\u0275crt({encapsulation:2,styles:u,data:{}}),t.View_TripLayer_0=o,t.View_TripLayer_Host_0=r,t.TripLayerNgFactory=i.\u0275ccf("trip-layer",l.TripLayer,r,{},{},[])},"owx+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("Rp1X"),r=n("E+5d"),i=n("x88H"),l=function(){function e(e){if(this.params=e,this.renderer=e.renderer,this.defaultRadius=e.defaultRadius||6,this.icons={},this.defaultTextProp={fontSize:e.defaultFontSize||20,stroke:"rgba(255,255,255,.8)",fill:"#000000"},this.defaultEdgeProp=e.defaultEdgeProp||{lineWidth:1,lineColor:"#000000"},this.hideLabels=!!e.hideLabels,!this.renderer)throw new Error("TripGraphLayer: no renderer !");this.graph=e.graph||new o.TripGraph(void 0,this.defaultEdgeProp)}return e.prototype.draw=function(e,t,n,o){for(var r=this.graph,i=e.getContext("2d"),l=this.renderer.pixelRatio,a=0,s=r.edges;a<s.length;a++){var u=s[a];this.drawEdge(i,t,u,l,"curve")}for(var p=0,d=r.edges;p<d.length;p++){var u=d[p];this.drawEdge(i,t,u,l,"mark")}i.setLineDash([]);for(var c in r.nodes){var f=r.nodes[c];f.viewerPos=t.viewerPosFromWorldPos(f.coord)}for(var c in r.nodes){var f=r.nodes[c];this.drawNodePoint(i,t,f)}for(var c in r.nodes)if(!this.hideLabels||c.match(/-(takeoff)|(landing)$/)){var f=r.nodes[c];this.drawLeaderLine(i,t,f)}for(var c in r.nodes)if(!this.hideLabels||c.match(/-(takeoff)|(landing)$/)){var f=r.nodes[c];this.drawNodeLabel(i,t,f)}},e.prototype.drawEdge=function(e,t,n,o,r){this.setEdgeStrokeStyle(e,n),"route"==this.edgeProperty(n,"geom")?this.drawRoad(e,t,n,o,r):this.drawEdgeBezier(e,t,n,o,r)},e.prototype.drawRoad=function(e,t,n,o,r){var l=this,a=(this.edgeProperty(n,"travelMean"),this.graph.getEdgeRoute(n));if("curve"==r)if(a){var s=n.properties.route.geom;e.beginPath();var u=t.viewerPosFromWorldPos(s[0]);e.moveTo(u.x,u.y);for(var p=1;p<s.length;++p){var d=t.viewerPosFromWorldPos(s[p]);e.lineTo(d.x,d.y)}e.stroke()}else n.properties||(n.properties={}),this.graph.getEdgeDirections(n,this.edgeProperty(n,"travelMean")).then(function(e){n.properties.route=e,l.renderer.refresh()}).catch(function(e){console.log(e),n.properties.geom="straight",l.renderer.refresh()});else if("mark"==r&&a&&a.midpoint){var u=new i.Point(t.viewerPosFromWorldPos(a.geom[0])),c=new i.Point(t.viewerPosFromWorldPos(a.geom[a.geom.length-1]));if(i.Point.dist(c,u)>80*o){for(var f=a.midpoint,h=16*o,g=new i.Point(t.viewerPosFromWorldPos(a.geom[f])),m=void 0,p=f;p<a.geom.length;++p){var v=new i.Point(t.viewerPosFromWorldPos(a.geom[p])),y=i.Point.dist(g,v);if(y>h){m=i.Point.minus(v,g);break}}if(!m)return;var P=new i.Point(m.y,-m.x);this.drawEdgeMark(i.Point.plus(g,i.Point.times(8*o/m.norm(),m)),P,m,e,o,n,r)}}},e.prototype.drawEdgeBezier=function(e,t,n,o,r){for(var i=this.graph.bezier(n),l=0,a=i;l<a.length;l++){var s=a[l];this.drawBezier(e,t,s,o,n,r)}if("mark"!=r&&i.length>1&&n.drawMiddlePoint)for(var u in i){var p=t.viewerPosFromWorldPos(i[u].points[3]),d=5*o;e.beginPath(),e.arc(p.x,p.y,d,0,2*Math.PI,!1),e.fillStyle="#000000",e.fill()}},e.prototype.drawBezier=function(e,t,n,o,r,l){e.save();for(var a=new Array(8),s=n.points,u=0;u<4;++u){var p=t.viewerPosFromWorldPos(s[u]);a[2*u]=p.x,a[2*u+1]=p.y}var d=new Bezier(a),c=d.length(),f=Math.min(2,Math.floor(c/(40*o))),h=d.points;"mark"!=l&&(e.beginPath(),e.moveTo(h[0].x,h[0].y),e.bezierCurveTo(h[1].x,h[1].y,h[2].x,h[2].y,h[3].x,h[3].y),e.stroke());for(var g=1;g<f;++g){var m=g/f,p=new i.Point(d.get(m)),v=new i.Point(d.normal(m)),y=new i.Point(d.derivative(m));this.drawEdgeMark(p,v,y,e,o,r,l)}e.restore()},e.prototype.drawEdgeMark=function(t,n,o,r,i,l,a){switch(this.edgeProperty(l,"travelMean")){case"Bike":case"Boat":case"Bus":case"Car":case"Helicopter":case"Plane":case"Train":case"Walk":"curve"!=a&&this.drawEdgeMarkIcon(t,n,o,r,i,l);break;case"Unspecified":default:"mark"!=a&&e.drawEdgeMarkTriangle(t,n,o,r,i)}},e.drawEdgeMarkTriangle=function(e,t,n,o,r){var l=10*r;n.mul(l/n.norm()),e=i.Point.plus(e,i.Point.times(.5,n));var a=i.Point.minus(e,n);o.beginPath(),o.moveTo(a.x+l/2*t.x,a.y+l/2*t.y),o.lineTo(e.x,e.y),o.lineTo(a.x-l/2*t.x,a.y-l/2*t.y),o.closePath(),o.fill()},e.prototype.drawEdgeMarkIcon=function(e,t,n,o,r,l){o.fillStyle="#fff",o.setLineDash([]),o.lineWidth=1*r;var a=10*r,s=6*r;n=n.mul(1/n.norm());var u=i.Point.plus(e,i.Point.times((a+s)/2,n)),p=i.Point.minus(e,i.Point.times((a+s)/2,n)),d=i.Point.plus(p,i.Point.times(a,n)),c=new i.Point(-n.y,n.x).mul(4*r),f=i.Point.plus(d,c),h=i.Point.minus(d,c),g=i.Point.minus(f,p),m=Math.atan2(g.y,g.x),v=i.Point.minus(h,p),y=Math.atan2(v.y,v.x);o.beginPath(),o.arc(p.x,p.y,a,m,y),o.lineTo(u.x,u.y),o.closePath(),o.fill(),o.stroke(),o.fillStyle="#000",o.textAlign="center",o.textBaseline="middle",o.font=Math.round(10*r)+"px FontAwesome";var P={Bike:"\uf206",Boat:"\uf21a",Bus:"\uf207",Car:"\uf1b9",Helicopter:"H",Plane:"\uf072",Train:"\uf238",Walk:"\uf183"},x=this.edgeProperty(l,"travelMean");"Plane"==x&&(o.save(),o.translate(p.x,p.y),o.rotate(Math.PI/4+Math.atan2(n.y,n.x)),o.translate(-p.x,-p.y)),o.fillText(P[x],p.x,p.y),"Plane"==x&&o.restore()},e.prototype.edgeProperty=function(e,t){return e.properties[t]||this.defaultEdgeProp[t]},e.prototype.setEdgeStrokeStyle=function(e,t){var n=this.edgeProperty(t,"lineColor");e.strokeStyle=n,e.fillStyle=n,e.lineWidth=this.renderer.pixelRatio*this.edgeProperty(t,"lineWidth"),this.setDashStyle(e,this.edgeProperty(t,"dashed"))},e.prototype.nodeRadius=function(e){var t=this.defaultRadius;return e.properties&&e.properties.radius&&(t=e.properties.radius),t*this.renderer.pixelRatio},e.prototype.drawNodePoint=function(e,t,n){if(!n.properties||0!=n.properties.point){var o=n.viewerPos;this.drawPoint(e,o,this.renderer.pixelRatio,n.properties||{})}},e.prototype.drawNodeLabel=function(t,n,o){var r=this;if(o.label||o.labelIcon){var l=n.viewerPosFromWorldPos(o.properties&&o.properties.labelCoord?o.properties.labelCoord:o.coord);if(o.label&&e.drawText(t,o.label,l,this.renderer.pixelRatio,o.properties||{},this.defaultTextProp),o.labelIcon)if(o.labelIcon.url in this.icons){if(void 0!=o.labelIcon.autorotate&&o.properties.labelCoord){var a=new i.Point(o.coord);o.labelIcon.angle=o.labelIcon.autorotate+Math.atan2(a.y-o.properties.labelCoord.y,a.x-o.properties.labelCoord.x)}e.drawIcon(t,this.icons[o.labelIcon.url],o.labelIcon,l,this.renderer.pixelRatio)}else this.loadIcons(function(){return r.renderer.refresh()});if(o.properties&&o.properties.frame&&o.label){var s=e.measureText(t,o.label,this.renderer.pixelRatio,o.properties||{},this.defaultTextProp);t.strokeStyle=o.properties.frame,s.width+=3*this.renderer.pixelRatio,s.height+=3*this.renderer.pixelRatio,t.rect(l.x-s.width/2,l.y-s.height/2,s.width,s.height),t.stroke()}}},e.prototype.setDashStyle=function(e,t){var n=[];if(t)for(var o=0,r=t;o<r.length;o++){var i=r[o];n.push(this.renderer.pixelRatio*i)}e.setLineDash(n)},e.prototype.drawLeaderLine=function(e,t,n){if(n.properties&&n.properties.leaderLineAnchor){var o=this.renderer.pixelRatio,l=t.viewerPosFromWorldPos(n.properties.leaderLineAnchor);e.lineWidth=(n.properties.leaderLineWidth||1)*o,e.beginPath();var a=t.viewerPosFromWorldPos(n.coord),s=this.nodeRadius(n),u=t.viewerPosFromWorldPos(r.BoundingBox.closestPoint(new i.Point(n.coord),n.properties.labelBbox)),p=n.properties&&void 0!==n.properties.maxLeaderLineLength?n.properties.maxLeaderLineLength*o:3*s;i.Point.dist(u,a)>p&&(n.properties.dashed&&this.setDashStyle(e,n.properties.dashed),e.moveTo(l.x,l.y),e.lineTo(a.x,a.y),e.strokeStyle=n.properties.leaderLineColor||"#000000",e.stroke(),n.properties.dashed&&e.setLineDash([]))}},e.prototype.drawPoint=function(e,t,n,o){e.strokeStyle="rgba(0,0,0,1)",e.fillStyle="rgba(255,255,255,1)",e.lineWidth=2*n,e.beginPath();var r=(o.radius||this.defaultRadius)*n;e.arc(t.x,t.y,r,0,2*Math.PI,!1),e.stroke(),e.fill();var i=o.markStyle;!i&&o.firstVisited&&(i="first"),"first"===i&&(e.fillStyle="rgba(0, 0, 0, 1)",e.beginPath(),e.arc(t.x,t.y,.6*r,0,2*Math.PI,!1),e.fill())},e.measureText=function(t,n,o,r,i){var l=n.split("\n"),a=e.setTextStyle(t,o,r,i),s={width:0,height:a*l.length};for(var u in l)s.width=Math.max(s.width,t.measureText(l[u]).width);return s},e.setTextStyle=function(e,t,n,o){n=n||{};var r=n.fontSize||o.fontSize;return r*=t,e.font=r+"px "+(n.font||"'PT Sans', sans-serif"),e.strokeStyle=n.stroke||o.stroke,e.lineWidth=(n.haloWidth||4)*t,e.fillStyle=n.fill||o.fill,parseInt(""+r)},e.drawText=function(t,n,o,r,i,l){var a,s,u=(void 0!=i.textOffset?i.textOffset:20)*r,p=((i.textPlacement||"S")+"").toUpperCase();switch(p){default:case"C":case"N":case"S":t.textAlign="center",a=0;break;case"E":case"NE":t.textAlign="start",a=u;break;case"O":case"W":t.textAlign="end",a=-u}switch(p){case"C":case"E":case"W":case"O":t.textBaseline="middle",s=0;break;case"N":case"NE":t.textBaseline="bottom",s=-u;break;default:case"S":t.textBaseline="top",s=u}var d=o.x+a,c=o.y+s,f=e.setTextStyle(t,r,i,l),h=n.split("\n");t.shadowBlur=3*r,t.shadowColor="#ffffff",t.lineWidth=2*r;for(var g=(h.length-1)/2,m=0;m<h.length;++m){var v=c+(m-g)*f;t.strokeText(h[m],d,v),t.fillText(h[m],d,v)}t.shadowColor="transparent"},e.drawIcon=function(e,t,n,o,r){if(t){var i=n.width?n.width*r:16*r,l=n.height?n.height*r:i,a="ratioX"in n?n.ratioX:.5,s="ratioY"in n?n.ratioY:.5,u=i*a,p=l*s;n.angle?(e.save(),e.translate(o.x,o.y),e.rotate(n.angle),e.drawImage(t,-u,-p,i,l),e.restore()):e.drawImage(t,o.x-u,o.y-p,i,l)}},e.prototype.getLabelIconSize=function(e,t){var n=this.renderer.pixelRatio,o=t.labelIcon;return{width:(o.width||16)*n,height:(o.height||o.width||16)*n}},e.prototype.computeNodeSizeWithMargin=function(t,n){var o;if(n.label){var r=this.renderer.pixelRatio;o=e.measureText(t,n.label,r,n.properties,this.defaultTextProp)}else n.labelIcon&&(o=this.getLabelIconSize(t,n),o.width*=1.4,o.height*=1.4);if(!o)throw"no label and no labIcon for node";var i=2*this.renderer.pixelRatio;return o.width+=2*i,o.height+=2*i,o},e.prototype.setLabelBbox=function(e,t,n){if(e&&(e.label||e.labelIcon)&&e.properties&&e.properties.labelCoord){var o=this.renderer.pinchZoom;if(!n){var l=this.computeNodeSizeWithMargin(t,e),a=o.viewerPosFromWorldPos(e.properties.labelCoord);n={x:a.x,y:a.y,width:l.width,height:l.height}}if(!t){this.renderer.canvas.getContext("2d")}var s=e.properties,u=i.Point.times(.5,new i.Point(n.width,n.height));s.labelBbox=new r.BoundingBox({min:o.worldPosFromViewerPos(i.Point.minus(n,u)),max:o.worldPosFromViewerPos(i.Point.plus(n,u))})}},e.prototype.nodeName=function(e){if(e.label)return e.label;if(e.labelIcon)return"icon:"+e.labelIcon.url;throw"no label and no labIcon for node"},e.prototype.placeLabels=function(e){var t=this.renderer.pinchZoom,n=this.renderer.pixelRatio,l=[],a=[];for(var s in this.graph.nodes){var u=this.graph.nodes[s];if(u.label||u.labelIcon){var p=t.viewerPosFromWorldPos(u.coord),d=this.defaultRadius;u.properties&&u.properties.radius&&(d=u.properties.radius),a.push({x:p.x,y:p.y,r:d*n});var c=this.computeNodeSizeWithMargin(e,u),f=this.nodeName(u),h=p;u.properties&&u.properties.userPlacement&&(h=t.viewerPosFromWorldPos(u.properties.userPlacement));var g={x:h.x,y:h.y,name:f,width:c.width,height:c.height,node:u,userPlacement:u.properties&&u.properties.userPlacement?h:void 0};l.push(g)}}var m=d3.labeler().label(l).anchor(a).width(this.renderer.canvas.width).height(this.renderer.canvas.height),v=m.alt_energy(),y=[],P=[];for(var x in this.graph.edges){var w=this.graph.getEdgeRoute(this.graph.edges[x]);if(w){for(var b=[],_=0,M=w.geom;_<M.length;_++){var T=M[_],C=t.viewerPosFromWorldPos(T);(0==b.length||i.Point.dist(b[b.length-1],C)>4*n)&&b.push(C)}var D=new r.BoundingBox;D.addArray(b),y.push(D),P.push(b)}else{var L=this.graph.bezier(this.graph.edges[x]);for(var s in L){var O=L[s],D=O.bbox();y.push({min:t.viewerPosFromWorldPos(D.x.min,D.y.min),max:t.viewerPosFromWorldPos(D.x.max,D.y.max)});var I=O.getLUT(30),k=[];for(var R in I)k.push(t.viewerPosFromWorldPos(I[R]));P.push(k)}}}m.alt_energy(function(e,t,n){var o=0,a=m.boxOfLabel(e),s=new r.BoundingBox;s.addPoint(new i.Point(a.left,a.top)),s.addPoint(new i.Point(a.right,a.bottom));for(var u in y)if(r.BoundingBox.overlaps(y[u],s)){var p=P[u];for(var d in p)s.contains(p[d])&&o++}var c=10*o+v(e),f=l[e].userPlacement;if(f){c+=i.Point.dist(f,l[e])}return c});m.start(5e3,1);for(var s in l){var E=l[s];E.node.properties||(E.node.properties={});var S=E.node.properties;S.labelCoord=t.worldPosFromViewerPos(E),this.setLabelBbox(E.node,e,E),o.TripGraph.placeLeaderLine(E.node),S.textPlacement="C",S.textOffset=0}},e.shallowCopy=function(e){var t,n=Object.create(Object.getPrototypeOf(e)),o=Object.getOwnPropertyNames(e);for(t=0;t<o.length;t++)Object.defineProperty(n,o[t],Object.getOwnPropertyDescriptor(e,o[t]));return n},e.prototype.forEachNode=function(e){for(var t in this.graph.nodes)e(this.graph.nodes[t])},e.prototype.loadIcons=function(e){var t=this;this.iconsToLoad=1,this.failedIcons=0;var n=function(){t.iconsToLoad--,e&&0===t.iconsToLoad&&(t.failedIcons>0?e(new Error(t.failedIcons+" icons failed to load.")):e())};this.forEachNode(function(e){if(e.labelIcon){var o=e.labelIcon.url;t.iconsToLoad++;var r=window.imageUrlPrefix||"";t.renderer.loadImage(r+e.labelIcon.url,function(e){t.icons[o]=e,n()},function(e){console.log("Failed to load: "+o+" (prefix: "+r+")"),t.failedIcons++,n()})}}),n()},e}();t.TripGraphLayer=l},rDkg:function(e,t,n){"use strict";function o(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,1,"h2",[],null,null,null,null,null)),(e()(),P.\u0275ted(null,["",""]))],null,function(e,t){e(t,1,0,t.component.days.title)})}function r(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,1,"div",[["class","daySubTitle"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["",""]))],null,function(e,t){e(t,1,0,t.parent.context.$implicit.subtitle)})}function i(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,1,"li",[["class","clickable schedule_location_button_color"]],null,[[null,"click"]],function(e,t,n){var o=!0,r=e.component;if("click"===t){o=!1!==r.fireSelectLocation(e.context.$implicit)&&o}return o},null,null)),(e()(),P.\u0275ted(null,["",""]))],null,function(e,t){e(t,1,0,t.context.$implicit.name)})}function l(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,0,"div",[],[[8,"innerHTML",1]],null,null,null,null))],null,function(e,t){e(t,0,0,t.parent.context.$implicit.description)})}function a(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,2,"span",[["class","eventIndication"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["",""])),(e()(),P.\u0275eld(0,null,null,0,"br",[],null,null,null,null,null))],null,function(e,t){e(t,1,0,t.parent.context.$implicit.indication)})}function s(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,2,"span",[["class","eventIndication"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["",""])),(e()(),P.\u0275eld(0,null,null,0,"br",[],null,null,null,null,null))],null,function(e,t){var n=t.component;e(t,1,0,n.dateTimeToTime(n.toUTCDate(t.parent.context.$implicit.time)))})}function u(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,2,"span",[["class","eventTitle"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["",""])),(e()(),P.\u0275eld(0,null,null,0,"br",[],null,null,null,null,null))],null,function(e,t){e(t,1,0,t.parent.context.$implicit.title)})}function p(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,2,"span",[["class","eventSubTitle"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["",""])),(e()(),P.\u0275eld(0,null,null,0,"br",[],null,null,null,null,null))],null,function(e,t){e(t,1,0,t.parent.context.$implicit.subtitle)})}function d(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,3,"a",[["data-gallery","gallery1"],["data-toggle","lightbox"]],[[8,"href",4]],null,null,null,null)),(e()(),P.\u0275ted(null,["\n                "])),(e()(),P.\u0275eld(0,null,null,0,"img",[["class","thumbnail-schedule"]],[[8,"src",4]],null,null,null,null)),(e()(),P.\u0275ted(null,["\n              "]))],null,function(e,t){e(t,0,0,P.\u0275inlineInterpolate(1,"",t.context.$implicit.thumb_url,"")),e(t,2,0,P.\u0275inlineInterpolate(1,"",t.context.$implicit.thumb_url,""))})}function c(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,21,"li",[["style","margin: 20px 0px; border-bottom: 1px solid #efefef;"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["\n            "])),(e()(),P.\u0275and(16777216,null,null,1,null,a)),P.\u0275did(16384,null,0,x.NgIf,[P.ViewContainerRef,P.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),P.\u0275ted(null,["\n            "])),(e()(),P.\u0275and(16777216,null,null,1,null,s)),P.\u0275did(16384,null,0,x.NgIf,[P.ViewContainerRef,P.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),P.\u0275ted(null,["\n            "])),(e()(),P.\u0275and(16777216,null,null,1,null,u)),P.\u0275did(16384,null,0,x.NgIf,[P.ViewContainerRef,P.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),P.\u0275ted(null,["\n            "])),(e()(),P.\u0275and(16777216,null,null,1,null,p)),P.\u0275did(16384,null,0,x.NgIf,[P.ViewContainerRef,P.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),P.\u0275ted(null,["\n            "])),(e()(),P.\u0275eld(0,null,null,0,"div",[["class","eventDescription"]],[[8,"innerHTML",1]],null,null,null,null)),(e()(),P.\u0275ted(null,["\n\n            "])),(e()(),P.\u0275eld(0,null,null,4,"div",[["class","slick-carousel"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["\n              "])),(e()(),P.\u0275and(16777216,null,null,1,null,d)),P.\u0275did(802816,null,0,x.NgForOf,[P.ViewContainerRef,P.TemplateRef,P.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),P.\u0275ted(null,["\n            "])),(e()(),P.\u0275ted(null,["\n          "]))],function(e,t){e(t,3,0,t.context.$implicit.indication),e(t,6,0,t.context.$implicit.time),e(t,9,0,t.context.$implicit.title),e(t,12,0,t.context.$implicit.subtitle),e(t,19,0,t.context.$implicit.pictures)},function(e,t){e(t,14,0,t.context.$implicit.description)})}function f(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,3,"a",[["data-gallery","gallery2"],["data-toggle","lightbox"]],[[8,"href",4]],null,null,null,null)),(e()(),P.\u0275ted(null,["\n            "])),(e()(),P.\u0275eld(0,null,null,0,"img",[["class","thumbnail-schedule img-fluid"]],[[8,"src",4]],null,null,null,null)),(e()(),P.\u0275ted(null,["\n          "]))],null,function(e,t){e(t,0,0,P.\u0275inlineInterpolate(1,"",t.context.$implicit.thumb_url,"")),e(t,2,0,P.\u0275inlineInterpolate(1,"",t.context.$implicit.thumb_url,""))})}function h(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,40,"li",[["style","padding:5px 20px;margin:0px;"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["\n        "])),(e()(),P.\u0275eld(0,null,null,16,"header",[],null,null,null,null,null)),(e()(),P.\u0275ted(null,["\n        "])),(e()(),P.\u0275eld(0,null,null,7,"div",[["class","day schedule_day_title_color separatorColor"],["style","width: 100%"]],null,null,null,null,null)),(e()(),P.\u0275eld(0,null,null,4,"strong",[],null,null,null,null,null)),(e()(),P.\u0275ted(null,["",""])),P.\u0275ppd(2),P.\u0275ppd(1),P.\u0275ppd(1),(e()(),P.\u0275ted(null,[", ",""])),P.\u0275ppd(2),(e()(),P.\u0275ted(null,["\n        "])),(e()(),P.\u0275eld(0,null,null,1,"div",[["class","dayTitle"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["",""])),(e()(),P.\u0275ted(null,["\n        "])),(e()(),P.\u0275and(16777216,null,null,1,null,r)),P.\u0275did(16384,null,0,x.NgIf,[P.ViewContainerRef,P.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),P.\u0275ted(null,["\n        "])),(e()(),P.\u0275ted(null,["\n\n        "])),(e()(),P.\u0275eld(0,null,null,4,"ul",[["class","locations"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["\n          "])),(e()(),P.\u0275and(16777216,null,null,1,null,i)),P.\u0275did(802816,null,0,x.NgForOf,[P.ViewContainerRef,P.TemplateRef,P.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),P.\u0275ted(null,["\n        "])),(e()(),P.\u0275ted(null,["\n\n        "])),(e()(),P.\u0275and(16777216,null,null,1,null,l)),P.\u0275did(16384,null,0,x.NgIf,[P.ViewContainerRef,P.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),P.\u0275ted(null,["\n\n        "])),(e()(),P.\u0275eld(0,null,null,4,"ul",[],null,null,null,null,null)),(e()(),P.\u0275ted(null,["\n          "])),(e()(),P.\u0275and(16777216,null,null,1,null,c)),P.\u0275did(802816,null,0,x.NgForOf,[P.ViewContainerRef,P.TemplateRef,P.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),P.\u0275ted(null,["\n        "])),(e()(),P.\u0275ted(null,["\n        "])),(e()(),P.\u0275eld(0,null,null,4,"div",[["class","slick-carousel"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["\n          "])),(e()(),P.\u0275and(16777216,null,null,1,null,f)),P.\u0275did(802816,null,0,x.NgForOf,[P.ViewContainerRef,P.TemplateRef,P.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),P.\u0275ted(null,["\n        "])),(e()(),P.\u0275ted(null,["\n      "]))],function(e,t){var n=t.component;e(t,17,0,t.context.$implicit.subtitle),e(t,23,0,n.locationsForDay(t.context.$implicit)),e(t,27,0,t.context.$implicit.description),e(t,32,0,t.context.$implicit.events),e(t,38,0,t.context.$implicit.pictures)},function(e,t){var n=t.component;e(t,6,0,P.\u0275unv(t,6,0,e(t,9,0,P.\u0275nov(t.parent.parent,0),n.T(P.\u0275unv(t,6,0,e(t,8,0,P.\u0275nov(t.parent.parent,1),P.\u0275unv(t,6,0,e(t,7,0,P.\u0275nov(t.parent.parent,2),t.context.$implicit.date,"EEEE")))))))),e(t,10,0,P.\u0275unv(t,10,0,e(t,11,0,P.\u0275nov(t.parent.parent,2),t.context.$implicit.date,"dd.MM.yy"))),e(t,14,0,t.context.$implicit.title)})}function g(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,10,"div",[],null,null,null,null,null)),(e()(),P.\u0275ted(null,["\n    "])),(e()(),P.\u0275and(16777216,null,null,1,null,o)),P.\u0275did(16384,null,0,x.NgIf,[P.ViewContainerRef,P.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),P.\u0275ted(null,["\n    "])),(e()(),P.\u0275eld(0,[[1,0],["dayEntryUl",1]],null,4,"ul",[["class","dayEntryUl"],["style","padding:5px;margin:5px;margin-top:10px;"]],null,null,null,null,null)),(e()(),P.\u0275ted(null,["\n      "])),(e()(),P.\u0275and(16777216,null,null,1,null,h)),P.\u0275did(802816,null,0,x.NgForOf,[P.ViewContainerRef,P.TemplateRef,P.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),P.\u0275ted(null,["\n    "])),(e()(),P.\u0275ted(null,["\n  "]))],function(e,t){var n=t.component;e(t,3,0,n.days.title),e(t,8,0,n.days.days)},null)}function m(e){return P.\u0275vid(0,[P.\u0275pid(0,x.UpperCasePipe,[]),P.\u0275pid(0,x.LowerCasePipe,[]),P.\u0275pid(0,x.DatePipe,[P.LOCALE_ID]),P.\u0275qud(671088640,1,{dayEntryUl:0}),(e()(),P.\u0275eld(0,null,null,9,"div",[["class","progview"]],[[8,"scrollTop",0]],null,null,null,null)),(e()(),P.\u0275ted(null,["\n  "])),(e()(),P.\u0275and(16777216,null,null,1,null,g)),P.\u0275did(16384,null,0,x.NgIf,[P.ViewContainerRef,P.TemplateRef],{ngIf:[0,"ngIf"]},null),(e()(),P.\u0275ted(null,["\n  "])),(e()(),P.\u0275eld(0,null,null,0,"div",[["id","spin-loader"]],[[8,"hidden",0]],null,null,null,null)),(e()(),P.\u0275ted(null,["\n  "])),(e()(),P.\u0275eld(0,null,null,1,"p",[],[[8,"hidden",0]],null,null,null,null)),(e()(),P.\u0275ted(null,["",""])),(e()(),P.\u0275ted(null,["\n"])),(e()(),P.\u0275ted(null,["\n"]))],function(e,t){e(t,7,0,t.component.days)},function(e,t){var n=t.component;e(t,4,0,n.scrollTop),e(t,9,0,n.days||n.error),e(t,11,0,!n.error),e(t,12,0,n.error)})}function v(e){return P.\u0275vid(0,[(e()(),P.\u0275eld(0,null,null,2,"days-view",[],null,null,null,m,t.RenderType_DaysView)),P.\u0275prd(512,null,b.DaysService,b.DaysService,[_.Http]),P.\u0275did(638976,null,0,w.DaysView,[b.DaysService],null,null)],function(e,t){e(t,2,0)},null)}Object.defineProperty(t,"__esModule",{value:!0});var y=n("agHN"),P=n("/oeL"),x=n("qbdv"),w=n("xHFf"),b=n("yJCl"),_=n("CPp0"),M=[y.styles];t.RenderType_DaysView=P.\u0275crt({encapsulation:0,styles:M,data:{}}),t.View_DaysView_0=m,t.View_DaysView_Host_0=v,t.DaysViewNgFactory=P.\u0275ccf("days-view",w.DaysView,v,{tripId:"tripId"},{selectLocation:"selectLocation"},[])},uTZG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.styles=[".flex-col[_ngcontent-%COMP%]{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column}.flex-col[_ngcontent-%COMP%], .flex-col-or-row[_ngcontent-%COMP%], .flex-row[_ngcontent-%COMP%]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}.flex-col-or-row[_ngcontent-%COMP%], .flex-row[_ngcontent-%COMP%]{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row}.flex-auto[_ngcontent-%COMP%]{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;overflow:auto}.flex-fixed[_ngcontent-%COMP%]{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;overflow:auto}.schedule-link[_ngcontent-%COMP%]:hover{text-decoration:underline;cursor:pointer}@media (orientation:portrait){.rotate[_ngcontent-%COMP%]{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}}agm-map[_ngcontent-%COMP%], days-view[_ngcontent-%COMP%], mapContainer[_ngcontent-%COMP%]{width:100%;height:100%;display:block}.relative[_ngcontent-%COMP%]{position:relative}.abs-fill[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0}article[_ngcontent-%COMP%]{background:#4b3}.region-header[_ngcontent-%COMP%]{padding-bottom:14px}#initerary[_ngcontent-%COMP%]   .region-header[_ngcontent-%COMP%]{margin-top:0!important}.h100[_ngcontent-%COMP%]{height:100%}.backtohomepage[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-transform:uppercase}.white-shadow[_ngcontent-%COMP%]{position:absolute;top:0;width:100%;height:30px;background:linear-gradient(#fff,hsla(0,0%,100%,0))}"]},v0bJ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("x88H"),r=n("Nh04"),i=n("Rp1X"),l=n("zOtD"),a=n("owx+"),s=function(){function e(){this.reset()}return e.makePlaneIcon=function(e,t){var n=new l.TripNode;return n.name=t.dbid+"-"+e,n.labelIcon={url:"/ng-map/assets/plane.png",width:20,autorotate:Math.PI/2*("landing"===e?1:-1),ratioX:.5,ratioY:"landing"===e?0:1},n.coord=t.coord,n.properties={point:!1,leaderLine:"center",dashed:[5,3],leaderLineWidth:2,maxLeaderLineLength:2},n},e.prototype.places=function(){return this._tripData.places},e.prototype.stages=function(){return this._tripData.stages},e.prototype.setLocation=function(e){this._tripData.location=e},e.prototype.location=function(){return this._tripData.location},e.prototype.width_mm=function(){return this._tripData.width},e.prototype.height_mm=function(){return this._tripData.height},e.prototype.pageSizeName=function(){return this._tripData.pageSizeName},e.prototype.world=function(){return this._tripData.world||(this._tripData.world={}),this._tripData.world},e.prototype.setSize=function(e,t,n){this._tripData.width=t,this._tripData.height=n,this._tripData.pageSizeName=e},e.prototype.defaultRadius=function(){return this._tripData.defaultRadius},e.prototype.defaultTextProp=function(){return this._tripData.defaultTextProp||(this._tripData.defaultTextProp={}),this._tripData.defaultTextProp},e.prototype.defaultEdgeProp=function(){return this._tripData.defaultEdgeProp||(this._tripData.defaultEdgeProp=e.defaultTrip().defaultEdgeProp),this._tripData.defaultEdgeProp},e.prototype.reset=function(){this._tripData=e.defaultTrip()},e.defaultTrip=function(){return{places:[],stages:[],additionalPlaces:[],location:{x:.5,y:.5,scale:1/8},defaultRadius:8,width:128,height:190,pageSizeName:"Full page",borderColor:"#fefefe",landColor:"#cecece",seaColor:"#c4e3ff",showRivers:!1,world:{},defaultTextProp:{fontSize:12,font:"'PT Sans', sans-serif",stroke:"rgba(255,255,255,.8)",fill:"#000000"},defaultEdgeProp:{lineWidth:2,lineColor:"#000000",geom:"straight"}}},e.prototype.setPlaces=function(e){this._tripData.places.splice.apply(this._tripData.places,[0,this._tripData.places.length].concat(e)),this.updateStages(),this.updateLandingsAndTakeoff()},e.prototype.stagesAsDict=function(){for(var e={},t=0,n=this._tripData.stages;t<n.length;t++){var o=n[t];o.from in e||(e[o.from]={}),e[o.from][o.to]=o}return e},e.prototype.updateStages=function(){for(var e=this._tripData.places,t=e.length-1,n=(this._tripData.stages,[]),o=this.stagesAsDict(),l=1;l<=t;++l){var a=e[l-1].dbid,s=e[l].dbid;if(o[a]&&o[a][s]){var u=o[a][s];u.to=e[l].name,n.push(u)}else n.push(new r.TripEdge({from:e[l-1].name,to:e[l].name,fromDbId:a,controlPoints:i.TripGraph.generateControlPoints(l>=2?e[l-2].coord:void 0,e[l-1].coord,e[l].coord,l+1<e.length?e[l+1].coord:void 0)}))}this._tripData.stages.splice.apply(this._tripData.stages,[0,this._tripData.stages.length].concat(n))},e.prototype.updateLandingsAndTakeoff=function(){for(var t={},n=this._tripData.additionalPlaces,o=0;o<n.length;++o)t[n[o].name]=o;for(var r=[],i={},l={},a=["landing","takeoff"],s=0,u=this._tripData.places;s<u.length;s++)for(var p=u[s],d=0,c=a;d<c.length;d++){var f=c[d],h=p.dbid+"-"+f;l[h]=!0,p.properties[f]?h in t||r.push(e.makePlaneIcon(f,p)):h in t&&(i[h]=!0)}var g=/-(landing|takeoff)$/,m=n.filter(function(e){return!(e.name in i)&&(e.name in l||null==e.name.match(g))}).concat(r);this._tripData.additionalPlaces.splice.apply(this._tripData.additionalPlaces,[0,this._tripData.additionalPlaces.length].concat(m))},e.prototype.nodeRadius=function(e,t){var n=this._tripData.defaultRadius;return e.properties&&e.properties.radius&&(n=e.properties.radius),n*t},e.prototype.makeGraph=function(e){for(var t={},n=(function(e){for(var n=e;n in t;)n=t[n];return n}),r=0,s=this._tripData.places;r<s.length;r++){var u=s[r];if(!u.name)throw new Error("nodes should have names and labels")}var p=[];if(e){for(var d=e.renderer.pinchZoom,c=e.renderer.pixelRatio,f=0,h=this._tripData.places;f<h.length;f++){var g=h[f];g.viewerPos=d.viewerPosFromWorldPos(g.coord)}for(var m=0,v=this._tripData.places;m<v.length;m++){var g=v[m];if(!(!g.label||g.properties&&g.properties.skip)){for(var y=this.nodeRadius(g,c),P=!0,x=0;x<p.length;++x){var u=p[x];if(o.Point.dist(u.viewerPos,g.viewerPos)<this.nodeRadius(u,c)+y){p[x]=function(e,n){var o=l.TripNode.parse(e);o.name=e.name+","+n.name,o.allPlaces=e.allPlaces.concat([n]);var r=e.label.split("\n");return r.indexOf(n.label)<0&&r.push(n.label),o.label=r.join("\n"),t[e.name]=t[n.name]=o.name,o}(u,g),P=!1;break}}if(P){g.properties||(g.properties={});var w=l.TripNode.parse(g);w.place=g,w.allPlaces=[g],p.push(w)}}}}else for(var b=0,_=this._tripData.places;b<_.length;b++){var g=_[b],w=l.TripNode.parse(g);w.place=g,w.allPlaces=[g],p.push(w)}for(var M=this._tripData.places,T={},x=0;x<M.length;++x){var u=M[x];T[u.name]=x}for(var C=new i.TripGraph(void 0,this._tripData.defaultEdgeProp),D=0,L=p;D<L.length;D++){var u=L[D];C.nodes[u.name]=u}this.updateLandingsAndTakeoff();for(var O=0,I=this._tripData.additionalPlaces;O<I.length;O++){var u=I[O];C.nodes[u.name]=u}for(var k=0,R=this._tripData.stages;k<R.length;k++){var E=R[k];if(!E.properties.hidden&&!M[T[E.from]].isSkipped()){for(var S=n(E.from),N=T[E.to];N<M.length&&M[N].isSkipped();)++N;if(!(N>=M.length||M[N].isSkipped())){var A=n(M[N].name);if(S!==A){var F=a.TripGraphLayer.shallowCopy(E);F.from=S,F.to=A,F.originalEdge=E,C.edges.push(F)}}}}return C},e.prototype.save=function(){return this._tripData},e.prototype.load=function(e){if(!e||!e.places||!e.stages)throw new Error("no data");var t=e,n=function(e){for(var t=0;t<e.length;++t)e[t]=l.TripNode.parse(e[t])};n(t.places);for(var o=t.stages,i=0;i<o.length;++i)o[i]=new r.TripEdge(o[i]);n(t.additionalPlaces),this._tripData=t,this.defaultEdgeProp(),this.setSize(e.pageSizeName,e.width,e.height)},e.prototype.seaColor=function(){return this._tripData.seaColor},e.prototype.setSeaColor=function(e){this._tripData.seaColor=e},e.prototype.landColor=function(){return this._tripData.landColor},e.prototype.setLandColor=function(e){this._tripData.landColor=e},e.prototype.borderColor=function(){return this._tripData.borderColor},e.prototype.setBorderColor=function(e){this._tripData.borderColor=e},e.prototype.showRivers=function(){return this._tripData.showRivers},e.prototype.toggleShowRiver=function(){this._tripData.showRivers=!this._tripData.showRivers},e.prototype.placeByName=function(e){for(var t=0,n=this._tripData.places;t<n.length;t++){var o=n[t];if(e===o.name)return o}},e.prototype.markFirstLocation=function(){for(var e=!0,t=0,n=this._tripData.places;t<n.length;t++){var o=n[t];!o.label||o.properties&&o.properties.skip||(e?o.properties.firstVisited=!0:"firstVisited"in o.properties&&delete o.properties.firstVisited,e=!1)}},e.prototype.clearUserPlacements=function(){for(var e=0,t=this._tripData.additionalPlaces.concat(this._tripData.places);e<t.length;e++){var n=t[e];n.properties&&n.properties.userPlacement&&delete n.properties.userPlacement}},e.prototype.saveUserPlacements=function(){for(var e=0,t=this._tripData.additionalPlaces.concat(this._tripData.places);e<t.length;e++){var n=t[e];n.properties||(n.properties={}),n.properties.labelCoord&&(n.properties.userPlacement=n.properties.labelCoord)}},e}();t.SeqTrip=s},x88H:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){if("number"==typeof e&&"number"==typeof t?(this.x=e,this.y=t):Array.isArray(e)?(this.x=e[0],this.y=e[1]):"object"==typeof e&&(this.x=e.x,this.y=e.y),void 0===this.x||void 0===this.y)throw new Error("invalid point")}return e.minus=function(t,n){return new e(t.x-n.x,t.y-n.y)},e.plus=function(t,n){return new e(t.x+n.x,t.y+n.y)},e.times=function(t,n){return new e(t*n.x,t*n.y)},e.min=function(t,n){return new e(Math.min(t.x,n.x),Math.min(t.y,n.y))},e.max=function(t,n){return new e(Math.max(t.x,n.x),Math.max(t.y,n.y))},e.dist=function(e,t){var n=e.x-t.x,o=e.y-t.y;return Math.sqrt(n*n+o*o)},e.norm=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},e.nearest=function(t,n){for(var o,r,i=0,l=n;i<l.length;i++){var a=l[i],s=e.dist(a,t);(void 0===o||s<r)&&(r=s,o=a)}return o},e.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},e.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},e.prototype.mul=function(e){return this.x*=e,this.y*=e,this},e.prototype.norm=function(){return e.norm(this)},e}();t.Point=o},xHFf:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("/oeL"),r=n("yJCl"),i=function(){function e(e){this.daysService=e,this.selectLocation=new o.EventEmitter,this.scrollTop=0,this.toUTCDate=function(e){var t;return t=new Date(e),new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds())},this.dateTimeToTime=function(e){return e.getMinutes()>=10?e.getHours()+":"+e.getMinutes():e.getHours()+":0"+e.getMinutes()},this.translations=translations}return e.prototype.ngOnInit=function(){this.fetchDays()},e.prototype.ngOnChanges=function(){this.fetchDays()},e.prototype.fetchDays=function(){var e=this;console.log("FETCHING trip: "+this.tripId),this.tripId&&this.daysService.getDays(this.tripId).then(function(t){e.setDays(t)}).catch(function(t){e.error="Failed to load trip content"})},e.prototype.setDays=function(e){this.days=e,this.days.days=e.days.filter(function(e){return null!=e.title||null!=e.subtitle||null!=e.description||e.events.length||e.locations.length||e.pictures.length})},e.prototype.fireSelectLocation=function(e){this.selectLocation.next(e)},e.eventBaseLocations=function(e){return e.locations},e.dayLocations=function(t){for(var n=e.eventBaseLocations(t).slice(),o=0,r=t.events;o<r.length;o++){var i=r[o];n=n.concat(e.eventBaseLocations(i))}return n},e.dist=function(e,t){var n=e.latitude-t.lat,o=e.longitude-t.lng;return n*n+o*o},e.distanceToDay=function(t,n){var o=e.dayLocations(t).map(function(t){return e.dist(t,n)});if(o.length>0)return Math.min.apply(Math,o)},e.prototype.scrollTo=function(t){if(this.dayEntryUl){for(var n,o,r=0;r<this.days.days.length;++r){var i=this.days.days[r],l=e.distanceToDay(i,t);l&&(!n||l<n)&&(n=l,o=r)}if(void 0!=o){var a=this.dayEntryUl.nativeElement.children[o].offsetTop;this.scrollTop=Math.max(0,a-5)}}},e.prototype.locationsForDay=function(e){for(var t=e.locations.slice(),n=0,o=e.events;n<o.length;n++){var r=o[n];t=t.concat(r.locations)}return t},e.prototype.T=function(e){for(var t=e.split("."),n=translations;t.length>0;){var o=t[0];if(!n[o])return console.log("Missing translation: "+e),e;n=n[o],t=t.slice(1)}return"object"==typeof n?(console.log("invalid translation key: "+e),e):n},e.ctorParameters=function(){return[{type:r.DaysService}]},e}();t.DaysView=i},yJCl:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("CPp0");n("82j9"),n("5v8a");var r=function(){function e(e){this.http=e}return e.prototype.getDays=function(e){return this.http.get("/api/trips/"+e+"/days.json").map(function(e){return e.json()}).toPromise()},e.ctorParameters=function(){return[{type:o.Http}]},e}();t.DaysService=r},zOtD:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("x88H"),r=n("E+5d"),i=function(){function e(){this.allPlaces=[]}return e.parse=function(t){var n=new e;n.coord=new o.Point(t.coord),t.place&&(t.place=e.parse(t.place)),t.viewerPos&&(n.viewerPos=new o.Point(t.viewerPos));for(var i=0,l=["dbid","name","label","labelIcon","properties"];i<l.length;i++){var a=l[i];t[a]&&(n[a]=t[a])}return n.name||(void 0!==n.dbid?n.name=""+n.dbid:n.label&&(n.name=n.label)),n.properties?(n.properties.labelBbox&&(n.properties.labelBbox=new r.BoundingBox(n.properties.labelBbox)),n.properties.leaderLineAnchor&&(n.properties.leaderLineAnchor=new o.Point(n.properties.leaderLineAnchor)),n.properties.labelCoord&&(n.properties.labelCoord=new o.Point(n.properties.labelCoord))):n.properties={},n},e.prototype.isSkipped=function(){return!(this.label&&(!this.properties||void 0===this.properties.skip))&&this.properties.skip},e}();t.TripNode=i}},[0]);